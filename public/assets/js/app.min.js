!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){"use strict";var c=a("../dispatcher/dispatcher"),d=a("../constants/constants").ActionTypes;b.exports={receiveInitialState:function(a){console.log("receiveInitialState",a),c.handleServerAction({type:d.RECEIVE_INITIAL_STATE,state:a})},receiveStateUpdate:function(a){var b=a.topic.split(".")[0],d=a;console.log("receiveStateUpdate",b,d),c.handleServerAction({type:b,state:d})},receiveAnnouncerState:function(a){console.log("receiveAnnouncerState",a),c.handleServerAction({type:d.ANNOUNCER,state:a})},receiveAvoiderSettings:function(a){console.log("receiveAvoiderSettings",a),c.handleServerAction({type:d.RECEIVE_AVOIDER_SETTINGS,state:a})},receiveRadioSettings:function(a){console.log("receiveRadioSettings",a),c.handleServerAction({type:d.RECEIVE_RADIO_SETTINGS,state:a})}}},{"../constants/constants":17,"../dispatcher/dispatcher":18}],2:[function(a,b){var c=a("../dispatcher/dispatcher"),d=a("../constants/constants").ActionTypes,e=a("../stores/power"),f=a("../stores/avoider"),g=a("../stores/announcer"),h=a("../stores/radio-settings");b.exports={togglePower:function(){var b;console.log("togglePower"),c.handleViewAction({type:d.POWER}),b=e.getState().isOn,a("../api/power")(b)},changeVolume:function(b){console.log("changeVolume",b),c.handleViewAction({type:d.VOLUME,state:{volume:b}}),a("../api/volume")(b)},changeService:function(b){console.log("changeService",b),a("../api/service")(b)},toggleAvoider:function(){var b=f.getState().isAvoiding;console.log("toggleAvoider - current state",b),a("../api/avoid").set(b)},requestAvoiderSettings:function(){a("../api/avoid").settings()},requestRadioSettings:function(){a("../api/radio-settings")()},avoiderSettings:function(b){a("../api/avoid").settings(b)},toggleAnnouncer:function(){var b=g.getState().isAnnouncing;console.log("toggleAnnouncer - current state",b),a("../api/announce")(b)},toggleRadioSettingPreferredServer:function(b){h.togglePreferredService(b),c.handleViewAction({type:d.SETTINGS,state:h.getState()}),a("../api/radio-settings")(h.getState())}}},{"../api/announce":3,"../api/avoid":4,"../api/power":5,"../api/radio-settings":6,"../api/service":7,"../api/volume":8,"../constants/constants":17,"../dispatcher/dispatcher":18,"../stores/announcer":24,"../stores/avoider":26,"../stores/power":30,"../stores/radio-settings":31}],3:[function(a,b){var c=a("../xhr"),d=(a("../utils").success,a("../utils").failure),e=a("../actions/server-action-creators");b.exports=function(a){console.log("api - isAnnouncing",a,null==a),null==a&&c.get("/announcer/state.json").then(function(a){return console.log("/announcer/state.json",a),JSON.parse(a)}).then(e.receiveAnnouncerState,d);var b=a?"DELETE":"POST";console.log("api - isAnnouncing",b),c(b,"/announcer").catch(d)}},{"../actions/server-action-creators":1,"../utils":33,"../xhr":36}],4:[function(a,b){var c=a("../xhr"),d=(a("../utils").success,a("../utils").failure,a("../actions/server-action-creators"));b.exports.set=function(a){var b=a?"DELETE":"POST";c(b,"/avoider")},b.exports.settings=function(a){if(a){var b=JSON.stringify(a),e={headers:{"Content-type":"application/json"},data:b};console.log("Avoid settings changed",e),c.post("/avoider/settings.json",e)}else c.get("/avoider/settings.json").then(function(a){return JSON.parse(a)}).then(d.receiveAvoiderSettings)}},{"../actions/server-action-creators":1,"../utils":33,"../xhr":36}],5:[function(a,b){{var c=a("../xhr");a("../utils").success,a("../utils").failure}b.exports=function(a){var b=a?"PUT":"DELETE";c(b,"/radio/power")}},{"../utils":33,"../xhr":36}],6:[function(a,b){var c=a("../xhr"),d=a("../utils"),e=(d.success,d.failure),f=a("../actions/server-action-creators");b.exports=function(a){if(a){console.warn("data",a);var b=JSON.stringify(a),d={headers:{"Content-type":"application/json"},data:b};console.log("Radio settings changed",d),c.post("/radio/settings.json",d).catch(e)}else c.get("/radio/settings.json").then(function(a){return JSON.parse(a)}).then(f.receiveRadioSettings).catch(e)}},{"../actions/server-action-creators":1,"../utils":33,"../xhr":36}],7:[function(a,b){var c=a("../xhr"),d=a("../utils").success,e=a("../utils").failure;b.exports=function(a){c.post("/radio/service/"+a).then(d("service"),e("service"))}},{"../utils":33,"../xhr":36}],8:[function(a,b){var c=a("../xhr"),d=a("../utils").success,e=a("../utils").failure;b.exports=function(a){c.post("/radio/volume/value/"+a).then(d("volume"),e("volume"))}},{"../utils":33,"../xhr":36}],9:[function(a){function b(){console.log("init"),d.addChangeListener(function(){m.set("power",d.getState())}),e.addChangeListener(function(){m.set("audio",e.getState())}),f.addChangeListener(function(){m.set("services",f.getAllServicesAsArray())}),g.addChangeListener(function(a){var b=i.getCurrentId();b===a&&m.set("nowAndNext",g.get(b))}),h.addChangeListener(function(a){var b=i.getCurrentId();b===a&&m.set("nowPlaying",h.get(b))}),i.addChangeListener(function(){m.set("current",i.getCurrent())}),j.addChangeListener(function(){m.set("avoider",j.getState())}),k.addChangeListener(function(){m.set("announcer",k.getState())}),l.addChangeListener(function(){m.set("settings",l.getState())}),c.connectEventStream(),c.getInitialState(),a("./api/announce")()}var c=a("./utils/api"),d=a("./stores/power"),e=a("./stores/audio"),f=a("./stores/services"),g=a("./stores/now-and-next"),h=a("./stores/now-playing"),i=a("./stores/current-service"),j=a("./stores/avoider"),k=a("./stores/announcer"),l=a("./stores/radio-settings"),m=a("./view");m.init().then(b)},{"./api/announce":3,"./stores/announcer":24,"./stores/audio":25,"./stores/avoider":26,"./stores/current-service":27,"./stores/now-and-next":28,"./stores/now-playing":29,"./stores/power":30,"./stores/radio-settings":31,"./stores/services":32,"./utils/api":34,"./view":35}],10:[function(a,b){var c=a("ractive");b.exports=c.extend({template:"#announcerTmpl",isolated:!0,twoway:!1,debug:!0,data:{settingsOpen:!1,state:null},components:{CircularProgress:a("./circular-progress")},computed:{percentThrough:function(){var a,b,c,d=this.get("state.start"),e=this.get("state.end"),f=this.get("now");return d&&e&&f?(a=e-d,b=f-d,c=b/a,c=100*c.toFixed(2)):this.get("state.isAnnouncing")&&(c=100),0>c&&(c=0),c>100&&(c=100),c},timeLeft:function(){var a=this.get("now"),b=this.get("state.end"),c=b>a,d=null;return b&&a&&c&&(d=this.formatTimeDiff(Math.round(b-a))),d}},init:function(){this.observe("state.end",function(a){a&&!this.countdownTimerId?this.countdownTimerId=window.setInterval(function(){this.set("now",new Date)}.bind(this),1e3):(window.clearInterval(this.countdownTimerId),this.countdownTimerId=null)})}})},{"./circular-progress":12,ractive:50}],11:[function(a,b){var c=a("ractive");b.exports=c.extend({template:"#avoiderTmpl",isolated:!0,twoway:!0,debug:!0,data:{settingsOpen:!1,state:null},components:{CircularProgress:a("./circular-progress"),ServicesList:a("./services-list")},computed:{percentThrough:function(){var a,b,c,d=this.get("start"),e=this.get("end"),f=this.get("now");return d&&e&&f?(a=e-d,b=f-d,c=b/a,c=100*c.toFixed(2)):this.get("state.isAvoiding")&&(c=100),0>c&&(c=0),c>100&&(c=100),c},timeLeft:function(){var a=this.get("now"),b=this.get("state.end"),c=b>a,d=null;return b&&a&&c&&(d=this.formatTimeDiff(Math.round(b-a))),d}},init:function(){this.observe("state.end",function(a){a&&!this.countdownTimerId?this.countdownTimerId=window.setInterval(function(){this.set("now",new Date)}.bind(this),1e3):(window.clearInterval(this.countdownTimerId),this.countdownTimerId=null)}),this.on("settings",function(){this.get("settingsOpen")||this.fire("settings-requested"),this.set("settingsOpen",!this.get("settingsOpen"))}),this.on("avoid-service-setting",function(a){this.set("state.settings.serviceId",a),this.fire("settings-changed",this.get("state.settings"))}),this.on("state-settings-avoid-type",function(a){this.set("state.settings.avoidType",a.node.value),this.fire("settings-changed",this.get("state.settings"))})},formatTimeDiff:function(a){var b=a/1e3,c=b/60,d=Math.abs(Math.floor(c)-c);return d=Math.floor(60*d),10>d&&(d="0"+d),Math.floor(c)+"m "+d}})},{"./circular-progress":12,"./services-list":15,ractive:50}],12:[function(a,b){var c,d,e,f=a("ractive"),g=a("../lib/d3");c=g.svg.arc().innerRadius(44.4827586).outerRadius(50).startAngle(0),d=g.svg.arc().innerRadius(49.5).outerRadius(50).startAngle(0),e=g.scale.linear().domain([0,100]).range([0,2*Math.PI]).clamp([!0]);var h={outerArcPath:d({endAngle:2*Math.PI}),progressArcPath:c({endAngle:0})},i=f.extend({template:"#progressTempl",isolated:!0,twoway:!1,debug:!0,computed:{angle:function(){var a=this.get("percentThrough");return a?e(a):0}},init:function(){this.set(h),this.observe("angle",function(a){arc=c,this.set({progressArcPath:arc({endAngle:a})})})}});b.exports=i},{"../lib/d3":19,ractive:50}],13:[function(a,b){var c=a("ractive");b.exports=c.extend({template:"#controlsTmpl",isolated:!0,twoway:!1,debug:!0,components:{Playout:a("./simple")("#playoutTmpl"),ServicesList:a("./services-list"),Volume:a("./simple")("#volumeTmpl"),Metadata:a("./metadata"),Avoider:a("./avoider"),Announcer:a("./announcer")},data:{servicesPanel:{isOpen:!1}},init:function(){this.on({"services-panel-toggle":function(){var a=this.get("servicesPanel.isOpen");this.set("servicesPanel.isOpen",!a)},"volume-panel-toggle":function(){var a=this.get("volume.isOpen");this.set("volume.isOpen",!a)}})}})},{"./announcer":10,"./avoider":11,"./metadata":14,"./services-list":15,"./simple":16,ractive:50}],14:[function(a,b){var c=a("ractive");b.exports=c.extend({template:"#metadataTmpl",isolated:!0,debug:!0,twoway:!1,data:{view:"prog",first:function(a){return a[0]},imageUrl:function(a,b){return a.replace("$recipe",b)}},init:function(){this.on("track-display",function(){console.log("track-display");var a=this.get("view");this.set("view","track"===a?"prog":"track")})}})},{ractive:50}],15:[function(a,b){var c=a("ractive");b.exports=c.extend({template:"#servicesTmpl",isolated:!0,twoway:!1,debug:!0,init:function(){var a=this;this.on({"services-partial":function(b){b.original.preventDefault();var c=b.context.id;a.fire("selected",c)}})}})},{ractive:50}],16:[function(a,b){var c=a("ractive");b.exports=function(b){return c.extend({template:b,isolated:!0,twoway:!1,debug:!0,components:{ServicesList:a("./services-list")}})}},{"./services-list":15,ractive:50}],17:[function(a,b){b.exports={ActionTypes:{RECEIVE_INITIAL_STATE:"RECEIVE_INITIAL_STATE",RECEIVE_STATE_UPDATE:"RECEIVE_STATE_UPDATE",RECEIVE_AVOIDER_SETTINGS:"RECEIVE_AVOIDER_SETTINGS",RECEIVE_RADIO_SETTINGS:"RECEIVE_RADIO_SETTINGS",POWER:"power",AUDIO:"audio",SERVICE:"service",SETTINGS:"settings",NOW_AND_NEXT:"nowAndNext",NOW_PLAYING:"nowPlaying",AVOIDER:"avoider",ANNOUNCER:"announcer"},Payload:{SERVER_ACTION:"SERVER_ACTION",VIEW_ACTION:"VIEW_ACTION"}}},{}],18:[function(a,b){var c=a("underscore"),d=a("../lib/flux").Dispatcher,e=a("../constants/constants");b.exports=c.extend(new d,{handleServerAction:function(a){var b={source:e.Payload.SERVER_ACTION,action:a};this.dispatch(b)},handleViewAction:function(a){var b={source:e.Payload.VIEW_ACTION,action:a};this.dispatch(b)}})},{"../constants/constants":17,"../lib/flux":20,underscore:51}],19:[function(a,b){!function(){function a(a,b){return b>a?-1:a>b?1:a>=b?0:0/0}function c(a){return null!=a&&!isNaN(a)}function d(a){return{left:function(b,c,d,e){for(arguments.length<3&&(d=0),arguments.length<4&&(e=b.length);e>d;){var f=d+e>>>1;a(b[f],c)<0?d=f+1:e=f}return d},right:function(b,c,d,e){for(arguments.length<3&&(d=0),arguments.length<4&&(e=b.length);e>d;){var f=d+e>>>1;a(b[f],c)>0?e=f:d=f+1}return d}}}function e(a){return a.length}function f(a){for(var b=1;a*b%1;)b*=10;return b}function g(a,b){try{for(var c in b)Object.defineProperty(a.prototype,c,{value:b[c],enumerable:!1})}catch(d){a.prototype=b}}function h(){}function i(a){return nh+a in this}function j(a){return a=nh+a,a in this&&delete this[a]}function k(){var a=[];return this.forEach(function(b){a.push(b)}),a}function l(){var a=0;for(var b in this)b.charCodeAt(0)===oh&&++a;return a}function m(){for(var a in this)if(a.charCodeAt(0)===oh)return!1;return!0}function n(){}function o(a,b,c){return function(){var d=c.apply(b,arguments);return d===b?a:d}}function p(a,b){if(b in a)return b;b=b.charAt(0).toUpperCase()+b.substring(1);for(var c=0,d=ph.length;d>c;++c){var e=ph[c]+b;if(e in a)return e}}function q(){}function r(){}function s(a){function b(){for(var b,d=c,e=-1,f=d.length;++e<f;)(b=d[e].on)&&b.apply(this,arguments);return a}var c=[],d=new h;return b.on=function(b,e){var f,g=d.get(b);return arguments.length<2?g&&g.on:(g&&(g.on=null,c=c.slice(0,f=c.indexOf(g)).concat(c.slice(f+1)),d.remove(b)),e&&c.push(d.set(b,{on:e})),a)},b}function t(){$g.event.preventDefault()}function u(){for(var a,b=$g.event;a=b.sourceEvent;)b=a;return b}function v(a){for(var b=new r,c=0,d=arguments.length;++c<d;)b[arguments[c]]=s(b);return b.of=function(c,d){return function(e){try{var f=e.sourceEvent=$g.event;e.target=a,$g.event=e,b[e.type].apply(c,d)}finally{$g.event=f}}},b}function w(a){return rh(a,wh),a}function x(a){return"function"==typeof a?a:function(){return sh(a,this)}}function y(a){return"function"==typeof a?a:function(){return th(a,this)}}function z(a,b){function c(){this.removeAttribute(a)}function d(){this.removeAttributeNS(a.space,a.local)}function e(){this.setAttribute(a,b)}function f(){this.setAttributeNS(a.space,a.local,b)}function g(){var c=b.apply(this,arguments);null==c?this.removeAttribute(a):this.setAttribute(a,c)}function h(){var c=b.apply(this,arguments);null==c?this.removeAttributeNS(a.space,a.local):this.setAttributeNS(a.space,a.local,c)}return a=$g.ns.qualify(a),null==b?a.local?d:c:"function"==typeof b?a.local?h:g:a.local?f:e}function A(a){return a.trim().replace(/\s+/g," ")}function B(a){return new RegExp("(?:^|\\s+)"+$g.requote(a)+"(?:\\s+|$)","g")}function C(a){return a.trim().split(/^|\s+/)}function D(a,b){function c(){for(var c=-1;++c<e;)a[c](this,b)}function d(){for(var c=-1,d=b.apply(this,arguments);++c<e;)a[c](this,d)}a=C(a).map(E);var e=a.length;return"function"==typeof b?d:c}function E(a){var b=B(a);return function(c,d){if(e=c.classList)return d?e.add(a):e.remove(a);var e=c.getAttribute("class")||"";d?(b.lastIndex=0,b.test(e)||c.setAttribute("class",A(e+" "+a))):c.setAttribute("class",A(e.replace(b," ")))}}function F(a,b,c){function d(){this.style.removeProperty(a)}function e(){this.style.setProperty(a,b,c)}function f(){var d=b.apply(this,arguments);null==d?this.style.removeProperty(a):this.style.setProperty(a,d,c)}return null==b?d:"function"==typeof b?f:e}function G(a,b){function c(){delete this[a]}function d(){this[a]=b}function e(){var c=b.apply(this,arguments);null==c?delete this[a]:this[a]=c}return null==b?c:"function"==typeof b?e:d}function H(a){return"function"==typeof a?a:(a=$g.ns.qualify(a)).local?function(){return this.ownerDocument.createElementNS(a.space,a.local)}:function(){return this.ownerDocument.createElementNS(this.namespaceURI,a)}}function I(a){return{__data__:a}}function J(a){return function(){return vh(this,a)}}function K(b){return arguments.length||(b=a),function(a,c){return a&&c?b(a.__data__,c.__data__):!a-!c}}function L(a,b){for(var c=0,d=a.length;d>c;c++)for(var e,f=a[c],g=0,h=f.length;h>g;g++)(e=f[g])&&b(e,g,c);return a}function M(a){return rh(a,yh),a}function N(a){var b,c;return function(d,e,f){var g,h=a[f].update,i=h.length;for(f!=c&&(c=f,b=0),e>=b&&(b=e+1);!(g=h[b])&&++b<i;);return g}}function O(){var a=this.__transition__;a&&++a.active}function P(a,b,c){function d(){var b=this[g];b&&(this.removeEventListener(a,b,b.$),delete this[g])}function e(){var e=i(b,ah(arguments));d.call(this),this.addEventListener(a,this[g]=e,e.$=c),e._=b}function f(){var b,c=new RegExp("^__on([^.]+)"+$g.requote(a)+"$");for(var d in this)if(b=d.match(c)){var e=this[d];this.removeEventListener(b[1],e,e.$),delete this[d]}}var g="__on"+a,h=a.indexOf("."),i=Q;h>0&&(a=a.substring(0,h));var j=Ah.get(a);return j&&(a=j,i=R),h?b?e:d:b?q:f}function Q(a,b){return function(c){var d=$g.event;$g.event=c,b[0]=this.__data__;try{a.apply(this,b)}finally{$g.event=d}}}function R(a,b){var c=Q(a,b);return function(a){var b=this,d=a.relatedTarget;d&&(d===b||8&d.compareDocumentPosition(b))||c.call(b,a)}}function S(){var a=".dragsuppress-"+ ++Ch,b="click"+a,c=$g.select(dh).on("touchmove"+a,t).on("dragstart"+a,t).on("selectstart"+a,t);if(Bh){var d=ch.style,e=d[Bh];d[Bh]="none"}return function(f){function g(){c.on(b,null)}c.on(a,null),Bh&&(d[Bh]=e),f&&(c.on(b,function(){t(),g()},!0),setTimeout(g,0))}}function T(a,b){b.changedTouches&&(b=b.changedTouches[0]);var c=a.ownerSVGElement||a;if(c.createSVGPoint){var d=c.createSVGPoint();return d.x=b.clientX,d.y=b.clientY,d=d.matrixTransform(a.getScreenCTM().inverse()),[d.x,d.y]}var e=a.getBoundingClientRect();return[b.clientX-e.left-a.clientLeft,b.clientY-e.top-a.clientTop]}function U(){return $g.event.changedTouches[0].identifier}function V(){return $g.event.target}function W(){return dh}function X(a){return a>0?1:0>a?-1:0}function Y(a,b,c){return(b[0]-a[0])*(c[1]-a[1])-(b[1]-a[1])*(c[0]-a[0])}function Z(a){return a>1?0:-1>a?Dh:Math.acos(a)}function $(a){return a>1?Fh:-1>a?-Fh:Math.asin(a)}function _(a){return((a=Math.exp(a))-1/a)/2}function ab(a){return((a=Math.exp(a))+1/a)/2}function bb(a){return((a=Math.exp(2*a))-1)/(a+1)}function cb(a){return(a=Math.sin(a/2))*a}function db(){}function eb(a,b,c){return new fb(a,b,c)}function fb(a,b,c){this.h=a,this.s=b,this.l=c}function gb(a,b,c){function d(a){return a>360?a-=360:0>a&&(a+=360),60>a?f+(g-f)*a/60:180>a?g:240>a?f+(g-f)*(240-a)/60:f}function e(a){return Math.round(255*d(a))}var f,g;return a=isNaN(a)?0:(a%=360)<0?a+360:a,b=isNaN(b)?0:0>b?0:b>1?1:b,c=0>c?0:c>1?1:c,g=.5>=c?c*(1+b):c+b-c*b,f=2*c-g,tb(e(a+120),e(a),e(a-120))}function hb(a,b,c){return new ib(a,b,c)}function ib(a,b,c){this.h=a,this.c=b,this.l=c}function jb(a,b,c){return isNaN(a)&&(a=0),isNaN(b)&&(b=0),kb(c,Math.cos(a*=Ih)*b,Math.sin(a)*b)}function kb(a,b,c){return new lb(a,b,c)}function lb(a,b,c){this.l=a,this.a=b,this.b=c}function mb(a,b,c){var d=(a+16)/116,e=d+b/500,f=d-c/200;return e=ob(e)*Th,d=ob(d)*Uh,f=ob(f)*Vh,tb(qb(3.2404542*e-1.5371385*d-.4985314*f),qb(-.969266*e+1.8760108*d+.041556*f),qb(.0556434*e-.2040259*d+1.0572252*f))}function nb(a,b,c){return a>0?hb(Math.atan2(c,b)*Jh,Math.sqrt(b*b+c*c),a):hb(0/0,0/0,a)}function ob(a){return a>.206893034?a*a*a:(a-4/29)/7.787037}function pb(a){return a>.008856?Math.pow(a,1/3):7.787037*a+4/29}function qb(a){return Math.round(255*(.00304>=a?12.92*a:1.055*Math.pow(a,1/2.4)-.055))}function rb(a){return tb(a>>16,a>>8&255,255&a)}function sb(a){return rb(a)+""}function tb(a,b,c){return new ub(a,b,c)}function ub(a,b,c){this.r=a,this.g=b,this.b=c}function vb(a){return 16>a?"0"+Math.max(0,a).toString(16):Math.min(255,a).toString(16)}function wb(a,b,c){var d,e,f,g=0,h=0,i=0;if(d=/([a-z]+)\((.*)\)/i.exec(a))switch(e=d[2].split(","),d[1]){case"hsl":return c(parseFloat(e[0]),parseFloat(e[1])/100,parseFloat(e[2])/100);case"rgb":return b(Ab(e[0]),Ab(e[1]),Ab(e[2]))}return(f=Yh.get(a))?b(f.r,f.g,f.b):(null==a||"#"!==a.charAt(0)||isNaN(f=parseInt(a.substring(1),16))||(4===a.length?(g=(3840&f)>>4,g=g>>4|g,h=240&f,h=h>>4|h,i=15&f,i=i<<4|i):7===a.length&&(g=(16711680&f)>>16,h=(65280&f)>>8,i=255&f)),b(g,h,i))}function xb(a,b,c){var d,e,f=Math.min(a/=255,b/=255,c/=255),g=Math.max(a,b,c),h=g-f,i=(g+f)/2;return h?(e=.5>i?h/(g+f):h/(2-g-f),d=a==g?(b-c)/h+(c>b?6:0):b==g?(c-a)/h+2:(a-b)/h+4,d*=60):(d=0/0,e=i>0&&1>i?0:d),eb(d,e,i)}function yb(a,b,c){a=zb(a),b=zb(b),c=zb(c);var d=pb((.4124564*a+.3575761*b+.1804375*c)/Th),e=pb((.2126729*a+.7151522*b+.072175*c)/Uh),f=pb((.0193339*a+.119192*b+.9503041*c)/Vh);return kb(116*e-16,500*(d-e),200*(e-f))}function zb(a){return(a/=255)<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function Ab(a){var b=parseFloat(a);return"%"===a.charAt(a.length-1)?Math.round(2.55*b):b}function Bb(a){return"function"==typeof a?a:function(){return a}}function Cb(a){return a}function Db(a){return function(b,c,d){return 2===arguments.length&&"function"==typeof c&&(d=c,c=null),Eb(b,c,a,d)}}function Eb(a,b,c,d){function e(){var a,b=i.status;if(!b&&i.responseText||b>=200&&300>b||304===b){try{a=c.call(f,i)}catch(d){return void g.error.call(f,d)}g.load.call(f,a)}else g.error.call(f,i)}var f={},g=$g.dispatch("beforesend","progress","load","error"),h={},i=new XMLHttpRequest,j=null;return!dh.XDomainRequest||"withCredentials"in i||!/^(http(s)?:)?\/\//.test(a)||(i=new XDomainRequest),"onload"in i?i.onload=i.onerror=e:i.onreadystatechange=function(){i.readyState>3&&e()},i.onprogress=function(a){var b=$g.event;$g.event=a;try{g.progress.call(f,i)}finally{$g.event=b}},f.header=function(a,b){return a=(a+"").toLowerCase(),arguments.length<2?h[a]:(null==b?delete h[a]:h[a]=b+"",f)},f.mimeType=function(a){return arguments.length?(b=null==a?null:a+"",f):b},f.responseType=function(a){return arguments.length?(j=a,f):j},f.response=function(a){return c=a,f},["get","post"].forEach(function(a){f[a]=function(){return f.send.apply(f,[a].concat(ah(arguments)))}}),f.send=function(c,d,e){if(2===arguments.length&&"function"==typeof d&&(e=d,d=null),i.open(c,a,!0),null==b||"accept"in h||(h.accept=b+",*/*"),i.setRequestHeader)for(var k in h)i.setRequestHeader(k,h[k]);return null!=b&&i.overrideMimeType&&i.overrideMimeType(b),null!=j&&(i.responseType=j),null!=e&&f.on("error",e).on("load",function(a){e(null,a)}),g.beforesend.call(f,i),i.send(null==d?null:d),f},f.abort=function(){return i.abort(),f},$g.rebind(f,g,"on"),null==d?f:f.get(Fb(d))}function Fb(a){return 1===a.length?function(b,c){a(null==b?c:null)}:a}function Gb(){var a=Hb(),b=Ib()-a;b>24?(isFinite(b)&&(clearTimeout(ai),ai=setTimeout(Gb,b)),_h=0):(_h=1,ci(Gb))}function Hb(){var a=Date.now();for(bi=Zh;bi;)a>=bi.t&&(bi.f=bi.c(a-bi.t)),bi=bi.n;return a}function Ib(){for(var a,b=Zh,c=1/0;b;)b.f?b=a?a.n=b.n:Zh=b.n:(b.t<c&&(c=b.t),b=(a=b).n);return $h=a,c}function Jb(a,b){return b-(a?Math.ceil(Math.log(a)/Math.LN10):1)}function Kb(a,b){var c=Math.pow(10,3*mh(8-b));return{scale:b>8?function(a){return a/c}:function(a){return a*c},symbol:a}}function Lb(a){var b=a.decimal,c=a.thousands,d=a.grouping,e=a.currency,f=d?function(a){for(var b=a.length,e=[],f=0,g=d[0];b>0&&g>0;)e.push(a.substring(b-=g,b+g)),g=d[f=(f+1)%d.length];return e.reverse().join(c)}:Cb;return function(a){var c=ei.exec(a),d=c[1]||" ",g=c[2]||">",h=c[3]||"",i=c[4]||"",j=c[5],k=+c[6],l=c[7],m=c[8],n=c[9],o=1,p="",q="",r=!1;switch(m&&(m=+m.substring(1)),(j||"0"===d&&"="===g)&&(j=d="0",g="=",l&&(k-=Math.floor((k-1)/4))),n){case"n":l=!0,n="g";break;case"%":o=100,q="%",n="f";break;case"p":o=100,q="%",n="r";break;case"b":case"o":case"x":case"X":"#"===i&&(p="0"+n.toLowerCase());case"c":case"d":r=!0,m=0;break;case"s":o=-1,n="r"}"$"===i&&(p=e[0],q=e[1]),"r"!=n||m||(n="g"),null!=m&&("g"==n?m=Math.max(1,Math.min(21,m)):("e"==n||"f"==n)&&(m=Math.max(0,Math.min(20,m)))),n=fi.get(n)||Mb;var s=j&&l;return function(a){var c=q;if(r&&a%1)return"";var e=0>a||0===a&&0>1/a?(a=-a,"-"):h;if(0>o){var i=$g.formatPrefix(a,m);a=i.scale(a),c=i.symbol+q}else a*=o;a=n(a,m);var t=a.lastIndexOf("."),u=0>t?a:a.substring(0,t),v=0>t?"":b+a.substring(t+1);!j&&l&&(u=f(u));var w=p.length+u.length+v.length+(s?0:e.length),x=k>w?new Array(w=k-w+1).join(d):"";return s&&(u=f(x+u)),e+=p,a=u+v,("<"===g?e+a+x:">"===g?x+e+a:"^"===g?x.substring(0,w>>=1)+e+a+x.substring(w):e+(s?a:x+a))+c}}}function Mb(a){return a+""}function Nb(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}function Ob(a,b,c){function d(b){var c=a(b),d=f(c,1);return d-b>b-c?c:d}function e(c){return b(c=a(new hi(c-1)),1),c}function f(a,c){return b(a=new hi(+a),c),a}function g(a,d,f){var g=e(a),h=[];if(f>1)for(;d>g;)c(g)%f||h.push(new Date(+g)),b(g,1);else for(;d>g;)h.push(new Date(+g)),b(g,1);return h}function h(a,b,c){try{hi=Nb;var d=new Nb;return d._=a,g(d,b,c)}finally{hi=Date}}a.floor=a,a.round=d,a.ceil=e,a.offset=f,a.range=g;var i=a.utc=Pb(a);return i.floor=i,i.round=Pb(d),i.ceil=Pb(e),i.offset=Pb(f),i.range=h,a}function Pb(a){return function(b,c){try{hi=Nb;var d=new Nb;return d._=b,a(d,c)._}finally{hi=Date}}}function Qb(a){function b(a){function b(b){for(var c,e,f,g=[],h=-1,i=0;++h<d;)37===a.charCodeAt(h)&&(g.push(a.substring(i,h)),null!=(e=ji[c=a.charAt(++h)])&&(c=a.charAt(++h)),(f=C[c])&&(c=f(b,null==e?"e"===c?" ":"0":e)),g.push(c),i=h+1);return g.push(a.substring(i,h)),g.join("")}var d=a.length;return b.parse=function(b){var d={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null},e=c(d,a,b,0);if(e!=b.length)return null;"p"in d&&(d.H=d.H%12+12*d.p);var f=null!=d.Z&&hi!==Nb,g=new(f?Nb:hi);return"j"in d?g.setFullYear(d.y,0,d.j):"w"in d&&("W"in d||"U"in d)?(g.setFullYear(d.y,0,1),g.setFullYear(d.y,0,"W"in d?(d.w+6)%7+7*d.W-(g.getDay()+5)%7:d.w+7*d.U-(g.getDay()+6)%7)):g.setFullYear(d.y,d.m,d.d),g.setHours(d.H+Math.floor(d.Z/100),d.M+d.Z%100,d.S,d.L),f?g._:g},b.toString=function(){return a},b}function c(a,b,c,d){for(var e,f,g,h=0,i=b.length,j=c.length;i>h;){if(d>=j)return-1;if(e=b.charCodeAt(h++),37===e){if(g=b.charAt(h++),f=D[g in ji?b.charAt(h++):g],!f||(d=f(a,c,d))<0)return-1}else if(e!=c.charCodeAt(d++))return-1}return d}function d(a,b,c){w.lastIndex=0;var d=w.exec(b.substring(c));return d?(a.w=x.get(d[0].toLowerCase()),c+d[0].length):-1}function e(a,b,c){u.lastIndex=0;var d=u.exec(b.substring(c));return d?(a.w=v.get(d[0].toLowerCase()),c+d[0].length):-1}function f(a,b,c){A.lastIndex=0;var d=A.exec(b.substring(c));return d?(a.m=B.get(d[0].toLowerCase()),c+d[0].length):-1}function g(a,b,c){y.lastIndex=0;var d=y.exec(b.substring(c));return d?(a.m=z.get(d[0].toLowerCase()),c+d[0].length):-1}function h(a,b,d){return c(a,C.c.toString(),b,d)}function i(a,b,d){return c(a,C.x.toString(),b,d)}function j(a,b,d){return c(a,C.X.toString(),b,d)}function k(a,b,c){var d=t.get(b.substring(c,c+=2).toLowerCase());return null==d?-1:(a.p=d,c)}var l=a.dateTime,m=a.date,n=a.time,o=a.periods,p=a.days,q=a.shortDays,r=a.months,s=a.shortMonths;b.utc=function(a){function c(a){try{hi=Nb;var b=new hi;return b._=a,d(b)}finally{hi=Date}}var d=b(a);return c.parse=function(a){try{hi=Nb;var b=d.parse(a);return b&&b._}finally{hi=Date}},c.toString=d.toString,c},b.multi=b.utc.multi=ic;var t=$g.map(),u=Sb(p),v=Tb(p),w=Sb(q),x=Tb(q),y=Sb(r),z=Tb(r),A=Sb(s),B=Tb(s);o.forEach(function(a,b){t.set(a.toLowerCase(),b)});var C={a:function(a){return q[a.getDay()]},A:function(a){return p[a.getDay()]},b:function(a){return s[a.getMonth()]},B:function(a){return r[a.getMonth()]},c:b(l),d:function(a,b){return Rb(a.getDate(),b,2)},e:function(a,b){return Rb(a.getDate(),b,2)},H:function(a,b){return Rb(a.getHours(),b,2)},I:function(a,b){return Rb(a.getHours()%12||12,b,2)},j:function(a,b){return Rb(1+gi.dayOfYear(a),b,3)},L:function(a,b){return Rb(a.getMilliseconds(),b,3)},m:function(a,b){return Rb(a.getMonth()+1,b,2)},M:function(a,b){return Rb(a.getMinutes(),b,2)},p:function(a){return o[+(a.getHours()>=12)]},S:function(a,b){return Rb(a.getSeconds(),b,2)},U:function(a,b){return Rb(gi.sundayOfYear(a),b,2)},w:function(a){return a.getDay()},W:function(a,b){return Rb(gi.mondayOfYear(a),b,2)},x:b(m),X:b(n),y:function(a,b){return Rb(a.getFullYear()%100,b,2)},Y:function(a,b){return Rb(a.getFullYear()%1e4,b,4)},Z:gc,"%":function(){return"%"}},D={a:d,A:e,b:f,B:g,c:h,d:ac,e:ac,H:cc,I:cc,j:bc,L:fc,m:_b,M:dc,p:k,S:ec,U:Vb,w:Ub,W:Wb,x:i,X:j,y:Yb,Y:Xb,Z:Zb,"%":hc};return b}function Rb(a,b,c){var d=0>a?"-":"",e=(d?-a:a)+"",f=e.length;return d+(c>f?new Array(c-f+1).join(b)+e:e)}function Sb(a){return new RegExp("^(?:"+a.map($g.requote).join("|")+")","i")}function Tb(a){for(var b=new h,c=-1,d=a.length;++c<d;)b.set(a[c].toLowerCase(),c);return b}function Ub(a,b,c){ki.lastIndex=0;var d=ki.exec(b.substring(c,c+1));return d?(a.w=+d[0],c+d[0].length):-1}function Vb(a,b,c){ki.lastIndex=0;var d=ki.exec(b.substring(c));return d?(a.U=+d[0],c+d[0].length):-1}function Wb(a,b,c){ki.lastIndex=0;var d=ki.exec(b.substring(c));return d?(a.W=+d[0],c+d[0].length):-1}function Xb(a,b,c){ki.lastIndex=0;var d=ki.exec(b.substring(c,c+4));return d?(a.y=+d[0],c+d[0].length):-1}function Yb(a,b,c){ki.lastIndex=0;var d=ki.exec(b.substring(c,c+2));return d?(a.y=$b(+d[0]),c+d[0].length):-1}function Zb(a,b,c){return/^[+-]\d{4}$/.test(b=b.substring(c,c+5))?(a.Z=+b,c+5):-1}function $b(a){return a+(a>68?1900:2e3)}function _b(a,b,c){ki.lastIndex=0;var d=ki.exec(b.substring(c,c+2));return d?(a.m=d[0]-1,c+d[0].length):-1}function ac(a,b,c){ki.lastIndex=0;var d=ki.exec(b.substring(c,c+2));return d?(a.d=+d[0],c+d[0].length):-1}function bc(a,b,c){ki.lastIndex=0;var d=ki.exec(b.substring(c,c+3));return d?(a.j=+d[0],c+d[0].length):-1}function cc(a,b,c){ki.lastIndex=0;var d=ki.exec(b.substring(c,c+2));return d?(a.H=+d[0],c+d[0].length):-1}function dc(a,b,c){ki.lastIndex=0;var d=ki.exec(b.substring(c,c+2));return d?(a.M=+d[0],c+d[0].length):-1}function ec(a,b,c){ki.lastIndex=0;var d=ki.exec(b.substring(c,c+2));return d?(a.S=+d[0],c+d[0].length):-1}function fc(a,b,c){ki.lastIndex=0;var d=ki.exec(b.substring(c,c+3));return d?(a.L=+d[0],c+d[0].length):-1}function gc(a){var b=a.getTimezoneOffset(),c=b>0?"-":"+",d=~~(mh(b)/60),e=mh(b)%60;return c+Rb(d,"0",2)+Rb(e,"0",2)}function hc(a,b,c){li.lastIndex=0;var d=li.exec(b.substring(c,c+1));return d?c+d[0].length:-1}function ic(a){for(var b=a.length,c=-1;++c<b;)a[c][0]=this(a[c][0]);return function(b){for(var c=0,d=a[c];!d[1](b);)d=a[++c];return d[0](b)}}function jc(){}function kc(a,b,c){var d=c.s=a+b,e=d-a,f=d-e;c.t=a-f+(b-e)}function lc(a,b){a&&pi.hasOwnProperty(a.type)&&pi[a.type](a,b)}function mc(a,b,c){var d,e=-1,f=a.length-c;for(b.lineStart();++e<f;)d=a[e],b.point(d[0],d[1],d[2]);b.lineEnd()}function nc(a,b){var c=-1,d=a.length;for(b.polygonStart();++c<d;)mc(a[c],b,1);b.polygonEnd()}function oc(){function a(a,b){a*=Ih,b=b*Ih/2+Dh/4;var c=a-d,g=c>=0?1:-1,h=g*c,i=Math.cos(b),j=Math.sin(b),k=f*j,l=e*i+k*Math.cos(h),m=k*g*Math.sin(h);ri.add(Math.atan2(m,l)),d=a,e=i,f=j}var b,c,d,e,f;si.point=function(g,h){si.point=a,d=(b=g)*Ih,e=Math.cos(h=(c=h)*Ih/2+Dh/4),f=Math.sin(h)},si.lineEnd=function(){a(b,c)}}function pc(a){var b=a[0],c=a[1],d=Math.cos(c);return[d*Math.cos(b),d*Math.sin(b),Math.sin(c)]}function qc(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]}function rc(a,b){return[a[1]*b[2]-a[2]*b[1],a[2]*b[0]-a[0]*b[2],a[0]*b[1]-a[1]*b[0]]}function sc(a,b){a[0]+=b[0],a[1]+=b[1],a[2]+=b[2]}function tc(a,b){return[a[0]*b,a[1]*b,a[2]*b]}function uc(a){var b=Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2]);a[0]/=b,a[1]/=b,a[2]/=b}function vc(a){return[Math.atan2(a[1],a[0]),$(a[2])]}function wc(a,b){return mh(a[0]-b[0])<Gh&&mh(a[1]-b[1])<Gh}function xc(a,b){a*=Ih;var c=Math.cos(b*=Ih);yc(c*Math.cos(a),c*Math.sin(a),Math.sin(b))}function yc(a,b,c){++ti,vi+=(a-vi)/ti,wi+=(b-wi)/ti,xi+=(c-xi)/ti}function zc(){function a(a,e){a*=Ih;var f=Math.cos(e*=Ih),g=f*Math.cos(a),h=f*Math.sin(a),i=Math.sin(e),j=Math.atan2(Math.sqrt((j=c*i-d*h)*j+(j=d*g-b*i)*j+(j=b*h-c*g)*j),b*g+c*h+d*i);ui+=j,yi+=j*(b+(b=g)),zi+=j*(c+(c=h)),Ai+=j*(d+(d=i)),yc(b,c,d)}var b,c,d;Ei.point=function(e,f){e*=Ih;var g=Math.cos(f*=Ih);b=g*Math.cos(e),c=g*Math.sin(e),d=Math.sin(f),Ei.point=a,yc(b,c,d)}}function Ac(){Ei.point=xc}function Bc(){function a(a,b){a*=Ih;var c=Math.cos(b*=Ih),g=c*Math.cos(a),h=c*Math.sin(a),i=Math.sin(b),j=e*i-f*h,k=f*g-d*i,l=d*h-e*g,m=Math.sqrt(j*j+k*k+l*l),n=d*g+e*h+f*i,o=m&&-Z(n)/m,p=Math.atan2(m,n);Bi+=o*j,Ci+=o*k,Di+=o*l,ui+=p,yi+=p*(d+(d=g)),zi+=p*(e+(e=h)),Ai+=p*(f+(f=i)),yc(d,e,f)}var b,c,d,e,f;Ei.point=function(g,h){b=g,c=h,Ei.point=a,g*=Ih;var i=Math.cos(h*=Ih);d=i*Math.cos(g),e=i*Math.sin(g),f=Math.sin(h),yc(d,e,f)},Ei.lineEnd=function(){a(b,c),Ei.lineEnd=Ac,Ei.point=xc}}function Cc(){return!0}function Dc(a,b,c,d,e){var f=[],g=[];
if(a.forEach(function(a){if(!((b=a.length-1)<=0)){var b,c=a[0],d=a[b];if(wc(c,d)){e.lineStart();for(var h=0;b>h;++h)e.point((c=a[h])[0],c[1]);return void e.lineEnd()}var i=new Fc(c,a,null,!0),j=new Fc(c,null,i,!1);i.o=j,f.push(i),g.push(j),i=new Fc(d,a,null,!1),j=new Fc(d,null,i,!0),i.o=j,f.push(i),g.push(j)}}),g.sort(b),Ec(f),Ec(g),f.length){for(var h=0,i=c,j=g.length;j>h;++h)g[h].e=i=!i;for(var k,l,m=f[0];;){for(var n=m,o=!0;n.v;)if((n=n.n)===m)return;k=n.z,e.lineStart();do{if(n.v=n.o.v=!0,n.e){if(o)for(var h=0,j=k.length;j>h;++h)e.point((l=k[h])[0],l[1]);else d(n.x,n.n.x,1,e);n=n.n}else{if(o){k=n.p.z;for(var h=k.length-1;h>=0;--h)e.point((l=k[h])[0],l[1])}else d(n.x,n.p.x,-1,e);n=n.p}n=n.o,k=n.z,o=!o}while(!n.v);e.lineEnd()}}}function Ec(a){if(b=a.length){for(var b,c,d=0,e=a[0];++d<b;)e.n=c=a[d],c.p=e,e=c;e.n=c=a[0],c.p=e}}function Fc(a,b,c,d){this.x=a,this.z=b,this.o=c,this.e=d,this.v=!1,this.n=this.p=null}function Gc(a,b,c,d){return function(e,f){function g(b,c){var d=e(b,c);a(b=d[0],c=d[1])&&f.point(b,c)}function h(a,b){var c=e(a,b);q.point(c[0],c[1])}function i(){s.point=h,q.lineStart()}function j(){s.point=g,q.lineEnd()}function k(a,b){p.push([a,b]);var c=e(a,b);u.point(c[0],c[1])}function l(){u.lineStart(),p=[]}function m(){k(p[0][0],p[0][1]),u.lineEnd();var a,b=u.clean(),c=t.buffer(),d=c.length;if(p.pop(),o.push(p),p=null,d){if(1&b){a=c[0];var e,d=a.length-1,g=-1;for(f.lineStart();++g<d;)f.point((e=a[g])[0],e[1]);return void f.lineEnd()}d>1&&2&b&&c.push(c.pop().concat(c.shift())),n.push(c.filter(Hc))}}var n,o,p,q=b(f),r=e.invert(d[0],d[1]),s={point:g,lineStart:i,lineEnd:j,polygonStart:function(){s.point=k,s.lineStart=l,s.lineEnd=m,n=[],o=[],f.polygonStart()},polygonEnd:function(){s.point=g,s.lineStart=i,s.lineEnd=j,n=$g.merge(n);var a=Kc(r,o);n.length?Dc(n,Jc,a,c,f):a&&(f.lineStart(),c(null,null,1,f),f.lineEnd()),f.polygonEnd(),n=o=null},sphere:function(){f.polygonStart(),f.lineStart(),c(null,null,1,f),f.lineEnd(),f.polygonEnd()}},t=Ic(),u=b(t);return s}}function Hc(a){return a.length>1}function Ic(){var a,b=[];return{lineStart:function(){b.push(a=[])},point:function(b,c){a.push([b,c])},lineEnd:q,buffer:function(){var c=b;return b=[],a=null,c},rejoin:function(){b.length>1&&b.push(b.pop().concat(b.shift()))}}}function Jc(a,b){return((a=a.x)[0]<0?a[1]-Fh-Gh:Fh-a[1])-((b=b.x)[0]<0?b[1]-Fh-Gh:Fh-b[1])}function Kc(a,b){var c=a[0],d=a[1],e=[Math.sin(c),-Math.cos(c),0],f=0,g=0;ri.reset();for(var h=0,i=b.length;i>h;++h){var j=b[h],k=j.length;if(k)for(var l=j[0],m=l[0],n=l[1]/2+Dh/4,o=Math.sin(n),p=Math.cos(n),q=1;;){q===k&&(q=0),a=j[q];var r=a[0],s=a[1]/2+Dh/4,t=Math.sin(s),u=Math.cos(s),v=r-m,w=v>=0?1:-1,x=w*v,y=x>Dh,z=o*t;if(ri.add(Math.atan2(z*w*Math.sin(x),p*u+z*Math.cos(x))),f+=y?v+w*Eh:v,y^m>=c^r>=c){var A=rc(pc(l),pc(a));uc(A);var B=rc(e,A);uc(B);var C=(y^v>=0?-1:1)*$(B[2]);(d>C||d===C&&(A[0]||A[1]))&&(g+=y^v>=0?1:-1)}if(!q++)break;m=r,o=t,p=u,l=a}}return(-Gh>f||Gh>f&&0>ri)^1&g}function Lc(a){var b,c=0/0,d=0/0,e=0/0;return{lineStart:function(){a.lineStart(),b=1},point:function(f,g){var h=f>0?Dh:-Dh,i=mh(f-c);mh(i-Dh)<Gh?(a.point(c,d=(d+g)/2>0?Fh:-Fh),a.point(e,d),a.lineEnd(),a.lineStart(),a.point(h,d),a.point(f,d),b=0):e!==h&&i>=Dh&&(mh(c-e)<Gh&&(c-=e*Gh),mh(f-h)<Gh&&(f-=h*Gh),d=Mc(c,d,f,g),a.point(e,d),a.lineEnd(),a.lineStart(),a.point(h,d),b=0),a.point(c=f,d=g),e=h},lineEnd:function(){a.lineEnd(),c=d=0/0},clean:function(){return 2-b}}}function Mc(a,b,c,d){var e,f,g=Math.sin(a-c);return mh(g)>Gh?Math.atan((Math.sin(b)*(f=Math.cos(d))*Math.sin(c)-Math.sin(d)*(e=Math.cos(b))*Math.sin(a))/(e*f*g)):(b+d)/2}function Nc(a,b,c,d){var e;if(null==a)e=c*Fh,d.point(-Dh,e),d.point(0,e),d.point(Dh,e),d.point(Dh,0),d.point(Dh,-e),d.point(0,-e),d.point(-Dh,-e),d.point(-Dh,0),d.point(-Dh,e);else if(mh(a[0]-b[0])>Gh){var f=a[0]<b[0]?Dh:-Dh;e=c*f/2,d.point(-f,e),d.point(0,e),d.point(f,e)}else d.point(b[0],b[1])}function Oc(a){function b(a,b){return Math.cos(a)*Math.cos(b)>f}function c(a){var c,f,i,j,k;return{lineStart:function(){j=i=!1,k=1},point:function(l,m){var n,o=[l,m],p=b(l,m),q=g?p?0:e(l,m):p?e(l+(0>l?Dh:-Dh),m):0;if(!c&&(j=i=p)&&a.lineStart(),p!==i&&(n=d(c,o),(wc(c,n)||wc(o,n))&&(o[0]+=Gh,o[1]+=Gh,p=b(o[0],o[1]))),p!==i)k=0,p?(a.lineStart(),n=d(o,c),a.point(n[0],n[1])):(n=d(c,o),a.point(n[0],n[1]),a.lineEnd()),c=n;else if(h&&c&&g^p){var r;q&f||!(r=d(o,c,!0))||(k=0,g?(a.lineStart(),a.point(r[0][0],r[0][1]),a.point(r[1][0],r[1][1]),a.lineEnd()):(a.point(r[1][0],r[1][1]),a.lineEnd(),a.lineStart(),a.point(r[0][0],r[0][1])))}!p||c&&wc(c,o)||a.point(o[0],o[1]),c=o,i=p,f=q},lineEnd:function(){i&&a.lineEnd(),c=null},clean:function(){return k|(j&&i)<<1}}}function d(a,b,c){var d=pc(a),e=pc(b),g=[1,0,0],h=rc(d,e),i=qc(h,h),j=h[0],k=i-j*j;if(!k)return!c&&a;var l=f*i/k,m=-f*j/k,n=rc(g,h),o=tc(g,l),p=tc(h,m);sc(o,p);var q=n,r=qc(o,q),s=qc(q,q),t=r*r-s*(qc(o,o)-1);if(!(0>t)){var u=Math.sqrt(t),v=tc(q,(-r-u)/s);if(sc(v,o),v=vc(v),!c)return v;var w,x=a[0],y=b[0],z=a[1],A=b[1];x>y&&(w=x,x=y,y=w);var B=y-x,C=mh(B-Dh)<Gh,D=C||Gh>B;if(!C&&z>A&&(w=z,z=A,A=w),D?C?z+A>0^v[1]<(mh(v[0]-x)<Gh?z:A):z<=v[1]&&v[1]<=A:B>Dh^(x<=v[0]&&v[0]<=y)){var E=tc(q,(-r+u)/s);return sc(E,o),[v,vc(E)]}}}function e(b,c){var d=g?a:Dh-a,e=0;return-d>b?e|=1:b>d&&(e|=2),-d>c?e|=4:c>d&&(e|=8),e}var f=Math.cos(a),g=f>0,h=mh(f)>Gh,i=od(a,6*Ih);return Gc(b,c,i,g?[0,-a]:[-Dh,a-Dh])}function Pc(a,b,c,d){return function(e){var f,g=e.a,h=e.b,i=g.x,j=g.y,k=h.x,l=h.y,m=0,n=1,o=k-i,p=l-j;if(f=a-i,o||!(f>0)){if(f/=o,0>o){if(m>f)return;n>f&&(n=f)}else if(o>0){if(f>n)return;f>m&&(m=f)}if(f=c-i,o||!(0>f)){if(f/=o,0>o){if(f>n)return;f>m&&(m=f)}else if(o>0){if(m>f)return;n>f&&(n=f)}if(f=b-j,p||!(f>0)){if(f/=p,0>p){if(m>f)return;n>f&&(n=f)}else if(p>0){if(f>n)return;f>m&&(m=f)}if(f=d-j,p||!(0>f)){if(f/=p,0>p){if(f>n)return;f>m&&(m=f)}else if(p>0){if(m>f)return;n>f&&(n=f)}return m>0&&(e.a={x:i+m*o,y:j+m*p}),1>n&&(e.b={x:i+n*o,y:j+n*p}),e}}}}}}function Qc(a,b,c,d){function e(d,e){return mh(d[0]-a)<Gh?e>0?0:3:mh(d[0]-c)<Gh?e>0?2:1:mh(d[1]-b)<Gh?e>0?1:0:e>0?3:2}function f(a,b){return g(a.x,b.x)}function g(a,b){var c=e(a,1),d=e(b,1);return c!==d?c-d:0===c?b[1]-a[1]:1===c?a[0]-b[0]:2===c?a[1]-b[1]:b[0]-a[0]}return function(h){function i(a){for(var b=0,c=q.length,d=a[1],e=0;c>e;++e)for(var f,g=1,h=q[e],i=h.length,j=h[0];i>g;++g)f=h[g],j[1]<=d?f[1]>d&&Y(j,f,a)>0&&++b:f[1]<=d&&Y(j,f,a)<0&&--b,j=f;return 0!==b}function j(f,h,i,j){var k=0,l=0;if(null==f||(k=e(f,i))!==(l=e(h,i))||g(f,h)<0^i>0){do j.point(0===k||3===k?a:c,k>1?d:b);while((k=(k+i+4)%4)!==l)}else j.point(h[0],h[1])}function k(e,f){return e>=a&&c>=e&&f>=b&&d>=f}function l(a,b){k(a,b)&&h.point(a,b)}function m(){D.point=o,q&&q.push(r=[]),y=!0,x=!1,v=w=0/0}function n(){p&&(o(s,t),u&&x&&B.rejoin(),p.push(B.buffer())),D.point=l,x&&h.lineEnd()}function o(a,b){a=Math.max(-Gi,Math.min(Gi,a)),b=Math.max(-Gi,Math.min(Gi,b));var c=k(a,b);if(q&&r.push([a,b]),y)s=a,t=b,u=c,y=!1,c&&(h.lineStart(),h.point(a,b));else if(c&&x)h.point(a,b);else{var d={a:{x:v,y:w},b:{x:a,y:b}};C(d)?(x||(h.lineStart(),h.point(d.a.x,d.a.y)),h.point(d.b.x,d.b.y),c||h.lineEnd(),z=!1):c&&(h.lineStart(),h.point(a,b),z=!1)}v=a,w=b,x=c}var p,q,r,s,t,u,v,w,x,y,z,A=h,B=Ic(),C=Pc(a,b,c,d),D={point:l,lineStart:m,lineEnd:n,polygonStart:function(){h=B,p=[],q=[],z=!0},polygonEnd:function(){h=A,p=$g.merge(p);var b=i([a,d]),c=z&&b,e=p.length;(c||e)&&(h.polygonStart(),c&&(h.lineStart(),j(null,null,1,h),h.lineEnd()),e&&Dc(p,f,b,j,h),h.polygonEnd()),p=q=r=null}};return D}}function Rc(a,b){function c(c,d){return c=a(c,d),b(c[0],c[1])}return a.invert&&b.invert&&(c.invert=function(c,d){return c=b.invert(c,d),c&&a.invert(c[0],c[1])}),c}function Sc(a){var b=0,c=Dh/3,d=gd(a),e=d(b,c);return e.parallels=function(a){return arguments.length?d(b=a[0]*Dh/180,c=a[1]*Dh/180):[b/Dh*180,c/Dh*180]},e}function Tc(a,b){function c(a,b){var c=Math.sqrt(f-2*e*Math.sin(b))/e;return[c*Math.sin(a*=e),g-c*Math.cos(a)]}var d=Math.sin(a),e=(d+Math.sin(b))/2,f=1+d*(2*e-d),g=Math.sqrt(f)/e;return c.invert=function(a,b){var c=g-b;return[Math.atan2(a,c)/e,$((f-(a*a+c*c)*e*e)/(2*e))]},c}function Uc(){function a(a,b){Ii+=e*a-d*b,d=a,e=b}var b,c,d,e;Ni.point=function(f,g){Ni.point=a,b=d=f,c=e=g},Ni.lineEnd=function(){a(b,c)}}function Vc(a,b){Ji>a&&(Ji=a),a>Li&&(Li=a),Ki>b&&(Ki=b),b>Mi&&(Mi=b)}function Wc(){function a(a,b){g.push("M",a,",",b,f)}function b(a,b){g.push("M",a,",",b),h.point=c}function c(a,b){g.push("L",a,",",b)}function d(){h.point=a}function e(){g.push("Z")}var f=Xc(4.5),g=[],h={point:a,lineStart:function(){h.point=b},lineEnd:d,polygonStart:function(){h.lineEnd=e},polygonEnd:function(){h.lineEnd=d,h.point=a},pointRadius:function(a){return f=Xc(a),h},result:function(){if(g.length){var a=g.join("");return g=[],a}}};return h}function Xc(a){return"m0,"+a+"a"+a+","+a+" 0 1,1 0,"+-2*a+"a"+a+","+a+" 0 1,1 0,"+2*a+"z"}function Yc(a,b){vi+=a,wi+=b,++xi}function Zc(){function a(a,d){var e=a-b,f=d-c,g=Math.sqrt(e*e+f*f);yi+=g*(b+a)/2,zi+=g*(c+d)/2,Ai+=g,Yc(b=a,c=d)}var b,c;Pi.point=function(d,e){Pi.point=a,Yc(b=d,c=e)}}function $c(){Pi.point=Yc}function _c(){function a(a,b){var c=a-d,f=b-e,g=Math.sqrt(c*c+f*f);yi+=g*(d+a)/2,zi+=g*(e+b)/2,Ai+=g,g=e*a-d*b,Bi+=g*(d+a),Ci+=g*(e+b),Di+=3*g,Yc(d=a,e=b)}var b,c,d,e;Pi.point=function(f,g){Pi.point=a,Yc(b=d=f,c=e=g)},Pi.lineEnd=function(){a(b,c)}}function ad(a){function b(b,c){a.moveTo(b,c),a.arc(b,c,g,0,Eh)}function c(b,c){a.moveTo(b,c),h.point=d}function d(b,c){a.lineTo(b,c)}function e(){h.point=b}function f(){a.closePath()}var g=4.5,h={point:b,lineStart:function(){h.point=c},lineEnd:e,polygonStart:function(){h.lineEnd=f},polygonEnd:function(){h.lineEnd=e,h.point=b},pointRadius:function(a){return g=a,h},result:q};return h}function bd(a){function b(a){return(h?d:c)(a)}function c(b){return ed(b,function(c,d){c=a(c,d),b.point(c[0],c[1])})}function d(b){function c(c,d){c=a(c,d),b.point(c[0],c[1])}function d(){t=0/0,y.point=f,b.lineStart()}function f(c,d){var f=pc([c,d]),g=a(c,d);e(t,u,s,v,w,x,t=g[0],u=g[1],s=c,v=f[0],w=f[1],x=f[2],h,b),b.point(t,u)}function g(){y.point=c,b.lineEnd()}function i(){d(),y.point=j,y.lineEnd=k}function j(a,b){f(l=a,m=b),n=t,o=u,p=v,q=w,r=x,y.point=f}function k(){e(t,u,s,v,w,x,n,o,l,p,q,r,h,b),y.lineEnd=g,g()}var l,m,n,o,p,q,r,s,t,u,v,w,x,y={point:c,lineStart:d,lineEnd:g,polygonStart:function(){b.polygonStart(),y.lineStart=i},polygonEnd:function(){b.polygonEnd(),y.lineStart=d}};return y}function e(b,c,d,h,i,j,k,l,m,n,o,p,q,r){var s=k-b,t=l-c,u=s*s+t*t;if(u>4*f&&q--){var v=h+n,w=i+o,x=j+p,y=Math.sqrt(v*v+w*w+x*x),z=Math.asin(x/=y),A=mh(mh(x)-1)<Gh||mh(d-m)<Gh?(d+m)/2:Math.atan2(w,v),B=a(A,z),C=B[0],D=B[1],E=C-b,F=D-c,G=t*E-s*F;(G*G/u>f||mh((s*E+t*F)/u-.5)>.3||g>h*n+i*o+j*p)&&(e(b,c,d,h,i,j,C,D,A,v/=y,w/=y,x,q,r),r.point(C,D),e(C,D,A,v,w,x,k,l,m,n,o,p,q,r))}}var f=.5,g=Math.cos(30*Ih),h=16;return b.precision=function(a){return arguments.length?(h=(f=a*a)>0&&16,b):Math.sqrt(f)},b}function cd(a){var b=bd(function(b,c){return a([b*Jh,c*Jh])});return function(a){return hd(b(a))}}function dd(a){this.stream=a}function ed(a,b){return{point:b,sphere:function(){a.sphere()},lineStart:function(){a.lineStart()},lineEnd:function(){a.lineEnd()},polygonStart:function(){a.polygonStart()},polygonEnd:function(){a.polygonEnd()}}}function fd(a){return gd(function(){return a})()}function gd(a){function b(a){return a=h(a[0]*Ih,a[1]*Ih),[a[0]*m+i,j-a[1]*m]}function c(a){return a=h.invert((a[0]-i)/m,(j-a[1])/m),a&&[a[0]*Jh,a[1]*Jh]}function d(){h=Rc(g=kd(r,s,t),f);var a=f(p,q);return i=n-a[0]*m,j=o+a[1]*m,e()}function e(){return k&&(k.valid=!1,k=null),b}var f,g,h,i,j,k,l=bd(function(a,b){return a=f(a,b),[a[0]*m+i,j-a[1]*m]}),m=150,n=480,o=250,p=0,q=0,r=0,s=0,t=0,u=Fi,v=Cb,w=null,x=null;return b.stream=function(a){return k&&(k.valid=!1),k=hd(u(g,l(v(a)))),k.valid=!0,k},b.clipAngle=function(a){return arguments.length?(u=null==a?(w=a,Fi):Oc((w=+a)*Ih),e()):w},b.clipExtent=function(a){return arguments.length?(x=a,v=a?Qc(a[0][0],a[0][1],a[1][0],a[1][1]):Cb,e()):x},b.scale=function(a){return arguments.length?(m=+a,d()):m},b.translate=function(a){return arguments.length?(n=+a[0],o=+a[1],d()):[n,o]},b.center=function(a){return arguments.length?(p=a[0]%360*Ih,q=a[1]%360*Ih,d()):[p*Jh,q*Jh]},b.rotate=function(a){return arguments.length?(r=a[0]%360*Ih,s=a[1]%360*Ih,t=a.length>2?a[2]%360*Ih:0,d()):[r*Jh,s*Jh,t*Jh]},$g.rebind(b,l,"precision"),function(){return f=a.apply(this,arguments),b.invert=f.invert&&c,d()}}function hd(a){return ed(a,function(b,c){a.point(b*Ih,c*Ih)})}function id(a,b){return[a,b]}function jd(a,b){return[a>Dh?a-Eh:-Dh>a?a+Eh:a,b]}function kd(a,b,c){return a?b||c?Rc(md(a),nd(b,c)):md(a):b||c?nd(b,c):jd}function ld(a){return function(b,c){return b+=a,[b>Dh?b-Eh:-Dh>b?b+Eh:b,c]}}function md(a){var b=ld(a);return b.invert=ld(-a),b}function nd(a,b){function c(a,b){var c=Math.cos(b),h=Math.cos(a)*c,i=Math.sin(a)*c,j=Math.sin(b),k=j*d+h*e;return[Math.atan2(i*f-k*g,h*d-j*e),$(k*f+i*g)]}var d=Math.cos(a),e=Math.sin(a),f=Math.cos(b),g=Math.sin(b);return c.invert=function(a,b){var c=Math.cos(b),h=Math.cos(a)*c,i=Math.sin(a)*c,j=Math.sin(b),k=j*f-i*g;return[Math.atan2(i*f+j*g,h*d+k*e),$(k*d-h*e)]},c}function od(a,b){var c=Math.cos(a),d=Math.sin(a);return function(e,f,g,h){var i=g*b;null!=e?(e=pd(c,e),f=pd(c,f),(g>0?f>e:e>f)&&(e+=g*Eh)):(e=a+g*Eh,f=a-.5*i);for(var j,k=e;g>0?k>f:f>k;k-=i)h.point((j=vc([c,-d*Math.cos(k),-d*Math.sin(k)]))[0],j[1])}}function pd(a,b){var c=pc(b);c[0]-=a,uc(c);var d=Z(-c[1]);return((-c[2]<0?-d:d)+2*Math.PI-Gh)%(2*Math.PI)}function qd(a,b,c){var d=$g.range(a,b-Gh,c).concat(b);return function(a){return d.map(function(b){return[a,b]})}}function rd(a,b,c){var d=$g.range(a,b-Gh,c).concat(b);return function(a){return d.map(function(b){return[b,a]})}}function sd(a){return a.source}function td(a){return a.target}function ud(a,b,c,d){var e=Math.cos(b),f=Math.sin(b),g=Math.cos(d),h=Math.sin(d),i=e*Math.cos(a),j=e*Math.sin(a),k=g*Math.cos(c),l=g*Math.sin(c),m=2*Math.asin(Math.sqrt(cb(d-b)+e*g*cb(c-a))),n=1/Math.sin(m),o=m?function(a){var b=Math.sin(a*=m)*n,c=Math.sin(m-a)*n,d=c*i+b*k,e=c*j+b*l,g=c*f+b*h;return[Math.atan2(e,d)*Jh,Math.atan2(g,Math.sqrt(d*d+e*e))*Jh]}:function(){return[a*Jh,b*Jh]};return o.distance=m,o}function vd(){function a(a,e){var f=Math.sin(e*=Ih),g=Math.cos(e),h=mh((a*=Ih)-b),i=Math.cos(h);Qi+=Math.atan2(Math.sqrt((h=g*Math.sin(h))*h+(h=d*f-c*g*i)*h),c*f+d*g*i),b=a,c=f,d=g}var b,c,d;Ri.point=function(e,f){b=e*Ih,c=Math.sin(f*=Ih),d=Math.cos(f),Ri.point=a},Ri.lineEnd=function(){Ri.point=Ri.lineEnd=q}}function wd(a,b){function c(b,c){var d=Math.cos(b),e=Math.cos(c),f=a(d*e);return[f*e*Math.sin(b),f*Math.sin(c)]}return c.invert=function(a,c){var d=Math.sqrt(a*a+c*c),e=b(d),f=Math.sin(e),g=Math.cos(e);return[Math.atan2(a*f,d*g),Math.asin(d&&c*f/d)]},c}function xd(a,b){function c(a,b){g>0?-Fh+Gh>b&&(b=-Fh+Gh):b>Fh-Gh&&(b=Fh-Gh);var c=g/Math.pow(e(b),f);return[c*Math.sin(f*a),g-c*Math.cos(f*a)]}var d=Math.cos(a),e=function(a){return Math.tan(Dh/4+a/2)},f=a===b?Math.sin(a):Math.log(d/Math.cos(b))/Math.log(e(b)/e(a)),g=d*Math.pow(e(a),f)/f;return f?(c.invert=function(a,b){var c=g-b,d=X(f)*Math.sqrt(a*a+c*c);return[Math.atan2(a,c)/f,2*Math.atan(Math.pow(g/d,1/f))-Fh]},c):zd}function yd(a,b){function c(a,b){var c=f-b;return[c*Math.sin(e*a),f-c*Math.cos(e*a)]}var d=Math.cos(a),e=a===b?Math.sin(a):(d-Math.cos(b))/(b-a),f=d/e+a;return mh(e)<Gh?id:(c.invert=function(a,b){var c=f-b;return[Math.atan2(a,c)/e,f-X(e)*Math.sqrt(a*a+c*c)]},c)}function zd(a,b){return[a,Math.log(Math.tan(Dh/4+b/2))]}function Ad(a){var b,c=fd(a),d=c.scale,e=c.translate,f=c.clipExtent;return c.scale=function(){var a=d.apply(c,arguments);return a===c?b?c.clipExtent(null):c:a},c.translate=function(){var a=e.apply(c,arguments);return a===c?b?c.clipExtent(null):c:a},c.clipExtent=function(a){var g=f.apply(c,arguments);if(g===c){if(b=null==a){var h=Dh*d(),i=e();f([[i[0]-h,i[1]-h],[i[0]+h,i[1]+h]])}}else b&&(g=null);return g},c.clipExtent(null)}function Bd(a,b){return[Math.log(Math.tan(Dh/4+b/2)),-a]}function Cd(a){return a[0]}function Dd(a){return a[1]}function Ed(a){for(var b=a.length,c=[0,1],d=2,e=2;b>e;e++){for(;d>1&&Y(a[c[d-2]],a[c[d-1]],a[e])<=0;)--d;c[d++]=e}return c.slice(0,d)}function Fd(a,b){return a[0]-b[0]||a[1]-b[1]}function Gd(a,b,c){return(c[0]-b[0])*(a[1]-b[1])<(c[1]-b[1])*(a[0]-b[0])}function Hd(a,b,c,d){var e=a[0],f=c[0],g=b[0]-e,h=d[0]-f,i=a[1],j=c[1],k=b[1]-i,l=d[1]-j,m=(h*(i-j)-l*(e-f))/(l*g-h*k);return[e+m*g,i+m*k]}function Id(a){var b=a[0],c=a[a.length-1];return!(b[0]-c[0]||b[1]-c[1])}function Jd(){ce(this),this.edge=this.site=this.circle=null}function Kd(a){var b=bj.pop()||new Jd;return b.site=a,b}function Ld(a){Vd(a),$i.remove(a),bj.push(a),ce(a)}function Md(a){var b=a.circle,c=b.x,d=b.cy,e={x:c,y:d},f=a.P,g=a.N,h=[a];Ld(a);for(var i=f;i.circle&&mh(c-i.circle.x)<Gh&&mh(d-i.circle.cy)<Gh;)f=i.P,h.unshift(i),Ld(i),i=f;h.unshift(i),Vd(i);for(var j=g;j.circle&&mh(c-j.circle.x)<Gh&&mh(d-j.circle.cy)<Gh;)g=j.N,h.push(j),Ld(j),j=g;h.push(j),Vd(j);var k,l=h.length;for(k=1;l>k;++k)j=h[k],i=h[k-1],_d(j.edge,i.site,j.site,e);i=h[0],j=h[l-1],j.edge=Zd(i.site,j.site,null,e),Ud(i),Ud(j)}function Nd(a){for(var b,c,d,e,f=a.x,g=a.y,h=$i._;h;)if(d=Od(h,g)-f,d>Gh)h=h.L;else{if(e=f-Pd(h,g),!(e>Gh)){d>-Gh?(b=h.P,c=h):e>-Gh?(b=h,c=h.N):b=c=h;break}if(!h.R){b=h;break}h=h.R}var i=Kd(a);if($i.insert(b,i),b||c){if(b===c)return Vd(b),c=Kd(b.site),$i.insert(i,c),i.edge=c.edge=Zd(b.site,i.site),Ud(b),void Ud(c);if(!c)return void(i.edge=Zd(b.site,i.site));Vd(b),Vd(c);var j=b.site,k=j.x,l=j.y,m=a.x-k,n=a.y-l,o=c.site,p=o.x-k,q=o.y-l,r=2*(m*q-n*p),s=m*m+n*n,t=p*p+q*q,u={x:(q*s-n*t)/r+k,y:(m*t-p*s)/r+l};_d(c.edge,j,o,u),i.edge=Zd(j,a,null,u),c.edge=Zd(a,o,null,u),Ud(b),Ud(c)}}function Od(a,b){var c=a.site,d=c.x,e=c.y,f=e-b;if(!f)return d;var g=a.P;if(!g)return-1/0;c=g.site;var h=c.x,i=c.y,j=i-b;if(!j)return h;var k=h-d,l=1/f-1/j,m=k/j;return l?(-m+Math.sqrt(m*m-2*l*(k*k/(-2*j)-i+j/2+e-f/2)))/l+d:(d+h)/2}function Pd(a,b){var c=a.N;if(c)return Od(c,b);var d=a.site;return d.y===b?d.x:1/0}function Qd(a){this.site=a,this.edges=[]}function Rd(a){for(var b,c,d,e,f,g,h,i,j,k,l=a[0][0],m=a[1][0],n=a[0][1],o=a[1][1],p=Zi,q=p.length;q--;)if(f=p[q],f&&f.prepare())for(h=f.edges,i=h.length,g=0;i>g;)k=h[g].end(),d=k.x,e=k.y,j=h[++g%i].start(),b=j.x,c=j.y,(mh(d-b)>Gh||mh(e-c)>Gh)&&(h.splice(g,0,new ae($d(f.site,k,mh(d-l)<Gh&&o-e>Gh?{x:l,y:mh(b-l)<Gh?c:o}:mh(e-o)<Gh&&m-d>Gh?{x:mh(c-o)<Gh?b:m,y:o}:mh(d-m)<Gh&&e-n>Gh?{x:m,y:mh(b-m)<Gh?c:n}:mh(e-n)<Gh&&d-l>Gh?{x:mh(c-n)<Gh?b:l,y:n}:null),f.site,null)),++i)}function Sd(a,b){return b.angle-a.angle}function Td(){ce(this),this.x=this.y=this.arc=this.site=this.cy=null}function Ud(a){var b=a.P,c=a.N;if(b&&c){var d=b.site,e=a.site,f=c.site;if(d!==f){var g=e.x,h=e.y,i=d.x-g,j=d.y-h,k=f.x-g,l=f.y-h,m=2*(i*l-j*k);if(!(m>=-Hh)){var n=i*i+j*j,o=k*k+l*l,p=(l*n-j*o)/m,q=(i*o-k*n)/m,l=q+h,r=cj.pop()||new Td;r.arc=a,r.site=e,r.x=p+g,r.y=l+Math.sqrt(p*p+q*q),r.cy=l,a.circle=r;for(var s=null,t=aj._;t;)if(r.y<t.y||r.y===t.y&&r.x<=t.x){if(!t.L){s=t.P;break}t=t.L}else{if(!t.R){s=t;break}t=t.R}aj.insert(s,r),s||(_i=r)}}}}function Vd(a){var b=a.circle;b&&(b.P||(_i=b.N),aj.remove(b),cj.push(b),ce(b),a.circle=null)}function Wd(a){for(var b,c=Yi,d=Pc(a[0][0],a[0][1],a[1][0],a[1][1]),e=c.length;e--;)b=c[e],(!Xd(b,a)||!d(b)||mh(b.a.x-b.b.x)<Gh&&mh(b.a.y-b.b.y)<Gh)&&(b.a=b.b=null,c.splice(e,1))}function Xd(a,b){var c=a.b;if(c)return!0;var d,e,f=a.a,g=b[0][0],h=b[1][0],i=b[0][1],j=b[1][1],k=a.l,l=a.r,m=k.x,n=k.y,o=l.x,p=l.y,q=(m+o)/2,r=(n+p)/2;if(p===n){if(g>q||q>=h)return;if(m>o){if(f){if(f.y>=j)return}else f={x:q,y:i};c={x:q,y:j}}else{if(f){if(f.y<i)return}else f={x:q,y:j};c={x:q,y:i}}}else if(d=(m-o)/(p-n),e=r-d*q,-1>d||d>1)if(m>o){if(f){if(f.y>=j)return}else f={x:(i-e)/d,y:i};c={x:(j-e)/d,y:j}}else{if(f){if(f.y<i)return}else f={x:(j-e)/d,y:j};c={x:(i-e)/d,y:i}}else if(p>n){if(f){if(f.x>=h)return}else f={x:g,y:d*g+e};c={x:h,y:d*h+e}}else{if(f){if(f.x<g)return}else f={x:h,y:d*h+e};c={x:g,y:d*g+e}}return a.a=f,a.b=c,!0}function Yd(a,b){this.l=a,this.r=b,this.a=this.b=null}function Zd(a,b,c,d){var e=new Yd(a,b);return Yi.push(e),c&&_d(e,a,b,c),d&&_d(e,b,a,d),Zi[a.i].edges.push(new ae(e,a,b)),Zi[b.i].edges.push(new ae(e,b,a)),e}function $d(a,b,c){var d=new Yd(a,null);return d.a=b,d.b=c,Yi.push(d),d}function _d(a,b,c,d){a.a||a.b?a.l===c?a.b=d:a.a=d:(a.a=d,a.l=b,a.r=c)}function ae(a,b,c){var d=a.a,e=a.b;this.edge=a,this.site=b,this.angle=c?Math.atan2(c.y-b.y,c.x-b.x):a.l===b?Math.atan2(e.x-d.x,d.y-e.y):Math.atan2(d.x-e.x,e.y-d.y)}function be(){this._=null}function ce(a){a.U=a.C=a.L=a.R=a.P=a.N=null}function de(a,b){var c=b,d=b.R,e=c.U;e?e.L===c?e.L=d:e.R=d:a._=d,d.U=e,c.U=d,c.R=d.L,c.R&&(c.R.U=c),d.L=c}function ee(a,b){var c=b,d=b.L,e=c.U;e?e.L===c?e.L=d:e.R=d:a._=d,d.U=e,c.U=d,c.L=d.R,c.L&&(c.L.U=c),d.R=c}function fe(a){for(;a.L;)a=a.L;return a}function ge(a,b){var c,d,e,f=a.sort(he).pop();for(Yi=[],Zi=new Array(a.length),$i=new be,aj=new be;;)if(e=_i,f&&(!e||f.y<e.y||f.y===e.y&&f.x<e.x))(f.x!==c||f.y!==d)&&(Zi[f.i]=new Qd(f),Nd(f),c=f.x,d=f.y),f=a.pop();else{if(!e)break;Md(e.arc)}b&&(Wd(b),Rd(b));var g={cells:Zi,edges:Yi};return $i=aj=Yi=Zi=null,g}function he(a,b){return b.y-a.y||b.x-a.x}function ie(a,b,c){return(a.x-c.x)*(b.y-a.y)-(a.x-b.x)*(c.y-a.y)}function je(a){return a.x}function ke(a){return a.y}function le(){return{leaf:!0,nodes:[],point:null,x:null,y:null}}function me(a,b,c,d,e,f){if(!a(b,c,d,e,f)){var g=.5*(c+e),h=.5*(d+f),i=b.nodes;i[0]&&me(a,i[0],c,d,g,h),i[1]&&me(a,i[1],g,d,e,h),i[2]&&me(a,i[2],c,h,g,f),i[3]&&me(a,i[3],g,h,e,f)}}function ne(a,b){a=$g.rgb(a),b=$g.rgb(b);var c=a.r,d=a.g,e=a.b,f=b.r-c,g=b.g-d,h=b.b-e;return function(a){return"#"+vb(Math.round(c+f*a))+vb(Math.round(d+g*a))+vb(Math.round(e+h*a))}}function oe(a,b){var c,d={},e={};for(c in a)c in b?d[c]=re(a[c],b[c]):e[c]=a[c];for(c in b)c in a||(e[c]=b[c]);return function(a){for(c in d)e[c]=d[c](a);return e}}function pe(a,b){return b-=a=+a,function(c){return a+b*c}}function qe(a,b){var c,d,e,f,g,h=0,i=0,j=[],k=[];for(a+="",b+="",ej.lastIndex=0,d=0;c=ej.exec(b);++d)c.index&&j.push(b.substring(h,i=c.index)),k.push({i:j.length,x:c[0]}),j.push(null),h=ej.lastIndex;for(h<b.length&&j.push(b.substring(h)),d=0,f=k.length;(c=ej.exec(a))&&f>d;++d)if(g=k[d],g.x==c[0]){if(g.i)if(null==j[g.i+1])for(j[g.i-1]+=g.x,j.splice(g.i,1),e=d+1;f>e;++e)k[e].i--;else for(j[g.i-1]+=g.x+j[g.i+1],j.splice(g.i,2),e=d+1;f>e;++e)k[e].i-=2;else if(null==j[g.i+1])j[g.i]=g.x;else for(j[g.i]=g.x+j[g.i+1],j.splice(g.i+1,1),e=d+1;f>e;++e)k[e].i--;k.splice(d,1),f--,d--}else g.x=pe(parseFloat(c[0]),parseFloat(g.x));for(;f>d;)g=k.pop(),null==j[g.i+1]?j[g.i]=g.x:(j[g.i]=g.x+j[g.i+1],j.splice(g.i+1,1)),f--;return 1===j.length?null==j[0]?(g=k[0].x,function(a){return g(a)+""}):function(){return b}:function(a){for(d=0;f>d;++d)j[(g=k[d]).i]=g.x(a);return j.join("")}}function re(a,b){for(var c,d=$g.interpolators.length;--d>=0&&!(c=$g.interpolators[d](a,b)););return c}function se(a,b){var c,d=[],e=[],f=a.length,g=b.length,h=Math.min(a.length,b.length);for(c=0;h>c;++c)d.push(re(a[c],b[c]));for(;f>c;++c)e[c]=a[c];for(;g>c;++c)e[c]=b[c];return function(a){for(c=0;h>c;++c)e[c]=d[c](a);return e}}function te(a){return function(b){return 0>=b?0:b>=1?1:a(b)}}function ue(a){return function(b){return 1-a(1-b)}}function ve(a){return function(b){return.5*(.5>b?a(2*b):2-a(2-2*b))}}function we(a){return a*a}function xe(a){return a*a*a}function ye(a){if(0>=a)return 0;if(a>=1)return 1;var b=a*a,c=b*a;return 4*(.5>a?c:3*(a-b)+c-.75)}function ze(a){return function(b){return Math.pow(b,a)}}function Ae(a){return 1-Math.cos(a*Fh)}function Be(a){return Math.pow(2,10*(a-1))}function Ce(a){return 1-Math.sqrt(1-a*a)}function De(a,b){var c;return arguments.length<2&&(b=.45),arguments.length?c=b/Eh*Math.asin(1/a):(a=1,c=b/4),function(d){return 1+a*Math.pow(2,-10*d)*Math.sin((d-c)*Eh/b)}}function Ee(a){return a||(a=1.70158),function(b){return b*b*((a+1)*b-a)}}function Fe(a){return 1/2.75>a?7.5625*a*a:2/2.75>a?7.5625*(a-=1.5/2.75)*a+.75:2.5/2.75>a?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375}function Ge(a,b){a=$g.hcl(a),b=$g.hcl(b);var c=a.h,d=a.c,e=a.l,f=b.h-c,g=b.c-d,h=b.l-e;return isNaN(g)&&(g=0,d=isNaN(d)?b.c:d),isNaN(f)?(f=0,c=isNaN(c)?b.h:c):f>180?f-=360:-180>f&&(f+=360),function(a){return jb(c+f*a,d+g*a,e+h*a)+""}}function He(a,b){a=$g.hsl(a),b=$g.hsl(b);var c=a.h,d=a.s,e=a.l,f=b.h-c,g=b.s-d,h=b.l-e;return isNaN(g)&&(g=0,d=isNaN(d)?b.s:d),isNaN(f)?(f=0,c=isNaN(c)?b.h:c):f>180?f-=360:-180>f&&(f+=360),function(a){return gb(c+f*a,d+g*a,e+h*a)+""}}function Ie(a,b){a=$g.lab(a),b=$g.lab(b);var c=a.l,d=a.a,e=a.b,f=b.l-c,g=b.a-d,h=b.b-e;return function(a){return mb(c+f*a,d+g*a,e+h*a)+""}}function Je(a,b){return b-=a,function(c){return Math.round(a+b*c)}}function Ke(a){var b=[a.a,a.b],c=[a.c,a.d],d=Me(b),e=Le(b,c),f=Me(Ne(c,b,-e))||0;b[0]*c[1]<c[0]*b[1]&&(b[0]*=-1,b[1]*=-1,d*=-1,e*=-1),this.rotate=(d?Math.atan2(b[1],b[0]):Math.atan2(-c[0],c[1]))*Jh,this.translate=[a.e,a.f],this.scale=[d,f],this.skew=f?Math.atan2(e,f)*Jh:0}function Le(a,b){return a[0]*b[0]+a[1]*b[1]}function Me(a){var b=Math.sqrt(Le(a,a));return b&&(a[0]/=b,a[1]/=b),b}function Ne(a,b,c){return a[0]+=c*b[0],a[1]+=c*b[1],a}function Oe(a,b){var c,d=[],e=[],f=$g.transform(a),g=$g.transform(b),h=f.translate,i=g.translate,j=f.rotate,k=g.rotate,l=f.skew,m=g.skew,n=f.scale,o=g.scale;return h[0]!=i[0]||h[1]!=i[1]?(d.push("translate(",null,",",null,")"),e.push({i:1,x:pe(h[0],i[0])},{i:3,x:pe(h[1],i[1])})):d.push(i[0]||i[1]?"translate("+i+")":""),j!=k?(j-k>180?k+=360:k-j>180&&(j+=360),e.push({i:d.push(d.pop()+"rotate(",null,")")-2,x:pe(j,k)})):k&&d.push(d.pop()+"rotate("+k+")"),l!=m?e.push({i:d.push(d.pop()+"skewX(",null,")")-2,x:pe(l,m)}):m&&d.push(d.pop()+"skewX("+m+")"),n[0]!=o[0]||n[1]!=o[1]?(c=d.push(d.pop()+"scale(",null,",",null,")"),e.push({i:c-4,x:pe(n[0],o[0])},{i:c-2,x:pe(n[1],o[1])})):(1!=o[0]||1!=o[1])&&d.push(d.pop()+"scale("+o+")"),c=e.length,function(a){for(var b,f=-1;++f<c;)d[(b=e[f]).i]=b.x(a);return d.join("")}}function Pe(a,b){return b=b-(a=+a)?1/(b-a):0,function(c){return(c-a)*b}}function Qe(a,b){return b=b-(a=+a)?1/(b-a):0,function(c){return Math.max(0,Math.min(1,(c-a)*b))}}function Re(a){for(var b=a.source,c=a.target,d=Te(b,c),e=[b];b!==d;)b=b.parent,e.push(b);for(var f=e.length;c!==d;)e.splice(f,0,c),c=c.parent;return e}function Se(a){for(var b=[],c=a.parent;null!=c;)b.push(a),a=c,c=c.parent;return b.push(a),b}function Te(a,b){if(a===b)return a;for(var c=Se(a),d=Se(b),e=c.pop(),f=d.pop(),g=null;e===f;)g=e,e=c.pop(),f=d.pop();return g}function Ue(a){a.fixed|=2}function Ve(a){a.fixed&=-7}function We(a){a.fixed|=4,a.px=a.x,a.py=a.y}function Xe(a){a.fixed&=-5}function Ye(a,b,c){var d=0,e=0;if(a.charge=0,!a.leaf)for(var f,g=a.nodes,h=g.length,i=-1;++i<h;)f=g[i],null!=f&&(Ye(f,b,c),a.charge+=f.charge,d+=f.charge*f.cx,e+=f.charge*f.cy);if(a.point){a.leaf||(a.point.x+=Math.random()-.5,a.point.y+=Math.random()-.5);var j=b*c[a.point.index];a.charge+=a.pointCharge=j,d+=j*a.point.x,e+=j*a.point.y}a.cx=d/a.charge,a.cy=e/a.charge}function Ze(a,b){return $g.rebind(a,b,"sort","children","value"),a.nodes=a,a.links=bf,a}function $e(a){return a.children}function _e(a){return a.value}function af(a,b){return b.value-a.value}function bf(a){return $g.merge(a.map(function(a){return(a.children||[]).map(function(b){return{source:a,target:b}})}))}function cf(a){return a.x}function df(a){return a.y}function ef(a,b,c){a.y0=b,a.y=c}function ff(a){return $g.range(a.length)}function gf(a){for(var b=-1,c=a[0].length,d=[];++b<c;)d[b]=0;return d}function hf(a){for(var b,c=1,d=0,e=a[0][1],f=a.length;f>c;++c)(b=a[c][1])>e&&(d=c,e=b);return d}function jf(a){return a.reduce(kf,0)}function kf(a,b){return a+b[1]}function lf(a,b){return mf(a,Math.ceil(Math.log(b.length)/Math.LN2+1))}function mf(a,b){for(var c=-1,d=+a[0],e=(a[1]-d)/b,f=[];++c<=b;)f[c]=e*c+d;return f}function nf(a){return[$g.min(a),$g.max(a)]}function of(a,b){return a.parent==b.parent?1:2}function pf(a){var b=a.children;return b&&b.length?b[0]:a._tree.thread}function qf(a){var b,c=a.children;return c&&(b=c.length)?c[b-1]:a._tree.thread}function rf(a,b){var c=a.children;if(c&&(e=c.length))for(var d,e,f=-1;++f<e;)b(d=rf(c[f],b),a)>0&&(a=d);return a}function sf(a,b){return a.x-b.x}function tf(a,b){return b.x-a.x}function uf(a,b){return a.depth-b.depth}function vf(a,b){function c(a,d){var e=a.children;if(e&&(g=e.length))for(var f,g,h=null,i=-1;++i<g;)f=e[i],c(f,h),h=f;b(a,d)}c(a,null)}function wf(a){for(var b,c=0,d=0,e=a.children,f=e.length;--f>=0;)b=e[f]._tree,b.prelim+=c,b.mod+=c,c+=b.shift+(d+=b.change)}function xf(a,b,c){a=a._tree,b=b._tree;var d=c/(b.number-a.number);a.change+=d,b.change-=d,b.shift+=c,b.prelim+=c,b.mod+=c}function yf(a,b,c){return a._tree.ancestor.parent==b.parent?a._tree.ancestor:c}function zf(a,b){return a.value-b.value}function Af(a,b){var c=a._pack_next;a._pack_next=b,b._pack_prev=a,b._pack_next=c,c._pack_prev=b}function Bf(a,b){a._pack_next=b,b._pack_prev=a}function Cf(a,b){var c=b.x-a.x,d=b.y-a.y,e=a.r+b.r;return.999*e*e>c*c+d*d}function Df(a){function b(a){k=Math.min(a.x-a.r,k),l=Math.max(a.x+a.r,l),m=Math.min(a.y-a.r,m),n=Math.max(a.y+a.r,n)}if((c=a.children)&&(j=c.length)){var c,d,e,f,g,h,i,j,k=1/0,l=-1/0,m=1/0,n=-1/0;if(c.forEach(Ef),d=c[0],d.x=-d.r,d.y=0,b(d),j>1&&(e=c[1],e.x=e.r,e.y=0,b(e),j>2))for(f=c[2],Hf(d,e,f),b(f),Af(d,f),d._pack_prev=f,Af(f,e),e=d._pack_next,g=3;j>g;g++){Hf(d,e,f=c[g]);var o=0,p=1,q=1;for(h=e._pack_next;h!==e;h=h._pack_next,p++)if(Cf(h,f)){o=1;break}if(1==o)for(i=d._pack_prev;i!==h._pack_prev&&!Cf(i,f);i=i._pack_prev,q++);o?(q>p||p==q&&e.r<d.r?Bf(d,e=h):Bf(d=i,e),g--):(Af(d,f),e=f,b(f))}var r=(k+l)/2,s=(m+n)/2,t=0;for(g=0;j>g;g++)f=c[g],f.x-=r,f.y-=s,t=Math.max(t,f.r+Math.sqrt(f.x*f.x+f.y*f.y));a.r=t,c.forEach(Ff)}}function Ef(a){a._pack_next=a._pack_prev=a}function Ff(a){delete a._pack_next,delete a._pack_prev}function Gf(a,b,c,d){var e=a.children;if(a.x=b+=d*a.x,a.y=c+=d*a.y,a.r*=d,e)for(var f=-1,g=e.length;++f<g;)Gf(e[f],b,c,d)}function Hf(a,b,c){var d=a.r+c.r,e=b.x-a.x,f=b.y-a.y;if(d&&(e||f)){var g=b.r+c.r,h=e*e+f*f;g*=g,d*=d;var i=.5+(d-g)/(2*h),j=Math.sqrt(Math.max(0,2*g*(d+h)-(d-=h)*d-g*g))/(2*h);c.x=a.x+i*e+j*f,c.y=a.y+i*f-j*e}else c.x=a.x+d,c.y=a.y}function If(a){return 1+$g.max(a,function(a){return a.y})}function Jf(a){return a.reduce(function(a,b){return a+b.x},0)/a.length}function Kf(a){var b=a.children;return b&&b.length?Kf(b[0]):a}function Lf(a){var b,c=a.children;return c&&(b=c.length)?Lf(c[b-1]):a}function Mf(a){return{x:a.x,y:a.y,dx:a.dx,dy:a.dy}}function Nf(a,b){var c=a.x+b[3],d=a.y+b[0],e=a.dx-b[1]-b[3],f=a.dy-b[0]-b[2];return 0>e&&(c+=e/2,e=0),0>f&&(d+=f/2,f=0),{x:c,y:d,dx:e,dy:f}}function Of(a){var b=a[0],c=a[a.length-1];return c>b?[b,c]:[c,b]}function Pf(a){return a.rangeExtent?a.rangeExtent():Of(a.range())}function Qf(a,b,c,d){var e=c(a[0],a[1]),f=d(b[0],b[1]);return function(a){return f(e(a))}}function Rf(a,b){var c,d=0,e=a.length-1,f=a[d],g=a[e];return f>g&&(c=d,d=e,e=c,c=f,f=g,g=c),a[d]=b.floor(f),a[e]=b.ceil(g),a}function Sf(a){return a?{floor:function(b){return Math.floor(b/a)*a},ceil:function(b){return Math.ceil(b/a)*a}}:pj}function Tf(a,b,c,d){var e=[],f=[],g=0,h=Math.min(a.length,b.length)-1;for(a[h]<a[0]&&(a=a.slice().reverse(),b=b.slice().reverse());++g<=h;)e.push(c(a[g-1],a[g])),f.push(d(b[g-1],b[g]));return function(b){var c=$g.bisect(a,b,1,h)-1;return f[c](e[c](b))}}function Uf(a,b,c,d){function e(){var e=Math.min(a.length,b.length)>2?Tf:Qf,i=d?Qe:Pe;return g=e(a,b,i,c),h=e(b,a,i,re),f}function f(a){return g(a)}var g,h;return f.invert=function(a){return h(a)},f.domain=function(b){return arguments.length?(a=b.map(Number),e()):a},f.range=function(a){return arguments.length?(b=a,e()):b},f.rangeRound=function(a){return f.range(a).interpolate(Je)},f.clamp=function(a){return arguments.length?(d=a,e()):d},f.interpolate=function(a){return arguments.length?(c=a,e()):c},f.ticks=function(b){return Yf(a,b)},f.tickFormat=function(b,c){return Zf(a,b,c)},f.nice=function(b){return Wf(a,b),e()},f.copy=function(){return Uf(a,b,c,d)},e()}function Vf(a,b){return $g.rebind(a,b,"range","rangeRound","interpolate","clamp")
}function Wf(a,b){return Rf(a,Sf(Xf(a,b)[2]))}function Xf(a,b){null==b&&(b=10);var c=Of(a),d=c[1]-c[0],e=Math.pow(10,Math.floor(Math.log(d/b)/Math.LN10)),f=b/d*e;return.15>=f?e*=10:.35>=f?e*=5:.75>=f&&(e*=2),c[0]=Math.ceil(c[0]/e)*e,c[1]=Math.floor(c[1]/e)*e+.5*e,c[2]=e,c}function Yf(a,b){return $g.range.apply($g,Xf(a,b))}function Zf(a,b,c){var d=Xf(a,b);if(c){var e=ei.exec(c);if(e.shift(),"s"===e[8]){var f=$g.formatPrefix(Math.max(mh(d[0]),mh(d[1])));return e[7]||(e[7]="."+$f(f.scale(d[2]))),e[8]="f",c=$g.format(e.join("")),function(a){return c(f.scale(a))+f.symbol}}e[7]||(e[7]="."+_f(e[8],d)),c=e.join("")}else c=",."+$f(d[2])+"f";return $g.format(c)}function $f(a){return-Math.floor(Math.log(a)/Math.LN10+.01)}function _f(a,b){var c=$f(b[2]);return a in qj?Math.abs(c-$f(Math.max(mh(b[0]),mh(b[1]))))+ +("e"!==a):c-2*("%"===a)}function ag(a,b,c,d){function e(a){return(c?Math.log(0>a?0:a):-Math.log(a>0?0:-a))/Math.log(b)}function f(a){return c?Math.pow(b,a):-Math.pow(b,-a)}function g(b){return a(e(b))}return g.invert=function(b){return f(a.invert(b))},g.domain=function(b){return arguments.length?(c=b[0]>=0,a.domain((d=b.map(Number)).map(e)),g):d},g.base=function(c){return arguments.length?(b=+c,a.domain(d.map(e)),g):b},g.nice=function(){var b=Rf(d.map(e),c?Math:sj);return a.domain(b),d=b.map(f),g},g.ticks=function(){var a=Of(d),g=[],h=a[0],i=a[1],j=Math.floor(e(h)),k=Math.ceil(e(i)),l=b%1?2:b;if(isFinite(k-j)){if(c){for(;k>j;j++)for(var m=1;l>m;m++)g.push(f(j)*m);g.push(f(j))}else for(g.push(f(j));j++<k;)for(var m=l-1;m>0;m--)g.push(f(j)*m);for(j=0;g[j]<h;j++);for(k=g.length;g[k-1]>i;k--);g=g.slice(j,k)}return g},g.tickFormat=function(a,b){if(!arguments.length)return rj;arguments.length<2?b=rj:"function"!=typeof b&&(b=$g.format(b));var d,h=Math.max(.1,a/g.ticks().length),i=c?(d=1e-12,Math.ceil):(d=-1e-12,Math.floor);return function(a){return a/f(i(e(a)+d))<=h?b(a):""}},g.copy=function(){return ag(a.copy(),b,c,d)},Vf(g,a)}function bg(a,b,c){function d(b){return a(e(b))}var e=cg(b),f=cg(1/b);return d.invert=function(b){return f(a.invert(b))},d.domain=function(b){return arguments.length?(a.domain((c=b.map(Number)).map(e)),d):c},d.ticks=function(a){return Yf(c,a)},d.tickFormat=function(a,b){return Zf(c,a,b)},d.nice=function(a){return d.domain(Wf(c,a))},d.exponent=function(g){return arguments.length?(e=cg(b=g),f=cg(1/b),a.domain(c.map(e)),d):b},d.copy=function(){return bg(a.copy(),b,c)},Vf(d,a)}function cg(a){return function(b){return 0>b?-Math.pow(-b,a):Math.pow(b,a)}}function dg(a,b){function c(c){return f[((e.get(c)||("range"===b.t?e.set(c,a.push(c)):0/0))-1)%f.length]}function d(b,c){return $g.range(a.length).map(function(a){return b+c*a})}var e,f,g;return c.domain=function(d){if(!arguments.length)return a;a=[],e=new h;for(var f,g=-1,i=d.length;++g<i;)e.has(f=d[g])||e.set(f,a.push(f));return c[b.t].apply(c,b.a)},c.range=function(a){return arguments.length?(f=a,g=0,b={t:"range",a:arguments},c):f},c.rangePoints=function(e,h){arguments.length<2&&(h=0);var i=e[0],j=e[1],k=(j-i)/(Math.max(1,a.length-1)+h);return f=d(a.length<2?(i+j)/2:i+k*h/2,k),g=0,b={t:"rangePoints",a:arguments},c},c.rangeBands=function(e,h,i){arguments.length<2&&(h=0),arguments.length<3&&(i=h);var j=e[1]<e[0],k=e[j-0],l=e[1-j],m=(l-k)/(a.length-h+2*i);return f=d(k+m*i,m),j&&f.reverse(),g=m*(1-h),b={t:"rangeBands",a:arguments},c},c.rangeRoundBands=function(e,h,i){arguments.length<2&&(h=0),arguments.length<3&&(i=h);var j=e[1]<e[0],k=e[j-0],l=e[1-j],m=Math.floor((l-k)/(a.length-h+2*i)),n=l-k-(a.length-h)*m;return f=d(k+Math.round(n/2),m),j&&f.reverse(),g=Math.round(m*(1-h)),b={t:"rangeRoundBands",a:arguments},c},c.rangeBand=function(){return g},c.rangeExtent=function(){return Of(b.a[0])},c.copy=function(){return dg(a,b)},c.domain(a)}function eg(b,c){function d(){var a=0,d=c.length;for(f=[];++a<d;)f[a-1]=$g.quantile(b,a/d);return e}function e(a){return isNaN(a=+a)?void 0:c[$g.bisect(f,a)]}var f;return e.domain=function(c){return arguments.length?(b=c.filter(function(a){return!isNaN(a)}).sort(a),d()):b},e.range=function(a){return arguments.length?(c=a,d()):c},e.quantiles=function(){return f},e.invertExtent=function(a){return a=c.indexOf(a),0>a?[0/0,0/0]:[a>0?f[a-1]:b[0],a<f.length?f[a]:b[b.length-1]]},e.copy=function(){return eg(b,c)},d()}function fg(a,b,c){function d(b){return c[Math.max(0,Math.min(g,Math.floor(f*(b-a))))]}function e(){return f=c.length/(b-a),g=c.length-1,d}var f,g;return d.domain=function(c){return arguments.length?(a=+c[0],b=+c[c.length-1],e()):[a,b]},d.range=function(a){return arguments.length?(c=a,e()):c},d.invertExtent=function(b){return b=c.indexOf(b),b=0>b?0/0:b/f+a,[b,b+1/f]},d.copy=function(){return fg(a,b,c)},e()}function gg(a,b){function c(c){return c>=c?b[$g.bisect(a,c)]:void 0}return c.domain=function(b){return arguments.length?(a=b,c):a},c.range=function(a){return arguments.length?(b=a,c):b},c.invertExtent=function(c){return c=b.indexOf(c),[a[c-1],a[c]]},c.copy=function(){return gg(a,b)},c}function hg(a){function b(a){return+a}return b.invert=b,b.domain=b.range=function(c){return arguments.length?(a=c.map(b),b):a},b.ticks=function(b){return Yf(a,b)},b.tickFormat=function(b,c){return Zf(a,b,c)},b.copy=function(){return hg(a)},b}function ig(a){return a.innerRadius}function jg(a){return a.outerRadius}function kg(a){return a.startAngle}function lg(a){return a.endAngle}function mg(a){function b(b){function g(){j.push("M",f(a(k),h))}for(var i,j=[],k=[],l=-1,m=b.length,n=Bb(c),o=Bb(d);++l<m;)e.call(this,i=b[l],l)?k.push([+n.call(this,i,l),+o.call(this,i,l)]):k.length&&(g(),k=[]);return k.length&&g(),j.length?j.join(""):null}var c=Cd,d=Dd,e=Cc,f=ng,g=f.key,h=.7;return b.x=function(a){return arguments.length?(c=a,b):c},b.y=function(a){return arguments.length?(d=a,b):d},b.defined=function(a){return arguments.length?(e=a,b):e},b.interpolate=function(a){return arguments.length?(g="function"==typeof a?f=a:(f=zj.get(a)||ng).key,b):g},b.tension=function(a){return arguments.length?(h=a,b):h},b}function ng(a){return a.join("L")}function og(a){return ng(a)+"Z"}function pg(a){for(var b=0,c=a.length,d=a[0],e=[d[0],",",d[1]];++b<c;)e.push("H",(d[0]+(d=a[b])[0])/2,"V",d[1]);return c>1&&e.push("H",d[0]),e.join("")}function qg(a){for(var b=0,c=a.length,d=a[0],e=[d[0],",",d[1]];++b<c;)e.push("V",(d=a[b])[1],"H",d[0]);return e.join("")}function rg(a){for(var b=0,c=a.length,d=a[0],e=[d[0],",",d[1]];++b<c;)e.push("H",(d=a[b])[0],"V",d[1]);return e.join("")}function sg(a,b){return a.length<4?ng(a):a[1]+vg(a.slice(1,a.length-1),wg(a,b))}function tg(a,b){return a.length<3?ng(a):a[0]+vg((a.push(a[0]),a),wg([a[a.length-2]].concat(a,[a[1]]),b))}function ug(a,b){return a.length<3?ng(a):a[0]+vg(a,wg(a,b))}function vg(a,b){if(b.length<1||a.length!=b.length&&a.length!=b.length+2)return ng(a);var c=a.length!=b.length,d="",e=a[0],f=a[1],g=b[0],h=g,i=1;if(c&&(d+="Q"+(f[0]-2*g[0]/3)+","+(f[1]-2*g[1]/3)+","+f[0]+","+f[1],e=a[1],i=2),b.length>1){h=b[1],f=a[i],i++,d+="C"+(e[0]+g[0])+","+(e[1]+g[1])+","+(f[0]-h[0])+","+(f[1]-h[1])+","+f[0]+","+f[1];for(var j=2;j<b.length;j++,i++)f=a[i],h=b[j],d+="S"+(f[0]-h[0])+","+(f[1]-h[1])+","+f[0]+","+f[1]}if(c){var k=a[i];d+="Q"+(f[0]+2*h[0]/3)+","+(f[1]+2*h[1]/3)+","+k[0]+","+k[1]}return d}function wg(a,b){for(var c,d=[],e=(1-b)/2,f=a[0],g=a[1],h=1,i=a.length;++h<i;)c=f,f=g,g=a[h],d.push([e*(g[0]-c[0]),e*(g[1]-c[1])]);return d}function xg(a){if(a.length<3)return ng(a);var b=1,c=a.length,d=a[0],e=d[0],f=d[1],g=[e,e,e,(d=a[1])[0]],h=[f,f,f,d[1]],i=[e,",",f,"L",Bg(Cj,g),",",Bg(Cj,h)];for(a.push(a[c-1]);++b<=c;)d=a[b],g.shift(),g.push(d[0]),h.shift(),h.push(d[1]),Cg(i,g,h);return a.pop(),i.push("L",d),i.join("")}function yg(a){if(a.length<4)return ng(a);for(var b,c=[],d=-1,e=a.length,f=[0],g=[0];++d<3;)b=a[d],f.push(b[0]),g.push(b[1]);for(c.push(Bg(Cj,f)+","+Bg(Cj,g)),--d;++d<e;)b=a[d],f.shift(),f.push(b[0]),g.shift(),g.push(b[1]),Cg(c,f,g);return c.join("")}function zg(a){for(var b,c,d=-1,e=a.length,f=e+4,g=[],h=[];++d<4;)c=a[d%e],g.push(c[0]),h.push(c[1]);for(b=[Bg(Cj,g),",",Bg(Cj,h)],--d;++d<f;)c=a[d%e],g.shift(),g.push(c[0]),h.shift(),h.push(c[1]),Cg(b,g,h);return b.join("")}function Ag(a,b){var c=a.length-1;if(c)for(var d,e,f=a[0][0],g=a[0][1],h=a[c][0]-f,i=a[c][1]-g,j=-1;++j<=c;)d=a[j],e=j/c,d[0]=b*d[0]+(1-b)*(f+e*h),d[1]=b*d[1]+(1-b)*(g+e*i);return xg(a)}function Bg(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]}function Cg(a,b,c){a.push("C",Bg(Aj,b),",",Bg(Aj,c),",",Bg(Bj,b),",",Bg(Bj,c),",",Bg(Cj,b),",",Bg(Cj,c))}function Dg(a,b){return(b[1]-a[1])/(b[0]-a[0])}function Eg(a){for(var b=0,c=a.length-1,d=[],e=a[0],f=a[1],g=d[0]=Dg(e,f);++b<c;)d[b]=(g+(g=Dg(e=f,f=a[b+1])))/2;return d[b]=g,d}function Fg(a){for(var b,c,d,e,f=[],g=Eg(a),h=-1,i=a.length-1;++h<i;)b=Dg(a[h],a[h+1]),mh(b)<Gh?g[h]=g[h+1]=0:(c=g[h]/b,d=g[h+1]/b,e=c*c+d*d,e>9&&(e=3*b/Math.sqrt(e),g[h]=e*c,g[h+1]=e*d));for(h=-1;++h<=i;)e=(a[Math.min(i,h+1)][0]-a[Math.max(0,h-1)][0])/(6*(1+g[h]*g[h])),f.push([e||0,g[h]*e||0]);return f}function Gg(a){return a.length<3?ng(a):a[0]+vg(a,Fg(a))}function Hg(a){for(var b,c,d,e=-1,f=a.length;++e<f;)b=a[e],c=b[0],d=b[1]+xj,b[0]=c*Math.cos(d),b[1]=c*Math.sin(d);return a}function Ig(a){function b(b){function i(){p.push("M",h(a(r),l),k,j(a(q.reverse()),l),"Z")}for(var m,n,o,p=[],q=[],r=[],s=-1,t=b.length,u=Bb(c),v=Bb(e),w=c===d?function(){return n}:Bb(d),x=e===f?function(){return o}:Bb(f);++s<t;)g.call(this,m=b[s],s)?(q.push([n=+u.call(this,m,s),o=+v.call(this,m,s)]),r.push([+w.call(this,m,s),+x.call(this,m,s)])):q.length&&(i(),q=[],r=[]);return q.length&&i(),p.length?p.join(""):null}var c=Cd,d=Cd,e=0,f=Dd,g=Cc,h=ng,i=h.key,j=h,k="L",l=.7;return b.x=function(a){return arguments.length?(c=d=a,b):d},b.x0=function(a){return arguments.length?(c=a,b):c},b.x1=function(a){return arguments.length?(d=a,b):d},b.y=function(a){return arguments.length?(e=f=a,b):f},b.y0=function(a){return arguments.length?(e=a,b):e},b.y1=function(a){return arguments.length?(f=a,b):f},b.defined=function(a){return arguments.length?(g=a,b):g},b.interpolate=function(a){return arguments.length?(i="function"==typeof a?h=a:(h=zj.get(a)||ng).key,j=h.reverse||h,k=h.closed?"M":"L",b):i},b.tension=function(a){return arguments.length?(l=a,b):l},b}function Jg(a){return a.radius}function Kg(a){return[a.x,a.y]}function Lg(a){return function(){var b=a.apply(this,arguments),c=b[0],d=b[1]+xj;return[c*Math.cos(d),c*Math.sin(d)]}}function Mg(){return 64}function Ng(){return"circle"}function Og(a){var b=Math.sqrt(a/Dh);return"M0,"+b+"A"+b+","+b+" 0 1,1 0,"+-b+"A"+b+","+b+" 0 1,1 0,"+b+"Z"}function Pg(a,b){return rh(a,Ij),a.id=b,a}function Qg(a,b,c,d){var e=a.id;return L(a,"function"==typeof c?function(a,f,g){a.__transition__[e].tween.set(b,d(c.call(a,a.__data__,f,g)))}:(c=d(c),function(a){a.__transition__[e].tween.set(b,c)}))}function Rg(a){return null==a&&(a=""),function(){this.textContent=a}}function Sg(a,b,c,d){var e=a.__transition__||(a.__transition__={active:0,count:0}),f=e[c];if(!f){var g=d.time;f=e[c]={tween:new h,time:g,ease:d.ease,delay:d.delay,duration:d.duration},++e.count,$g.timer(function(d){function h(d){return e.active>c?j():(e.active=c,f.event&&f.event.start.call(a,k,b),f.tween.forEach(function(c,d){(d=d.call(a,k,b))&&p.push(d)}),void $g.timer(function(){return o.c=i(d||1)?Cc:i,1},0,g))}function i(d){if(e.active!==c)return j();for(var g=d/n,h=l(g),i=p.length;i>0;)p[--i].call(a,h);return g>=1?(f.event&&f.event.end.call(a,k,b),j()):void 0}function j(){return--e.count?delete e[c]:delete a.__transition__,1}var k=a.__data__,l=f.ease,m=f.delay,n=f.duration,o=bi,p=[];return o.t=m+g,d>=m?h(d-m):void(o.c=h)},0,g)}}function Tg(a,b){a.attr("transform",function(a){return"translate("+b(a)+",0)"})}function Ug(a,b){a.attr("transform",function(a){return"translate(0,"+b(a)+")"})}function Vg(a){return a.toISOString()}function Wg(a,b,c){function d(b){return a(b)}function e(a,c){var d=a[1]-a[0],e=d/c,f=$g.bisect(Rj,e);return f==Rj.length?[b.year,Xf(a.map(function(a){return a/31536e6}),c)[2]]:f?b[e/Rj[f-1]<Rj[f]/e?f-1:f]:[Uj,Xf(a,c)[2]]}return d.invert=function(b){return Xg(a.invert(b))},d.domain=function(b){return arguments.length?(a.domain(b),d):a.domain().map(Xg)},d.nice=function(a,b){function c(c){return!isNaN(c)&&!a.range(c,Xg(+c+1),b).length}var f=d.domain(),g=Of(f),h=null==a?e(g,10):"number"==typeof a&&e(g,a);return h&&(a=h[0],b=h[1]),d.domain(Rf(f,b>1?{floor:function(b){for(;c(b=a.floor(b));)b=Xg(b-1);return b},ceil:function(b){for(;c(b=a.ceil(b));)b=Xg(+b+1);return b}}:a))},d.ticks=function(a,b){var c=Of(d.domain()),f=null==a?e(c,10):"number"==typeof a?e(c,a):!a.range&&[{range:a},b];return f&&(a=f[0],b=f[1]),a.range(c[0],Xg(+c[1]+1),1>b?1:b)},d.tickFormat=function(){return c},d.copy=function(){return Wg(a.copy(),b,c)},Vf(d,a)}function Xg(a){return new Date(a)}function Yg(a){return JSON.parse(a.responseText)}function Zg(a){var b=bh.createRange();return b.selectNode(bh.body),b.createContextualFragment(a.responseText)}var $g={version:"3.4.4"};Date.now||(Date.now=function(){return+new Date});var _g=[].slice,ah=function(a){return _g.call(a)},bh=document,ch=bh.documentElement,dh=window;try{ah(ch.childNodes)[0].nodeType}catch(eh){ah=function(a){for(var b=a.length,c=new Array(b);b--;)c[b]=a[b];return c}}try{bh.createElement("div").style.setProperty("opacity",0,"")}catch(fh){var gh=dh.Element.prototype,hh=gh.setAttribute,ih=gh.setAttributeNS,jh=dh.CSSStyleDeclaration.prototype,kh=jh.setProperty;gh.setAttribute=function(a,b){hh.call(this,a,b+"")},gh.setAttributeNS=function(a,b,c){ih.call(this,a,b,c+"")},jh.setProperty=function(a,b,c){kh.call(this,a,b+"",c)}}$g.ascending=a,$g.descending=function(a,b){return a>b?-1:b>a?1:b>=a?0:0/0},$g.min=function(a,b){var c,d,e=-1,f=a.length;if(1===arguments.length){for(;++e<f&&!(null!=(c=a[e])&&c>=c);)c=void 0;for(;++e<f;)null!=(d=a[e])&&c>d&&(c=d)}else{for(;++e<f&&!(null!=(c=b.call(a,a[e],e))&&c>=c);)c=void 0;for(;++e<f;)null!=(d=b.call(a,a[e],e))&&c>d&&(c=d)}return c},$g.max=function(a,b){var c,d,e=-1,f=a.length;if(1===arguments.length){for(;++e<f&&!(null!=(c=a[e])&&c>=c);)c=void 0;for(;++e<f;)null!=(d=a[e])&&d>c&&(c=d)}else{for(;++e<f&&!(null!=(c=b.call(a,a[e],e))&&c>=c);)c=void 0;for(;++e<f;)null!=(d=b.call(a,a[e],e))&&d>c&&(c=d)}return c},$g.extent=function(a,b){var c,d,e,f=-1,g=a.length;if(1===arguments.length){for(;++f<g&&!(null!=(c=e=a[f])&&c>=c);)c=e=void 0;for(;++f<g;)null!=(d=a[f])&&(c>d&&(c=d),d>e&&(e=d))}else{for(;++f<g&&!(null!=(c=e=b.call(a,a[f],f))&&c>=c);)c=void 0;for(;++f<g;)null!=(d=b.call(a,a[f],f))&&(c>d&&(c=d),d>e&&(e=d))}return[c,e]},$g.sum=function(a,b){var c,d=0,e=a.length,f=-1;if(1===arguments.length)for(;++f<e;)isNaN(c=+a[f])||(d+=c);else for(;++f<e;)isNaN(c=+b.call(a,a[f],f))||(d+=c);return d},$g.mean=function(a,b){var d,e=a.length,f=0,g=-1,h=0;if(1===arguments.length)for(;++g<e;)c(d=a[g])&&(f+=(d-f)/++h);else for(;++g<e;)c(d=b.call(a,a[g],g))&&(f+=(d-f)/++h);return h?f:void 0},$g.quantile=function(a,b){var c=(a.length-1)*b+1,d=Math.floor(c),e=+a[d-1],f=c-d;return f?e+f*(a[d]-e):e},$g.median=function(b,d){return arguments.length>1&&(b=b.map(d)),b=b.filter(c),b.length?$g.quantile(b.sort(a),.5):void 0};var lh=d(a);$g.bisectLeft=lh.left,$g.bisect=$g.bisectRight=lh.right,$g.bisector=function(b){return d(1===b.length?function(c,d){return a(b(c),d)}:b)},$g.shuffle=function(a){for(var b,c,d=a.length;d;)c=Math.random()*d--|0,b=a[d],a[d]=a[c],a[c]=b;return a},$g.permute=function(a,b){for(var c=b.length,d=new Array(c);c--;)d[c]=a[b[c]];return d},$g.pairs=function(a){for(var b,c=0,d=a.length-1,e=a[0],f=new Array(0>d?0:d);d>c;)f[c]=[b=e,e=a[++c]];return f},$g.zip=function(){if(!(d=arguments.length))return[];for(var a=-1,b=$g.min(arguments,e),c=new Array(b);++a<b;)for(var d,f=-1,g=c[a]=new Array(d);++f<d;)g[f]=arguments[f][a];return c},$g.transpose=function(a){return $g.zip.apply($g,a)},$g.keys=function(a){var b=[];for(var c in a)b.push(c);return b},$g.values=function(a){var b=[];for(var c in a)b.push(a[c]);return b},$g.entries=function(a){var b=[];for(var c in a)b.push({key:c,value:a[c]});return b},$g.merge=function(a){for(var b,c,d,e=a.length,f=-1,g=0;++f<e;)g+=a[f].length;for(c=new Array(g);--e>=0;)for(d=a[e],b=d.length;--b>=0;)c[--g]=d[b];return c};var mh=Math.abs;$g.range=function(a,b,c){if(arguments.length<3&&(c=1,arguments.length<2&&(b=a,a=0)),(b-a)/c===1/0)throw new Error("infinite range");var d,e=[],g=f(mh(c)),h=-1;if(a*=g,b*=g,c*=g,0>c)for(;(d=a+c*++h)>b;)e.push(d/g);else for(;(d=a+c*++h)<b;)e.push(d/g);return e},$g.map=function(a){var b=new h;if(a instanceof h)a.forEach(function(a,c){b.set(a,c)});else for(var c in a)b.set(c,a[c]);return b},g(h,{has:i,get:function(a){return this[nh+a]},set:function(a,b){return this[nh+a]=b},remove:j,keys:k,values:function(){var a=[];return this.forEach(function(b,c){a.push(c)}),a},entries:function(){var a=[];return this.forEach(function(b,c){a.push({key:b,value:c})}),a},size:l,empty:m,forEach:function(a){for(var b in this)b.charCodeAt(0)===oh&&a.call(this,b.substring(1),this[b])}});var nh="\x00",oh=nh.charCodeAt(0);$g.nest=function(){function a(b,g,i){if(i>=f.length)return d?d.call(e,g):c?g.sort(c):g;for(var j,k,l,m,n=-1,o=g.length,p=f[i++],q=new h;++n<o;)(m=q.get(j=p(k=g[n])))?m.push(k):q.set(j,[k]);return b?(k=b(),l=function(c,d){k.set(c,a(b,d,i))}):(k={},l=function(c,d){k[c]=a(b,d,i)}),q.forEach(l),k}function b(a,c){if(c>=f.length)return a;var d=[],e=g[c++];return a.forEach(function(a,e){d.push({key:a,values:b(e,c)})}),e?d.sort(function(a,b){return e(a.key,b.key)}):d}var c,d,e={},f=[],g=[];return e.map=function(b,c){return a(c,b,0)},e.entries=function(c){return b(a($g.map,c,0),0)},e.key=function(a){return f.push(a),e},e.sortKeys=function(a){return g[f.length-1]=a,e},e.sortValues=function(a){return c=a,e},e.rollup=function(a){return d=a,e},e},$g.set=function(a){var b=new n;if(a)for(var c=0,d=a.length;d>c;++c)b.add(a[c]);return b},g(n,{has:i,add:function(a){return this[nh+a]=!0,a},remove:function(a){return a=nh+a,a in this&&delete this[a]},values:k,size:l,empty:m,forEach:function(a){for(var b in this)b.charCodeAt(0)===oh&&a.call(this,b.substring(1))}}),$g.behavior={},$g.rebind=function(a,b){for(var c,d=1,e=arguments.length;++d<e;)a[c=arguments[d]]=o(a,b,b[c]);return a};var ph=["webkit","ms","moz","Moz","o","O"];$g.dispatch=function(){for(var a=new r,b=-1,c=arguments.length;++b<c;)a[arguments[b]]=s(a);return a},r.prototype.on=function(a,b){var c=a.indexOf("."),d="";if(c>=0&&(d=a.substring(c+1),a=a.substring(0,c)),a)return arguments.length<2?this[a].on(d):this[a].on(d,b);if(2===arguments.length){if(null==b)for(a in this)this.hasOwnProperty(a)&&this[a].on(d,null);return this}},$g.event=null,$g.requote=function(a){return a.replace(qh,"\\$&")};var qh=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,rh={}.__proto__?function(a,b){a.__proto__=b}:function(a,b){for(var c in b)a[c]=b[c]},sh=function(a,b){return b.querySelector(a)},th=function(a,b){return b.querySelectorAll(a)},uh=ch[p(ch,"matchesSelector")],vh=function(a,b){return uh.call(a,b)};"function"==typeof Sizzle&&(sh=function(a,b){return Sizzle(a,b)[0]||null},th=Sizzle,vh=Sizzle.matchesSelector),$g.selection=function(){return zh};var wh=$g.selection.prototype=[];wh.select=function(a){var b,c,d,e,f=[];a=x(a);for(var g=-1,h=this.length;++g<h;){f.push(b=[]),b.parentNode=(d=this[g]).parentNode;for(var i=-1,j=d.length;++i<j;)(e=d[i])?(b.push(c=a.call(e,e.__data__,i,g)),c&&"__data__"in e&&(c.__data__=e.__data__)):b.push(null)}return w(f)},wh.selectAll=function(a){var b,c,d=[];a=y(a);for(var e=-1,f=this.length;++e<f;)for(var g=this[e],h=-1,i=g.length;++h<i;)(c=g[h])&&(d.push(b=ah(a.call(c,c.__data__,h,e))),b.parentNode=c);return w(d)};var xh={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};$g.ns={prefix:xh,qualify:function(a){var b=a.indexOf(":"),c=a;return b>=0&&(c=a.substring(0,b),a=a.substring(b+1)),xh.hasOwnProperty(c)?{space:xh[c],local:a}:a}},wh.attr=function(a,b){if(arguments.length<2){if("string"==typeof a){var c=this.node();return a=$g.ns.qualify(a),a.local?c.getAttributeNS(a.space,a.local):c.getAttribute(a)}for(b in a)this.each(z(b,a[b]));return this}return this.each(z(a,b))},wh.classed=function(a,b){if(arguments.length<2){if("string"==typeof a){var c=this.node(),d=(a=C(a)).length,e=-1;if(b=c.classList){for(;++e<d;)if(!b.contains(a[e]))return!1}else for(b=c.getAttribute("class");++e<d;)if(!B(a[e]).test(b))return!1;return!0}for(b in a)this.each(D(b,a[b]));return this}return this.each(D(a,b))},wh.style=function(a,b,c){var d=arguments.length;if(3>d){if("string"!=typeof a){2>d&&(b="");for(c in a)this.each(F(c,a[c],b));return this}if(2>d)return dh.getComputedStyle(this.node(),null).getPropertyValue(a);c=""}return this.each(F(a,b,c))},wh.property=function(a,b){if(arguments.length<2){if("string"==typeof a)return this.node()[a];for(b in a)this.each(G(b,a[b]));return this}return this.each(G(a,b))},wh.text=function(a){return arguments.length?this.each("function"==typeof a?function(){var b=a.apply(this,arguments);this.textContent=null==b?"":b}:null==a?function(){this.textContent=""}:function(){this.textContent=a}):this.node().textContent},wh.html=function(a){return arguments.length?this.each("function"==typeof a?function(){var b=a.apply(this,arguments);this.innerHTML=null==b?"":b}:null==a?function(){this.innerHTML=""}:function(){this.innerHTML=a}):this.node().innerHTML},wh.append=function(a){return a=H(a),this.select(function(){return this.appendChild(a.apply(this,arguments))})},wh.insert=function(a,b){return a=H(a),b=x(b),this.select(function(){return this.insertBefore(a.apply(this,arguments),b.apply(this,arguments)||null)})},wh.remove=function(){return this.each(function(){var a=this.parentNode;a&&a.removeChild(this)})},wh.data=function(a,b){function c(a,c){var d,e,f,g=a.length,l=c.length,m=Math.min(g,l),n=new Array(l),o=new Array(l),p=new Array(g);if(b){var q,r=new h,s=new h,t=[];for(d=-1;++d<g;)q=b.call(e=a[d],e.__data__,d),r.has(q)?p[d]=e:r.set(q,e),t.push(q);for(d=-1;++d<l;)q=b.call(c,f=c[d],d),(e=r.get(q))?(n[d]=e,e.__data__=f):s.has(q)||(o[d]=I(f)),s.set(q,f),r.remove(q);for(d=-1;++d<g;)r.has(t[d])&&(p[d]=a[d])}else{for(d=-1;++d<m;)e=a[d],f=c[d],e?(e.__data__=f,n[d]=e):o[d]=I(f);for(;l>d;++d)o[d]=I(c[d]);for(;g>d;++d)p[d]=a[d]}o.update=n,o.parentNode=n.parentNode=p.parentNode=a.parentNode,i.push(o),j.push(n),k.push(p)}var d,e,f=-1,g=this.length;if(!arguments.length){for(a=new Array(g=(d=this[0]).length);++f<g;)(e=d[f])&&(a[f]=e.__data__);return a}var i=M([]),j=w([]),k=w([]);if("function"==typeof a)for(;++f<g;)c(d=this[f],a.call(d,d.parentNode.__data__,f));else for(;++f<g;)c(d=this[f],a);return j.enter=function(){return i},j.exit=function(){return k},j},wh.datum=function(a){return arguments.length?this.property("__data__",a):this.property("__data__")},wh.filter=function(a){var b,c,d,e=[];"function"!=typeof a&&(a=J(a));for(var f=0,g=this.length;g>f;f++){e.push(b=[]),b.parentNode=(c=this[f]).parentNode;for(var h=0,i=c.length;i>h;h++)(d=c[h])&&a.call(d,d.__data__,h,f)&&b.push(d)}return w(e)},wh.order=function(){for(var a=-1,b=this.length;++a<b;)for(var c,d=this[a],e=d.length-1,f=d[e];--e>=0;)(c=d[e])&&(f&&f!==c.nextSibling&&f.parentNode.insertBefore(c,f),f=c);return this},wh.sort=function(a){a=K.apply(this,arguments);for(var b=-1,c=this.length;++b<c;)this[b].sort(a);return this.order()},wh.each=function(a){return L(this,function(b,c,d){a.call(b,b.__data__,c,d)})},wh.call=function(a){var b=ah(arguments);return a.apply(b[0]=this,b),this},wh.empty=function(){return!this.node()},wh.node=function(){for(var a=0,b=this.length;b>a;a++)for(var c=this[a],d=0,e=c.length;e>d;d++){var f=c[d];if(f)return f}return null},wh.size=function(){var a=0;return this.each(function(){++a}),a};var yh=[];$g.selection.enter=M,$g.selection.enter.prototype=yh,yh.append=wh.append,yh.empty=wh.empty,yh.node=wh.node,yh.call=wh.call,yh.size=wh.size,yh.select=function(a){for(var b,c,d,e,f,g=[],h=-1,i=this.length;++h<i;){d=(e=this[h]).update,g.push(b=[]),b.parentNode=e.parentNode;for(var j=-1,k=e.length;++j<k;)(f=e[j])?(b.push(d[j]=c=a.call(e.parentNode,f.__data__,j,h)),c.__data__=f.__data__):b.push(null)}return w(g)},yh.insert=function(a,b){return arguments.length<2&&(b=N(this)),wh.insert.call(this,a,b)},wh.transition=function(){for(var a,b,c=Ej||++Jj,d=[],e=Fj||{time:Date.now(),ease:ye,delay:0,duration:250},f=-1,g=this.length;++f<g;){d.push(a=[]);for(var h=this[f],i=-1,j=h.length;++i<j;)(b=h[i])&&Sg(b,i,c,e),a.push(b)}return Pg(d,c)},wh.interrupt=function(){return this.each(O)},$g.select=function(a){var b=["string"==typeof a?sh(a,bh):a];return b.parentNode=ch,w([b])},$g.selectAll=function(a){var b=ah("string"==typeof a?th(a,bh):a);return b.parentNode=ch,w([b])};var zh=$g.select(ch);wh.on=function(a,b,c){var d=arguments.length;if(3>d){if("string"!=typeof a){2>d&&(b=!1);for(c in a)this.each(P(c,a[c],b));return this}if(2>d)return(d=this.node()["__on"+a])&&d._;c=!1}return this.each(P(a,b,c))};var Ah=$g.map({mouseenter:"mouseover",mouseleave:"mouseout"});Ah.forEach(function(a){"on"+a in bh&&Ah.remove(a)});var Bh="onselectstart"in bh?null:p(ch.style,"userSelect"),Ch=0;$g.mouse=function(a){return T(a,u())},$g.touches=function(a,b){return arguments.length<2&&(b=u().touches),b?ah(b).map(function(b){var c=T(a,b);return c.identifier=b.identifier,c}):[]},$g.behavior.drag=function(){function a(){this.on("mousedown.drag",e).on("touchstart.drag",f)}function b(a,b,e,f,g){return function(){function h(){var a,c,d=b(m,p);d&&(a=d[0]-t[0],c=d[1]-t[1],o|=a|c,t=d,n({type:"drag",x:d[0]+j[0],y:d[1]+j[1],dx:a,dy:c}))}function i(){b(m,p)&&(r.on(f+q,null).on(g+q,null),s(o&&$g.event.target===l),n({type:"dragend"}))}var j,k=this,l=$g.event.target,m=k.parentNode,n=c.of(k,arguments),o=0,p=a(),q=".drag"+(null==p?"":"-"+p),r=$g.select(e()).on(f+q,h).on(g+q,i),s=S(),t=b(m,p);d?(j=d.apply(k,arguments),j=[j.x-t[0],j.y-t[1]]):j=[0,0],n({type:"dragstart"})}}var c=v(a,"drag","dragstart","dragend"),d=null,e=b(q,$g.mouse,W,"mousemove","mouseup"),f=b(U,$g.touch,V,"touchmove","touchend");return a.origin=function(b){return arguments.length?(d=b,a):d},$g.rebind(a,c,"on")};var Dh=Math.PI,Eh=2*Dh,Fh=Dh/2,Gh=1e-6,Hh=Gh*Gh,Ih=Dh/180,Jh=180/Dh,Kh=Math.SQRT2,Lh=2,Mh=4;$g.interpolateZoom=function(a,b){function c(a){var b=a*s;if(r){var c=ab(p),g=f/(Lh*m)*(c*bb(Kh*b+p)-_(p));return[d+g*j,e+g*k,f*c/ab(Kh*b+p)]}return[d+a*j,e+a*k,f*Math.exp(Kh*b)]}var d=a[0],e=a[1],f=a[2],g=b[0],h=b[1],i=b[2],j=g-d,k=h-e,l=j*j+k*k,m=Math.sqrt(l),n=(i*i-f*f+Mh*l)/(2*f*Lh*m),o=(i*i-f*f-Mh*l)/(2*i*Lh*m),p=Math.log(Math.sqrt(n*n+1)-n),q=Math.log(Math.sqrt(o*o+1)-o),r=q-p,s=(r||Math.log(i/f))/Kh;return c.duration=1e3*s,c},$g.behavior.zoom=function(){function a(a){a.on(B,j).on(Ph+".zoom",l).on(C,m).on("dblclick.zoom",n).on(E,k)}function b(a){return[(a[0]-y.x)/y.k,(a[1]-y.y)/y.k]}function c(a){return[a[0]*y.k+y.x,a[1]*y.k+y.y]}function d(a){y.k=Math.max(A[0],Math.min(A[1],a))}function e(a,b){b=c(b),y.x+=a[0]-b[0],y.y+=a[1]-b[1]}function f(){u&&u.domain(s.range().map(function(a){return(a-y.x)/y.k}).map(s.invert)),x&&x.domain(w.range().map(function(a){return(a-y.y)/y.k}).map(w.invert))}function g(a){a({type:"zoomstart"})}function h(a){f(),a({type:"zoom",scale:y.k,translate:[y.x,y.y]})}function i(a){a({type:"zoomend"})}function j(){function a(){k=1,e($g.mouse(d),n),h(j)}function c(){l.on(C,dh===d?m:null).on(D,null),o(k&&$g.event.target===f),i(j)}var d=this,f=$g.event.target,j=F.of(d,arguments),k=0,l=$g.select(dh).on(C,a).on(D,c),n=b($g.mouse(d)),o=S();O.call(d),g(j)}function k(){function a(){var a=$g.touches(n);return m=y.k,a.forEach(function(a){a.identifier in p&&(p[a.identifier]=b(a))}),a}function c(){for(var b=$g.event.changedTouches,c=0,f=b.length;f>c;++c)p[b[c].identifier]=null;var g=a(),i=Date.now();if(1===g.length){if(500>i-r){var j=g[0],k=p[j.identifier];d(2*y.k),e(j,k),t(),h(o)}r=i}else if(g.length>1){var j=g[0],l=g[1],m=j[0]-l[0],n=j[1]-l[1];q=m*m+n*n}}function f(){for(var a,b,c,f,g=$g.touches(n),i=0,j=g.length;j>i;++i,f=null)if(c=g[i],f=p[c.identifier]){if(b)break;a=c,b=f}if(f){var k=(k=c[0]-a[0])*k+(k=c[1]-a[1])*k,l=q&&Math.sqrt(k/q);a=[(a[0]+c[0])/2,(a[1]+c[1])/2],b=[(b[0]+f[0])/2,(b[1]+f[1])/2],d(l*m)}r=null,e(a,b),h(o)}function l(){if($g.event.touches.length){for(var b=$g.event.changedTouches,c=0,d=b.length;d>c;++c)delete p[b[c].identifier];for(var e in p)return void a()}w.on(s,null),x.on(B,j).on(E,k),z(),i(o)}var m,n=this,o=F.of(n,arguments),p={},q=0,s=".zoom-"+$g.event.changedTouches[0].identifier,u="touchmove"+s,v="touchend"+s,w=$g.select($g.event.target).on(u,f).on(v,l),x=$g.select(n).on(B,null).on(E,c),z=S();O.call(n),c(),g(o)}function l(){var a=F.of(this,arguments);q?clearTimeout(q):(O.call(this),g(a)),q=setTimeout(function(){q=null,i(a)},50),t();var c=p||$g.mouse(this);o||(o=b(c)),d(Math.pow(2,.002*Nh())*y.k),e(c,o),h(a)}function m(){o=null}function n(){var a=F.of(this,arguments),c=$g.mouse(this),f=b(c),j=Math.log(y.k)/Math.LN2;g(a),d(Math.pow(2,$g.event.shiftKey?Math.ceil(j)-1:Math.floor(j)+1)),e(c,f),h(a),i(a)}var o,p,q,r,s,u,w,x,y={x:0,y:0,k:1},z=[960,500],A=Oh,B="mousedown.zoom",C="mousemove.zoom",D="mouseup.zoom",E="touchstart.zoom",F=v(a,"zoomstart","zoom","zoomend");return a.event=function(a){a.each(function(){var a=F.of(this,arguments),b=y;Ej?$g.select(this).transition().each("start.zoom",function(){y=this.__chart__||{x:0,y:0,k:1},g(a)}).tween("zoom:zoom",function(){var c=z[0],d=z[1],e=c/2,f=d/2,g=$g.interpolateZoom([(e-y.x)/y.k,(f-y.y)/y.k,c/y.k],[(e-b.x)/b.k,(f-b.y)/b.k,c/b.k]);return function(b){var d=g(b),i=c/d[2];this.__chart__=y={x:e-d[0]*i,y:f-d[1]*i,k:i},h(a)}}).each("end.zoom",function(){i(a)}):(this.__chart__=y,g(a),h(a),i(a))})},a.translate=function(b){return arguments.length?(y={x:+b[0],y:+b[1],k:y.k},f(),a):[y.x,y.y]},a.scale=function(b){return arguments.length?(y={x:y.x,y:y.y,k:+b},f(),a):y.k},a.scaleExtent=function(b){return arguments.length?(A=null==b?Oh:[+b[0],+b[1]],a):A},a.center=function(b){return arguments.length?(p=b&&[+b[0],+b[1]],a):p},a.size=function(b){return arguments.length?(z=b&&[+b[0],+b[1]],a):z},a.x=function(b){return arguments.length?(u=b,s=b.copy(),y={x:0,y:0,k:1},a):u},a.y=function(b){return arguments.length?(x=b,w=b.copy(),y={x:0,y:0,k:1},a):x},$g.rebind(a,F,"on")};var Nh,Oh=[0,1/0],Ph="onwheel"in bh?(Nh=function(){return-$g.event.deltaY*($g.event.deltaMode?120:1)},"wheel"):"onmousewheel"in bh?(Nh=function(){return $g.event.wheelDelta},"mousewheel"):(Nh=function(){return-$g.event.detail},"MozMousePixelScroll");db.prototype.toString=function(){return this.rgb()+""},$g.hsl=function(a,b,c){return 1===arguments.length?a instanceof fb?eb(a.h,a.s,a.l):wb(""+a,xb,eb):eb(+a,+b,+c)};var Qh=fb.prototype=new db;Qh.brighter=function(a){return a=Math.pow(.7,arguments.length?a:1),eb(this.h,this.s,this.l/a)},Qh.darker=function(a){return a=Math.pow(.7,arguments.length?a:1),eb(this.h,this.s,a*this.l)},Qh.rgb=function(){return gb(this.h,this.s,this.l)},$g.hcl=function(a,b,c){return 1===arguments.length?a instanceof ib?hb(a.h,a.c,a.l):a instanceof lb?nb(a.l,a.a,a.b):nb((a=yb((a=$g.rgb(a)).r,a.g,a.b)).l,a.a,a.b):hb(+a,+b,+c)};var Rh=ib.prototype=new db;Rh.brighter=function(a){return hb(this.h,this.c,Math.min(100,this.l+Sh*(arguments.length?a:1)))},Rh.darker=function(a){return hb(this.h,this.c,Math.max(0,this.l-Sh*(arguments.length?a:1)))},Rh.rgb=function(){return jb(this.h,this.c,this.l).rgb()},$g.lab=function(a,b,c){return 1===arguments.length?a instanceof lb?kb(a.l,a.a,a.b):a instanceof ib?jb(a.l,a.c,a.h):yb((a=$g.rgb(a)).r,a.g,a.b):kb(+a,+b,+c)};var Sh=18,Th=.95047,Uh=1,Vh=1.08883,Wh=lb.prototype=new db;Wh.brighter=function(a){return kb(Math.min(100,this.l+Sh*(arguments.length?a:1)),this.a,this.b)},Wh.darker=function(a){return kb(Math.max(0,this.l-Sh*(arguments.length?a:1)),this.a,this.b)},Wh.rgb=function(){return mb(this.l,this.a,this.b)},$g.rgb=function(a,b,c){return 1===arguments.length?a instanceof ub?tb(a.r,a.g,a.b):wb(""+a,tb,gb):tb(~~a,~~b,~~c)};var Xh=ub.prototype=new db;Xh.brighter=function(a){a=Math.pow(.7,arguments.length?a:1);var b=this.r,c=this.g,d=this.b,e=30;
return b||c||d?(b&&e>b&&(b=e),c&&e>c&&(c=e),d&&e>d&&(d=e),tb(Math.min(255,~~(b/a)),Math.min(255,~~(c/a)),Math.min(255,~~(d/a)))):tb(e,e,e)},Xh.darker=function(a){return a=Math.pow(.7,arguments.length?a:1),tb(~~(a*this.r),~~(a*this.g),~~(a*this.b))},Xh.hsl=function(){return xb(this.r,this.g,this.b)},Xh.toString=function(){return"#"+vb(this.r)+vb(this.g)+vb(this.b)};var Yh=$g.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});Yh.forEach(function(a,b){Yh.set(a,rb(b))}),$g.functor=Bb,$g.xhr=Db(Cb),$g.dsv=function(a,b){function c(a,c,f){arguments.length<3&&(f=c,c=null);var g=Eb(a,b,null==c?d:e(c),f);return g.row=function(a){return arguments.length?g.response(null==(c=a)?d:e(a)):c},g}function d(a){return c.parse(a.responseText)}function e(a){return function(b){return c.parse(b.responseText,a)}}function f(b){return b.map(g).join(a)}function g(a){return h.test(a)?'"'+a.replace(/\"/g,'""')+'"':a}var h=new RegExp('["'+a+"\n]"),i=a.charCodeAt(0);return c.parse=function(a,b){var d;return c.parseRows(a,function(a,c){if(d)return d(a,c-1);var e=new Function("d","return {"+a.map(function(a,b){return JSON.stringify(a)+": d["+b+"]"}).join(",")+"}");d=b?function(a,c){return b(e(a),c)}:e})},c.parseRows=function(a,b){function c(){if(k>=j)return g;if(e)return e=!1,f;var b=k;if(34===a.charCodeAt(b)){for(var c=b;c++<j;)if(34===a.charCodeAt(c)){if(34!==a.charCodeAt(c+1))break;++c}k=c+2;var d=a.charCodeAt(c+1);return 13===d?(e=!0,10===a.charCodeAt(c+2)&&++k):10===d&&(e=!0),a.substring(b+1,c).replace(/""/g,'"')}for(;j>k;){var d=a.charCodeAt(k++),h=1;if(10===d)e=!0;else if(13===d)e=!0,10===a.charCodeAt(k)&&(++k,++h);else if(d!==i)continue;return a.substring(b,k-h)}return a.substring(b)}for(var d,e,f={},g={},h=[],j=a.length,k=0,l=0;(d=c())!==g;){for(var m=[];d!==f&&d!==g;)m.push(d),d=c();(!b||(m=b(m,l++)))&&h.push(m)}return h},c.format=function(b){if(Array.isArray(b[0]))return c.formatRows(b);var d=new n,e=[];return b.forEach(function(a){for(var b in a)d.has(b)||e.push(d.add(b))}),[e.map(g).join(a)].concat(b.map(function(b){return e.map(function(a){return g(b[a])}).join(a)})).join("\n")},c.formatRows=function(a){return a.map(f).join("\n")},c},$g.csv=$g.dsv(",","text/csv"),$g.tsv=$g.dsv("	","text/tab-separated-values"),$g.touch=function(a,b,c){if(arguments.length<3&&(c=b,b=u().changedTouches),b)for(var d,e=0,f=b.length;f>e;++e)if((d=b[e]).identifier===c)return T(a,d)};var Zh,$h,_h,ai,bi,ci=dh[p(dh,"requestAnimationFrame")]||function(a){setTimeout(a,17)};$g.timer=function(a,b,c){var d=arguments.length;2>d&&(b=0),3>d&&(c=Date.now());var e=c+b,f={c:a,t:e,f:!1,n:null};$h?$h.n=f:Zh=f,$h=f,_h||(ai=clearTimeout(ai),_h=1,ci(Gb))},$g.timer.flush=function(){Hb(),Ib()},$g.round=function(a,b){return b?Math.round(a*(b=Math.pow(10,b)))/b:Math.round(a)};var di=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"].map(Kb);$g.formatPrefix=function(a,b){var c=0;return a&&(0>a&&(a*=-1),b&&(a=$g.round(a,Jb(a,b))),c=1+Math.floor(1e-12+Math.log(a)/Math.LN10),c=Math.max(-24,Math.min(24,3*Math.floor((c-1)/3)))),di[8+c/3]};var ei=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,fi=$g.map({b:function(a){return a.toString(2)},c:function(a){return String.fromCharCode(a)},o:function(a){return a.toString(8)},x:function(a){return a.toString(16)},X:function(a){return a.toString(16).toUpperCase()},g:function(a,b){return a.toPrecision(b)},e:function(a,b){return a.toExponential(b)},f:function(a,b){return a.toFixed(b)},r:function(a,b){return(a=$g.round(a,Jb(a,b))).toFixed(Math.max(0,Math.min(20,Jb(a*(1+1e-15),b))))}}),gi=$g.time={},hi=Date;Nb.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){ii.setUTCDate.apply(this._,arguments)},setDay:function(){ii.setUTCDay.apply(this._,arguments)},setFullYear:function(){ii.setUTCFullYear.apply(this._,arguments)},setHours:function(){ii.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){ii.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){ii.setUTCMinutes.apply(this._,arguments)},setMonth:function(){ii.setUTCMonth.apply(this._,arguments)},setSeconds:function(){ii.setUTCSeconds.apply(this._,arguments)},setTime:function(){ii.setTime.apply(this._,arguments)}};var ii=Date.prototype;gi.year=Ob(function(a){return a=gi.day(a),a.setMonth(0,1),a},function(a,b){a.setFullYear(a.getFullYear()+b)},function(a){return a.getFullYear()}),gi.years=gi.year.range,gi.years.utc=gi.year.utc.range,gi.day=Ob(function(a){var b=new hi(2e3,0);return b.setFullYear(a.getFullYear(),a.getMonth(),a.getDate()),b},function(a,b){a.setDate(a.getDate()+b)},function(a){return a.getDate()-1}),gi.days=gi.day.range,gi.days.utc=gi.day.utc.range,gi.dayOfYear=function(a){var b=gi.year(a);return Math.floor((a-b-6e4*(a.getTimezoneOffset()-b.getTimezoneOffset()))/864e5)},["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach(function(a,b){b=7-b;var c=gi[a]=Ob(function(a){return(a=gi.day(a)).setDate(a.getDate()-(a.getDay()+b)%7),a},function(a,b){a.setDate(a.getDate()+7*Math.floor(b))},function(a){var c=gi.year(a).getDay();return Math.floor((gi.dayOfYear(a)+(c+b)%7)/7)-(c!==b)});gi[a+"s"]=c.range,gi[a+"s"].utc=c.utc.range,gi[a+"OfYear"]=function(a){var c=gi.year(a).getDay();return Math.floor((gi.dayOfYear(a)+(c+b)%7)/7)}}),gi.week=gi.sunday,gi.weeks=gi.sunday.range,gi.weeks.utc=gi.sunday.utc.range,gi.weekOfYear=gi.sundayOfYear;var ji={"-":"",_:" ",0:"0"},ki=/^\s*\d+/,li=/^%/;$g.locale=function(a){return{numberFormat:Lb(a),timeFormat:Qb(a)}};var mi=$g.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});$g.format=mi.numberFormat,$g.geo={},jc.prototype={s:0,t:0,add:function(a){kc(a,this.t,ni),kc(ni.s,this.s,this),this.s?this.t+=ni.t:this.s=ni.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var ni=new jc;$g.geo.stream=function(a,b){a&&oi.hasOwnProperty(a.type)?oi[a.type](a,b):lc(a,b)};var oi={Feature:function(a,b){lc(a.geometry,b)},FeatureCollection:function(a,b){for(var c=a.features,d=-1,e=c.length;++d<e;)lc(c[d].geometry,b)}},pi={Sphere:function(a,b){b.sphere()},Point:function(a,b){a=a.coordinates,b.point(a[0],a[1],a[2])},MultiPoint:function(a,b){for(var c=a.coordinates,d=-1,e=c.length;++d<e;)a=c[d],b.point(a[0],a[1],a[2])},LineString:function(a,b){mc(a.coordinates,b,0)},MultiLineString:function(a,b){for(var c=a.coordinates,d=-1,e=c.length;++d<e;)mc(c[d],b,0)},Polygon:function(a,b){nc(a.coordinates,b)},MultiPolygon:function(a,b){for(var c=a.coordinates,d=-1,e=c.length;++d<e;)nc(c[d],b)},GeometryCollection:function(a,b){for(var c=a.geometries,d=-1,e=c.length;++d<e;)lc(c[d],b)}};$g.geo.area=function(a){return qi=0,$g.geo.stream(a,si),qi};var qi,ri=new jc,si={sphere:function(){qi+=4*Dh},point:q,lineStart:q,lineEnd:q,polygonStart:function(){ri.reset(),si.lineStart=oc},polygonEnd:function(){var a=2*ri;qi+=0>a?4*Dh+a:a,si.lineStart=si.lineEnd=si.point=q}};$g.geo.bounds=function(){function a(a,b){t.push(u=[k=a,m=a]),l>b&&(l=b),b>n&&(n=b)}function b(b,c){var d=pc([b*Ih,c*Ih]);if(r){var e=rc(r,d),f=[e[1],-e[0],0],g=rc(f,e);uc(g),g=vc(g);var i=b-o,j=i>0?1:-1,p=g[0]*Jh*j,q=mh(i)>180;if(q^(p>j*o&&j*b>p)){var s=g[1]*Jh;s>n&&(n=s)}else if(p=(p+360)%360-180,q^(p>j*o&&j*b>p)){var s=-g[1]*Jh;l>s&&(l=s)}else l>c&&(l=c),c>n&&(n=c);q?o>b?h(k,b)>h(k,m)&&(m=b):h(b,m)>h(k,m)&&(k=b):m>=k?(k>b&&(k=b),b>m&&(m=b)):b>o?h(k,b)>h(k,m)&&(m=b):h(b,m)>h(k,m)&&(k=b)}else a(b,c);r=d,o=b}function c(){v.point=b}function d(){u[0]=k,u[1]=m,v.point=a,r=null}function e(a,c){if(r){var d=a-o;s+=mh(d)>180?d+(d>0?360:-360):d}else p=a,q=c;si.point(a,c),b(a,c)}function f(){si.lineStart()}function g(){e(p,q),si.lineEnd(),mh(s)>Gh&&(k=-(m=180)),u[0]=k,u[1]=m,r=null}function h(a,b){return(b-=a)<0?b+360:b}function i(a,b){return a[0]-b[0]}function j(a,b){return b[0]<=b[1]?b[0]<=a&&a<=b[1]:a<b[0]||b[1]<a}var k,l,m,n,o,p,q,r,s,t,u,v={point:a,lineStart:c,lineEnd:d,polygonStart:function(){v.point=e,v.lineStart=f,v.lineEnd=g,s=0,si.polygonStart()},polygonEnd:function(){si.polygonEnd(),v.point=a,v.lineStart=c,v.lineEnd=d,0>ri?(k=-(m=180),l=-(n=90)):s>Gh?n=90:-Gh>s&&(l=-90),u[0]=k,u[1]=m}};return function(a){n=m=-(k=l=1/0),t=[],$g.geo.stream(a,v);var b=t.length;if(b){t.sort(i);for(var c,d=1,e=t[0],f=[e];b>d;++d)c=t[d],j(c[0],e)||j(c[1],e)?(h(e[0],c[1])>h(e[0],e[1])&&(e[1]=c[1]),h(c[0],e[1])>h(e[0],e[1])&&(e[0]=c[0])):f.push(e=c);for(var g,c,o=-1/0,b=f.length-1,d=0,e=f[b];b>=d;e=c,++d)c=f[d],(g=h(e[1],c[0]))>o&&(o=g,k=c[0],m=e[1])}return t=u=null,1/0===k||1/0===l?[[0/0,0/0],[0/0,0/0]]:[[k,l],[m,n]]}}(),$g.geo.centroid=function(a){ti=ui=vi=wi=xi=yi=zi=Ai=Bi=Ci=Di=0,$g.geo.stream(a,Ei);var b=Bi,c=Ci,d=Di,e=b*b+c*c+d*d;return Hh>e&&(b=yi,c=zi,d=Ai,Gh>ui&&(b=vi,c=wi,d=xi),e=b*b+c*c+d*d,Hh>e)?[0/0,0/0]:[Math.atan2(c,b)*Jh,$(d/Math.sqrt(e))*Jh]};var ti,ui,vi,wi,xi,yi,zi,Ai,Bi,Ci,Di,Ei={sphere:q,point:xc,lineStart:zc,lineEnd:Ac,polygonStart:function(){Ei.lineStart=Bc},polygonEnd:function(){Ei.lineStart=zc}},Fi=Gc(Cc,Lc,Nc,[-Dh,-Dh/2]),Gi=1e9;$g.geo.clipExtent=function(){var a,b,c,d,e,f,g={stream:function(a){return e&&(e.valid=!1),e=f(a),e.valid=!0,e},extent:function(h){return arguments.length?(f=Qc(a=+h[0][0],b=+h[0][1],c=+h[1][0],d=+h[1][1]),e&&(e.valid=!1,e=null),g):[[a,b],[c,d]]}};return g.extent([[0,0],[960,500]])},($g.geo.conicEqualArea=function(){return Sc(Tc)}).raw=Tc,$g.geo.albers=function(){return $g.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)},$g.geo.albersUsa=function(){function a(a){var f=a[0],g=a[1];return b=null,c(f,g),b||(d(f,g),b)||e(f,g),b}var b,c,d,e,f=$g.geo.albers(),g=$g.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),h=$g.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),i={point:function(a,c){b=[a,c]}};return a.invert=function(a){var b=f.scale(),c=f.translate(),d=(a[0]-c[0])/b,e=(a[1]-c[1])/b;return(e>=.12&&.234>e&&d>=-.425&&-.214>d?g:e>=.166&&.234>e&&d>=-.214&&-.115>d?h:f).invert(a)},a.stream=function(a){var b=f.stream(a),c=g.stream(a),d=h.stream(a);return{point:function(a,e){b.point(a,e),c.point(a,e),d.point(a,e)},sphere:function(){b.sphere(),c.sphere(),d.sphere()},lineStart:function(){b.lineStart(),c.lineStart(),d.lineStart()},lineEnd:function(){b.lineEnd(),c.lineEnd(),d.lineEnd()},polygonStart:function(){b.polygonStart(),c.polygonStart(),d.polygonStart()},polygonEnd:function(){b.polygonEnd(),c.polygonEnd(),d.polygonEnd()}}},a.precision=function(b){return arguments.length?(f.precision(b),g.precision(b),h.precision(b),a):f.precision()},a.scale=function(b){return arguments.length?(f.scale(b),g.scale(.35*b),h.scale(b),a.translate(f.translate())):f.scale()},a.translate=function(b){if(!arguments.length)return f.translate();var j=f.scale(),k=+b[0],l=+b[1];return c=f.translate(b).clipExtent([[k-.455*j,l-.238*j],[k+.455*j,l+.238*j]]).stream(i).point,d=g.translate([k-.307*j,l+.201*j]).clipExtent([[k-.425*j+Gh,l+.12*j+Gh],[k-.214*j-Gh,l+.234*j-Gh]]).stream(i).point,e=h.translate([k-.205*j,l+.212*j]).clipExtent([[k-.214*j+Gh,l+.166*j+Gh],[k-.115*j-Gh,l+.234*j-Gh]]).stream(i).point,a},a.scale(1070)};var Hi,Ii,Ji,Ki,Li,Mi,Ni={point:q,lineStart:q,lineEnd:q,polygonStart:function(){Ii=0,Ni.lineStart=Uc},polygonEnd:function(){Ni.lineStart=Ni.lineEnd=Ni.point=q,Hi+=mh(Ii/2)}},Oi={point:Vc,lineStart:q,lineEnd:q,polygonStart:q,polygonEnd:q},Pi={point:Yc,lineStart:Zc,lineEnd:$c,polygonStart:function(){Pi.lineStart=_c},polygonEnd:function(){Pi.point=Yc,Pi.lineStart=Zc,Pi.lineEnd=$c}};$g.geo.path=function(){function a(a){return a&&("function"==typeof h&&f.pointRadius(+h.apply(this,arguments)),g&&g.valid||(g=e(f)),$g.geo.stream(a,g)),f.result()}function b(){return g=null,a}var c,d,e,f,g,h=4.5;return a.area=function(a){return Hi=0,$g.geo.stream(a,e(Ni)),Hi},a.centroid=function(a){return vi=wi=xi=yi=zi=Ai=Bi=Ci=Di=0,$g.geo.stream(a,e(Pi)),Di?[Bi/Di,Ci/Di]:Ai?[yi/Ai,zi/Ai]:xi?[vi/xi,wi/xi]:[0/0,0/0]},a.bounds=function(a){return Li=Mi=-(Ji=Ki=1/0),$g.geo.stream(a,e(Oi)),[[Ji,Ki],[Li,Mi]]},a.projection=function(a){return arguments.length?(e=(c=a)?a.stream||cd(a):Cb,b()):c},a.context=function(a){return arguments.length?(f=null==(d=a)?new Wc:new ad(a),"function"!=typeof h&&f.pointRadius(h),b()):d},a.pointRadius=function(b){return arguments.length?(h="function"==typeof b?b:(f.pointRadius(+b),+b),a):h},a.projection($g.geo.albersUsa()).context(null)},$g.geo.transform=function(a){return{stream:function(b){var c=new dd(b);for(var d in a)c[d]=a[d];return c}}},dd.prototype={point:function(a,b){this.stream.point(a,b)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},$g.geo.projection=fd,$g.geo.projectionMutator=gd,($g.geo.equirectangular=function(){return fd(id)}).raw=id.invert=id,$g.geo.rotation=function(a){function b(b){return b=a(b[0]*Ih,b[1]*Ih),b[0]*=Jh,b[1]*=Jh,b}return a=kd(a[0]%360*Ih,a[1]*Ih,a.length>2?a[2]*Ih:0),b.invert=function(b){return b=a.invert(b[0]*Ih,b[1]*Ih),b[0]*=Jh,b[1]*=Jh,b},b},jd.invert=id,$g.geo.circle=function(){function a(){var a="function"==typeof d?d.apply(this,arguments):d,b=kd(-a[0]*Ih,-a[1]*Ih,0).invert,e=[];return c(null,null,1,{point:function(a,c){e.push(a=b(a,c)),a[0]*=Jh,a[1]*=Jh}}),{type:"Polygon",coordinates:[e]}}var b,c,d=[0,0],e=6;return a.origin=function(b){return arguments.length?(d=b,a):d},a.angle=function(d){return arguments.length?(c=od((b=+d)*Ih,e*Ih),a):b},a.precision=function(d){return arguments.length?(c=od(b*Ih,(e=+d)*Ih),a):e},a.angle(90)},$g.geo.distance=function(a,b){var c,d=(b[0]-a[0])*Ih,e=a[1]*Ih,f=b[1]*Ih,g=Math.sin(d),h=Math.cos(d),i=Math.sin(e),j=Math.cos(e),k=Math.sin(f),l=Math.cos(f);return Math.atan2(Math.sqrt((c=l*g)*c+(c=j*k-i*l*h)*c),i*k+j*l*h)},$g.geo.graticule=function(){function a(){return{type:"MultiLineString",coordinates:b()}}function b(){return $g.range(Math.ceil(f/q)*q,e,q).map(m).concat($g.range(Math.ceil(j/r)*r,i,r).map(n)).concat($g.range(Math.ceil(d/o)*o,c,o).filter(function(a){return mh(a%q)>Gh}).map(k)).concat($g.range(Math.ceil(h/p)*p,g,p).filter(function(a){return mh(a%r)>Gh}).map(l))}var c,d,e,f,g,h,i,j,k,l,m,n,o=10,p=o,q=90,r=360,s=2.5;return a.lines=function(){return b().map(function(a){return{type:"LineString",coordinates:a}})},a.outline=function(){return{type:"Polygon",coordinates:[m(f).concat(n(i).slice(1),m(e).reverse().slice(1),n(j).reverse().slice(1))]}},a.extent=function(b){return arguments.length?a.majorExtent(b).minorExtent(b):a.minorExtent()},a.majorExtent=function(b){return arguments.length?(f=+b[0][0],e=+b[1][0],j=+b[0][1],i=+b[1][1],f>e&&(b=f,f=e,e=b),j>i&&(b=j,j=i,i=b),a.precision(s)):[[f,j],[e,i]]},a.minorExtent=function(b){return arguments.length?(d=+b[0][0],c=+b[1][0],h=+b[0][1],g=+b[1][1],d>c&&(b=d,d=c,c=b),h>g&&(b=h,h=g,g=b),a.precision(s)):[[d,h],[c,g]]},a.step=function(b){return arguments.length?a.majorStep(b).minorStep(b):a.minorStep()},a.majorStep=function(b){return arguments.length?(q=+b[0],r=+b[1],a):[q,r]},a.minorStep=function(b){return arguments.length?(o=+b[0],p=+b[1],a):[o,p]},a.precision=function(b){return arguments.length?(s=+b,k=qd(h,g,90),l=rd(d,c,s),m=qd(j,i,90),n=rd(f,e,s),a):s},a.majorExtent([[-180,-90+Gh],[180,90-Gh]]).minorExtent([[-180,-80-Gh],[180,80+Gh]])},$g.geo.greatArc=function(){function a(){return{type:"LineString",coordinates:[b||d.apply(this,arguments),c||e.apply(this,arguments)]}}var b,c,d=sd,e=td;return a.distance=function(){return $g.geo.distance(b||d.apply(this,arguments),c||e.apply(this,arguments))},a.source=function(c){return arguments.length?(d=c,b="function"==typeof c?null:c,a):d},a.target=function(b){return arguments.length?(e=b,c="function"==typeof b?null:b,a):e},a.precision=function(){return arguments.length?a:0},a},$g.geo.interpolate=function(a,b){return ud(a[0]*Ih,a[1]*Ih,b[0]*Ih,b[1]*Ih)},$g.geo.length=function(a){return Qi=0,$g.geo.stream(a,Ri),Qi};var Qi,Ri={sphere:q,point:q,lineStart:vd,lineEnd:q,polygonStart:q,polygonEnd:q},Si=wd(function(a){return Math.sqrt(2/(1+a))},function(a){return 2*Math.asin(a/2)});($g.geo.azimuthalEqualArea=function(){return fd(Si)}).raw=Si;var Ti=wd(function(a){var b=Math.acos(a);return b&&b/Math.sin(b)},Cb);($g.geo.azimuthalEquidistant=function(){return fd(Ti)}).raw=Ti,($g.geo.conicConformal=function(){return Sc(xd)}).raw=xd,($g.geo.conicEquidistant=function(){return Sc(yd)}).raw=yd;var Ui=wd(function(a){return 1/a},Math.atan);($g.geo.gnomonic=function(){return fd(Ui)}).raw=Ui,zd.invert=function(a,b){return[a,2*Math.atan(Math.exp(b))-Fh]},($g.geo.mercator=function(){return Ad(zd)}).raw=zd;var Vi=wd(function(){return 1},Math.asin);($g.geo.orthographic=function(){return fd(Vi)}).raw=Vi;var Wi=wd(function(a){return 1/(1+a)},function(a){return 2*Math.atan(a)});($g.geo.stereographic=function(){return fd(Wi)}).raw=Wi,Bd.invert=function(a,b){return[-b,2*Math.atan(Math.exp(a))-Fh]},($g.geo.transverseMercator=function(){var a=Ad(Bd),b=a.center,c=a.rotate;return a.center=function(a){return a?b([-a[1],a[0]]):(a=b(),[-a[1],a[0]])},a.rotate=function(a){return a?c([a[0],a[1],a.length>2?a[2]+90:90]):(a=c(),[a[0],a[1],a[2]-90])},a.rotate([0,0])}).raw=Bd,$g.geom={},$g.geom.hull=function(a){function b(a){if(a.length<3)return[];var b,e=Bb(c),f=Bb(d),g=a.length,h=[],i=[];for(b=0;g>b;b++)h.push([+e.call(this,a[b],b),+f.call(this,a[b],b),b]);for(h.sort(Fd),b=0;g>b;b++)i.push([h[b][0],-h[b][1]]);var j=Ed(h),k=Ed(i),l=k[0]===j[0],m=k[k.length-1]===j[j.length-1],n=[];for(b=j.length-1;b>=0;--b)n.push(a[h[j[b]][2]]);for(b=+l;b<k.length-m;++b)n.push(a[h[k[b]][2]]);return n}var c=Cd,d=Dd;return arguments.length?b(a):(b.x=function(a){return arguments.length?(c=a,b):c},b.y=function(a){return arguments.length?(d=a,b):d},b)},$g.geom.polygon=function(a){return rh(a,Xi),a};var Xi=$g.geom.polygon.prototype=[];Xi.area=function(){for(var a,b=-1,c=this.length,d=this[c-1],e=0;++b<c;)a=d,d=this[b],e+=a[1]*d[0]-a[0]*d[1];return.5*e},Xi.centroid=function(a){var b,c,d=-1,e=this.length,f=0,g=0,h=this[e-1];for(arguments.length||(a=-1/(6*this.area()));++d<e;)b=h,h=this[d],c=b[0]*h[1]-h[0]*b[1],f+=(b[0]+h[0])*c,g+=(b[1]+h[1])*c;return[f*a,g*a]},Xi.clip=function(a){for(var b,c,d,e,f,g,h=Id(a),i=-1,j=this.length-Id(this),k=this[j-1];++i<j;){for(b=a.slice(),a.length=0,e=this[i],f=b[(d=b.length-h)-1],c=-1;++c<d;)g=b[c],Gd(g,k,e)?(Gd(f,k,e)||a.push(Hd(f,g,k,e)),a.push(g)):Gd(f,k,e)&&a.push(Hd(f,g,k,e)),f=g;h&&a.push(a[0]),k=e}return a};var Yi,Zi,$i,_i,aj,bj=[],cj=[];Qd.prototype.prepare=function(){for(var a,b=this.edges,c=b.length;c--;)a=b[c].edge,a.b&&a.a||b.splice(c,1);return b.sort(Sd),b.length},ae.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},be.prototype={insert:function(a,b){var c,d,e;if(a){if(b.P=a,b.N=a.N,a.N&&(a.N.P=b),a.N=b,a.R){for(a=a.R;a.L;)a=a.L;a.L=b}else a.R=b;c=a}else this._?(a=fe(this._),b.P=null,b.N=a,a.P=a.L=b,c=a):(b.P=b.N=null,this._=b,c=null);for(b.L=b.R=null,b.U=c,b.C=!0,a=b;c&&c.C;)d=c.U,c===d.L?(e=d.R,e&&e.C?(c.C=e.C=!1,d.C=!0,a=d):(a===c.R&&(de(this,c),a=c,c=a.U),c.C=!1,d.C=!0,ee(this,d))):(e=d.L,e&&e.C?(c.C=e.C=!1,d.C=!0,a=d):(a===c.L&&(ee(this,c),a=c,c=a.U),c.C=!1,d.C=!0,de(this,d))),c=a.U;this._.C=!1},remove:function(a){a.N&&(a.N.P=a.P),a.P&&(a.P.N=a.N),a.N=a.P=null;var b,c,d,e=a.U,f=a.L,g=a.R;if(c=f?g?fe(g):f:g,e?e.L===a?e.L=c:e.R=c:this._=c,f&&g?(d=c.C,c.C=a.C,c.L=f,f.U=c,c!==g?(e=c.U,c.U=a.U,a=c.R,e.L=a,c.R=g,g.U=c):(c.U=e,e=c,a=c.R)):(d=a.C,a=c),a&&(a.U=e),!d){if(a&&a.C)return void(a.C=!1);do{if(a===this._)break;if(a===e.L){if(b=e.R,b.C&&(b.C=!1,e.C=!0,de(this,e),b=e.R),b.L&&b.L.C||b.R&&b.R.C){b.R&&b.R.C||(b.L.C=!1,b.C=!0,ee(this,b),b=e.R),b.C=e.C,e.C=b.R.C=!1,de(this,e),a=this._;break}}else if(b=e.L,b.C&&(b.C=!1,e.C=!0,ee(this,e),b=e.L),b.L&&b.L.C||b.R&&b.R.C){b.L&&b.L.C||(b.R.C=!1,b.C=!0,de(this,b),b=e.L),b.C=e.C,e.C=b.L.C=!1,ee(this,e),a=this._;break}b.C=!0,a=e,e=e.U}while(!a.C);a&&(a.C=!1)}}},$g.geom.voronoi=function(a){function b(a){var b=new Array(a.length),d=h[0][0],e=h[0][1],f=h[1][0],g=h[1][1];return ge(c(a),h).cells.forEach(function(c,h){var i=c.edges,j=c.site,k=b[h]=i.length?i.map(function(a){var b=a.start();return[b.x,b.y]}):j.x>=d&&j.x<=f&&j.y>=e&&j.y<=g?[[d,g],[f,g],[f,e],[d,e]]:[];k.point=a[h]}),b}function c(a){return a.map(function(a,b){return{x:Math.round(f(a,b)/Gh)*Gh,y:Math.round(g(a,b)/Gh)*Gh,i:b}})}var d=Cd,e=Dd,f=d,g=e,h=dj;return a?b(a):(b.links=function(a){return ge(c(a)).edges.filter(function(a){return a.l&&a.r}).map(function(b){return{source:a[b.l.i],target:a[b.r.i]}})},b.triangles=function(a){var b=[];return ge(c(a)).cells.forEach(function(c,d){for(var e,f,g=c.site,h=c.edges.sort(Sd),i=-1,j=h.length,k=h[j-1].edge,l=k.l===g?k.r:k.l;++i<j;)e=k,f=l,k=h[i].edge,l=k.l===g?k.r:k.l,d<f.i&&d<l.i&&ie(g,f,l)<0&&b.push([a[d],a[f.i],a[l.i]])}),b},b.x=function(a){return arguments.length?(f=Bb(d=a),b):d},b.y=function(a){return arguments.length?(g=Bb(e=a),b):e},b.clipExtent=function(a){return arguments.length?(h=null==a?dj:a,b):h===dj?null:h},b.size=function(a){return arguments.length?b.clipExtent(a&&[[0,0],a]):h===dj?null:h&&h[1]},b)};var dj=[[-1e6,-1e6],[1e6,1e6]];$g.geom.delaunay=function(a){return $g.geom.voronoi().triangles(a)},$g.geom.quadtree=function(a,b,c,d,e){function f(a){function f(a,b,c,d,e,f,g,h){if(!isNaN(c)&&!isNaN(d))if(a.leaf){var i=a.x,k=a.y;if(null!=i)if(mh(i-c)+mh(k-d)<.01)j(a,b,c,d,e,f,g,h);else{var l=a.point;a.x=a.y=a.point=null,j(a,l,i,k,e,f,g,h),j(a,b,c,d,e,f,g,h)}else a.x=c,a.y=d,a.point=b}else j(a,b,c,d,e,f,g,h)}function j(a,b,c,d,e,g,h,i){var j=.5*(e+h),k=.5*(g+i),l=c>=j,m=d>=k,n=(m<<1)+l;a.leaf=!1,a=a.nodes[n]||(a.nodes[n]=le()),l?e=j:h=j,m?g=k:i=k,f(a,b,c,d,e,g,h,i)}var k,l,m,n,o,p,q,r,s,t=Bb(h),u=Bb(i);if(null!=b)p=b,q=c,r=d,s=e;else if(r=s=-(p=q=1/0),l=[],m=[],o=a.length,g)for(n=0;o>n;++n)k=a[n],k.x<p&&(p=k.x),k.y<q&&(q=k.y),k.x>r&&(r=k.x),k.y>s&&(s=k.y),l.push(k.x),m.push(k.y);else for(n=0;o>n;++n){var v=+t(k=a[n],n),w=+u(k,n);p>v&&(p=v),q>w&&(q=w),v>r&&(r=v),w>s&&(s=w),l.push(v),m.push(w)}var x=r-p,y=s-q;x>y?s=q+x:r=p+y;var z=le();if(z.add=function(a){f(z,a,+t(a,++n),+u(a,n),p,q,r,s)},z.visit=function(a){me(a,z,p,q,r,s)},n=-1,null==b){for(;++n<o;)f(z,a[n],l[n],m[n],p,q,r,s);--n}else a.forEach(z.add);return l=m=a=k=null,z}var g,h=Cd,i=Dd;return(g=arguments.length)?(h=je,i=ke,3===g&&(e=c,d=b,c=b=0),f(a)):(f.x=function(a){return arguments.length?(h=a,f):h},f.y=function(a){return arguments.length?(i=a,f):i},f.extent=function(a){return arguments.length?(null==a?b=c=d=e=null:(b=+a[0][0],c=+a[0][1],d=+a[1][0],e=+a[1][1]),f):null==b?null:[[b,c],[d,e]]},f.size=function(a){return arguments.length?(null==a?b=c=d=e=null:(b=c=0,d=+a[0],e=+a[1]),f):null==b?null:[d-b,e-c]},f)},$g.interpolateRgb=ne,$g.interpolateObject=oe,$g.interpolateNumber=pe,$g.interpolateString=qe;var ej=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g;$g.interpolate=re,$g.interpolators=[function(a,b){var c=typeof b;return("string"===c?Yh.has(b)||/^(#|rgb\(|hsl\()/.test(b)?ne:qe:b instanceof db?ne:Array.isArray(b)?se:"object"===c&&isNaN(b)?oe:pe)(a,b)}],$g.interpolateArray=se;var fj=function(){return Cb},gj=$g.map({linear:fj,poly:ze,quad:function(){return we},cubic:function(){return xe},sin:function(){return Ae},exp:function(){return Be},circle:function(){return Ce},elastic:De,back:Ee,bounce:function(){return Fe}}),hj=$g.map({"in":Cb,out:ue,"in-out":ve,"out-in":function(a){return ve(ue(a))}});$g.ease=function(a){var b=a.indexOf("-"),c=b>=0?a.substring(0,b):a,d=b>=0?a.substring(b+1):"in";return c=gj.get(c)||fj,d=hj.get(d)||Cb,te(d(c.apply(null,_g.call(arguments,1))))},$g.interpolateHcl=Ge,$g.interpolateHsl=He,$g.interpolateLab=Ie,$g.interpolateRound=Je,$g.transform=function(a){var b=bh.createElementNS($g.ns.prefix.svg,"g");return($g.transform=function(a){if(null!=a){b.setAttribute("transform",a);var c=b.transform.baseVal.consolidate()}return new Ke(c?c.matrix:ij)})(a)},Ke.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var ij={a:1,b:0,c:0,d:1,e:0,f:0};$g.interpolateTransform=Oe,$g.layout={},$g.layout.bundle=function(){return function(a){for(var b=[],c=-1,d=a.length;++c<d;)b.push(Re(a[c]));return b}},$g.layout.chord=function(){function a(){var a,j,l,m,n,o={},p=[],q=$g.range(f),r=[];for(c=[],d=[],a=0,m=-1;++m<f;){for(j=0,n=-1;++n<f;)j+=e[m][n];p.push(j),r.push($g.range(f)),a+=j}for(g&&q.sort(function(a,b){return g(p[a],p[b])}),h&&r.forEach(function(a,b){a.sort(function(a,c){return h(e[b][a],e[b][c])})}),a=(Eh-k*f)/a,j=0,m=-1;++m<f;){for(l=j,n=-1;++n<f;){var s=q[m],t=r[s][n],u=e[s][t],v=j,w=j+=u*a;o[s+"-"+t]={index:s,subindex:t,startAngle:v,endAngle:w,value:u}}d[s]={index:s,startAngle:l,endAngle:j,value:(j-l)/a},j+=k}for(m=-1;++m<f;)for(n=m-1;++n<f;){var x=o[m+"-"+n],y=o[n+"-"+m];(x.value||y.value)&&c.push(x.value<y.value?{source:y,target:x}:{source:x,target:y})}i&&b()}function b(){c.sort(function(a,b){return i((a.source.value+a.target.value)/2,(b.source.value+b.target.value)/2)})}var c,d,e,f,g,h,i,j={},k=0;return j.matrix=function(a){return arguments.length?(f=(e=a)&&e.length,c=d=null,j):e},j.padding=function(a){return arguments.length?(k=a,c=d=null,j):k},j.sortGroups=function(a){return arguments.length?(g=a,c=d=null,j):g},j.sortSubgroups=function(a){return arguments.length?(h=a,c=null,j):h},j.sortChords=function(a){return arguments.length?(i=a,c&&b(),j):i},j.chords=function(){return c||a(),c},j.groups=function(){return d||a(),d},j},$g.layout.force=function(){function a(a){return function(b,c,d,e){if(b.point!==a){var f=b.cx-a.x,g=b.cy-a.y,h=e-c,i=f*f+g*g;if(i>h*h/q){if(o>i){var j=b.charge/i;a.px-=f*j,a.py-=g*j}return!0}if(b.point&&i&&o>i){var j=b.pointCharge/i;a.px-=f*j,a.py-=g*j}}return!b.charge}}function b(a){a.px=$g.event.x,a.py=$g.event.y,h.resume()}var c,d,e,f,g,h={},i=$g.dispatch("start","tick","end"),j=[1,1],k=.9,l=jj,m=kj,n=-30,o=lj,p=.1,q=.64,r=[],s=[];return h.tick=function(){if((d*=.99)<.005)return i.end({type:"end",alpha:d=0}),!0;var b,c,h,l,m,o,q,t,u,v=r.length,w=s.length;for(c=0;w>c;++c)h=s[c],l=h.source,m=h.target,t=m.x-l.x,u=m.y-l.y,(o=t*t+u*u)&&(o=d*f[c]*((o=Math.sqrt(o))-e[c])/o,t*=o,u*=o,m.x-=t*(q=l.weight/(m.weight+l.weight)),m.y-=u*q,l.x+=t*(q=1-q),l.y+=u*q);if((q=d*p)&&(t=j[0]/2,u=j[1]/2,c=-1,q))for(;++c<v;)h=r[c],h.x+=(t-h.x)*q,h.y+=(u-h.y)*q;if(n)for(Ye(b=$g.geom.quadtree(r),d,g),c=-1;++c<v;)(h=r[c]).fixed||b.visit(a(h));for(c=-1;++c<v;)h=r[c],h.fixed?(h.x=h.px,h.y=h.py):(h.x-=(h.px-(h.px=h.x))*k,h.y-=(h.py-(h.py=h.y))*k);i.tick({type:"tick",alpha:d})},h.nodes=function(a){return arguments.length?(r=a,h):r},h.links=function(a){return arguments.length?(s=a,h):s},h.size=function(a){return arguments.length?(j=a,h):j},h.linkDistance=function(a){return arguments.length?(l="function"==typeof a?a:+a,h):l},h.distance=h.linkDistance,h.linkStrength=function(a){return arguments.length?(m="function"==typeof a?a:+a,h):m},h.friction=function(a){return arguments.length?(k=+a,h):k},h.charge=function(a){return arguments.length?(n="function"==typeof a?a:+a,h):n},h.chargeDistance=function(a){return arguments.length?(o=a*a,h):Math.sqrt(o)},h.gravity=function(a){return arguments.length?(p=+a,h):p},h.theta=function(a){return arguments.length?(q=a*a,h):Math.sqrt(q)},h.alpha=function(a){return arguments.length?(a=+a,d?d=a>0?a:0:a>0&&(i.start({type:"start",alpha:d=a}),$g.timer(h.tick)),h):d},h.start=function(){function a(a,d){if(!c){for(c=new Array(i),h=0;i>h;++h)c[h]=[];for(h=0;j>h;++h){var e=s[h];c[e.source.index].push(e.target),c[e.target.index].push(e.source)}}for(var f,g=c[b],h=-1,j=g.length;++h<j;)if(!isNaN(f=g[h][a]))return f;return Math.random()*d}var b,c,d,i=r.length,k=s.length,o=j[0],p=j[1];for(b=0;i>b;++b)(d=r[b]).index=b,d.weight=0;for(b=0;k>b;++b)d=s[b],"number"==typeof d.source&&(d.source=r[d.source]),"number"==typeof d.target&&(d.target=r[d.target]),++d.source.weight,++d.target.weight;for(b=0;i>b;++b)d=r[b],isNaN(d.x)&&(d.x=a("x",o)),isNaN(d.y)&&(d.y=a("y",p)),isNaN(d.px)&&(d.px=d.x),isNaN(d.py)&&(d.py=d.y);if(e=[],"function"==typeof l)for(b=0;k>b;++b)e[b]=+l.call(this,s[b],b);else for(b=0;k>b;++b)e[b]=l;if(f=[],"function"==typeof m)for(b=0;k>b;++b)f[b]=+m.call(this,s[b],b);else for(b=0;k>b;++b)f[b]=m;if(g=[],"function"==typeof n)for(b=0;i>b;++b)g[b]=+n.call(this,r[b],b);else for(b=0;i>b;++b)g[b]=n;return h.resume()},h.resume=function(){return h.alpha(.1)},h.stop=function(){return h.alpha(0)},h.drag=function(){return c||(c=$g.behavior.drag().origin(Cb).on("dragstart.force",Ue).on("drag.force",b).on("dragend.force",Ve)),arguments.length?void this.on("mouseover.force",We).on("mouseout.force",Xe).call(c):c
},$g.rebind(h,i,"on")};var jj=20,kj=1,lj=1/0;$g.layout.hierarchy=function(){function a(b,g,h){var i=e.call(c,b,g);if(b.depth=g,h.push(b),i&&(j=i.length)){for(var j,k,l=-1,m=b.children=new Array(j),n=0,o=g+1;++l<j;)k=m[l]=a(i[l],o,h),k.parent=b,n+=k.value;d&&m.sort(d),f&&(b.value=n)}else delete b.children,f&&(b.value=+f.call(c,b,g)||0);return b}function b(a,d){var e=a.children,g=0;if(e&&(h=e.length))for(var h,i=-1,j=d+1;++i<h;)g+=b(e[i],j);else f&&(g=+f.call(c,a,d)||0);return f&&(a.value=g),g}function c(b){var c=[];return a(b,0,c),c}var d=af,e=$e,f=_e;return c.sort=function(a){return arguments.length?(d=a,c):d},c.children=function(a){return arguments.length?(e=a,c):e},c.value=function(a){return arguments.length?(f=a,c):f},c.revalue=function(a){return b(a,0),a},c},$g.layout.partition=function(){function a(b,c,d,e){var f=b.children;if(b.x=c,b.y=b.depth*e,b.dx=d,b.dy=e,f&&(g=f.length)){var g,h,i,j=-1;for(d=b.value?d/b.value:0;++j<g;)a(h=f[j],c,i=h.value*d,e),c+=i}}function b(a){var c=a.children,d=0;if(c&&(e=c.length))for(var e,f=-1;++f<e;)d=Math.max(d,b(c[f]));return 1+d}function c(c,f){var g=d.call(this,c,f);return a(g[0],0,e[0],e[1]/b(g[0])),g}var d=$g.layout.hierarchy(),e=[1,1];return c.size=function(a){return arguments.length?(e=a,c):e},Ze(c,d)},$g.layout.pie=function(){function a(f){var g=f.map(function(c,d){return+b.call(a,c,d)}),h=+("function"==typeof d?d.apply(this,arguments):d),i=(("function"==typeof e?e.apply(this,arguments):e)-h)/$g.sum(g),j=$g.range(f.length);null!=c&&j.sort(c===mj?function(a,b){return g[b]-g[a]}:function(a,b){return c(f[a],f[b])});var k=[];return j.forEach(function(a){var b;k[a]={data:f[a],value:b=g[a],startAngle:h,endAngle:h+=b*i}}),k}var b=Number,c=mj,d=0,e=Eh;return a.value=function(c){return arguments.length?(b=c,a):b},a.sort=function(b){return arguments.length?(c=b,a):c},a.startAngle=function(b){return arguments.length?(d=b,a):d},a.endAngle=function(b){return arguments.length?(e=b,a):e},a};var mj={};$g.layout.stack=function(){function a(h,i){var j=h.map(function(c,d){return b.call(a,c,d)}),k=j.map(function(b){return b.map(function(b,c){return[f.call(a,b,c),g.call(a,b,c)]})}),l=c.call(a,k,i);j=$g.permute(j,l),k=$g.permute(k,l);var m,n,o,p=d.call(a,k,i),q=j.length,r=j[0].length;for(n=0;r>n;++n)for(e.call(a,j[0][n],o=p[n],k[0][n][1]),m=1;q>m;++m)e.call(a,j[m][n],o+=k[m-1][n][1],k[m][n][1]);return h}var b=Cb,c=ff,d=gf,e=ef,f=cf,g=df;return a.values=function(c){return arguments.length?(b=c,a):b},a.order=function(b){return arguments.length?(c="function"==typeof b?b:nj.get(b)||ff,a):c},a.offset=function(b){return arguments.length?(d="function"==typeof b?b:oj.get(b)||gf,a):d},a.x=function(b){return arguments.length?(f=b,a):f},a.y=function(b){return arguments.length?(g=b,a):g},a.out=function(b){return arguments.length?(e=b,a):e},a};var nj=$g.map({"inside-out":function(a){var b,c,d=a.length,e=a.map(hf),f=a.map(jf),g=$g.range(d).sort(function(a,b){return e[a]-e[b]}),h=0,i=0,j=[],k=[];for(b=0;d>b;++b)c=g[b],i>h?(h+=f[c],j.push(c)):(i+=f[c],k.push(c));return k.reverse().concat(j)},reverse:function(a){return $g.range(a.length).reverse()},"default":ff}),oj=$g.map({silhouette:function(a){var b,c,d,e=a.length,f=a[0].length,g=[],h=0,i=[];for(c=0;f>c;++c){for(b=0,d=0;e>b;b++)d+=a[b][c][1];d>h&&(h=d),g.push(d)}for(c=0;f>c;++c)i[c]=(h-g[c])/2;return i},wiggle:function(a){var b,c,d,e,f,g,h,i,j,k=a.length,l=a[0],m=l.length,n=[];for(n[0]=i=j=0,c=1;m>c;++c){for(b=0,e=0;k>b;++b)e+=a[b][c][1];for(b=0,f=0,h=l[c][0]-l[c-1][0];k>b;++b){for(d=0,g=(a[b][c][1]-a[b][c-1][1])/(2*h);b>d;++d)g+=(a[d][c][1]-a[d][c-1][1])/h;f+=g*a[b][c][1]}n[c]=i-=e?f/e*h:0,j>i&&(j=i)}for(c=0;m>c;++c)n[c]-=j;return n},expand:function(a){var b,c,d,e=a.length,f=a[0].length,g=1/e,h=[];for(c=0;f>c;++c){for(b=0,d=0;e>b;b++)d+=a[b][c][1];if(d)for(b=0;e>b;b++)a[b][c][1]/=d;else for(b=0;e>b;b++)a[b][c][1]=g}for(c=0;f>c;++c)h[c]=0;return h},zero:gf});$g.layout.histogram=function(){function a(a,f){for(var g,h,i=[],j=a.map(c,this),k=d.call(this,j,f),l=e.call(this,k,j,f),f=-1,m=j.length,n=l.length-1,o=b?1:1/m;++f<n;)g=i[f]=[],g.dx=l[f+1]-(g.x=l[f]),g.y=0;if(n>0)for(f=-1;++f<m;)h=j[f],h>=k[0]&&h<=k[1]&&(g=i[$g.bisect(l,h,1,n)-1],g.y+=o,g.push(a[f]));return i}var b=!0,c=Number,d=nf,e=lf;return a.value=function(b){return arguments.length?(c=b,a):c},a.range=function(b){return arguments.length?(d=Bb(b),a):d},a.bins=function(b){return arguments.length?(e="number"==typeof b?function(a){return mf(a,b)}:Bb(b),a):e},a.frequency=function(c){return arguments.length?(b=!!c,a):b},a},$g.layout.tree=function(){function a(a,f){function g(a,b){var d=a.children,e=a._tree;if(d&&(f=d.length)){for(var f,h,j,k=d[0],l=k,m=-1;++m<f;)j=d[m],g(j,h),l=i(j,h,l),h=j;wf(a);var n=.5*(k._tree.prelim+j._tree.prelim);b?(e.prelim=b._tree.prelim+c(a,b),e.mod=e.prelim-n):e.prelim=n}else b&&(e.prelim=b._tree.prelim+c(a,b))}function h(a,b){a.x=a._tree.prelim+b;var c=a.children;if(c&&(d=c.length)){var d,e=-1;for(b+=a._tree.mod;++e<d;)h(c[e],b)}}function i(a,b,d){if(b){for(var e,f=a,g=a,h=b,i=a.parent.children[0],j=f._tree.mod,k=g._tree.mod,l=h._tree.mod,m=i._tree.mod;h=qf(h),f=pf(f),h&&f;)i=pf(i),g=qf(g),g._tree.ancestor=a,e=h._tree.prelim+l-f._tree.prelim-j+c(h,f),e>0&&(xf(yf(h,a,d),a,e),j+=e,k+=e),l+=h._tree.mod,j+=f._tree.mod,m+=i._tree.mod,k+=g._tree.mod;h&&!qf(g)&&(g._tree.thread=h,g._tree.mod+=l-k),f&&!pf(i)&&(i._tree.thread=f,i._tree.mod+=j-m,d=a)}return d}var j=b.call(this,a,f),k=j[0];vf(k,function(a,b){a._tree={ancestor:a,prelim:0,mod:0,change:0,shift:0,number:b?b._tree.number+1:0}}),g(k),h(k,-k._tree.prelim);var l=rf(k,tf),m=rf(k,sf),n=rf(k,uf),o=l.x-c(l,m)/2,p=m.x+c(m,l)/2,q=n.depth||1;return vf(k,e?function(a){a.x*=d[0],a.y=a.depth*d[1],delete a._tree}:function(a){a.x=(a.x-o)/(p-o)*d[0],a.y=a.depth/q*d[1],delete a._tree}),j}var b=$g.layout.hierarchy().sort(null).value(null),c=of,d=[1,1],e=!1;return a.separation=function(b){return arguments.length?(c=b,a):c},a.size=function(b){return arguments.length?(e=null==(d=b),a):e?null:d},a.nodeSize=function(b){return arguments.length?(e=null!=(d=b),a):e?d:null},Ze(a,b)},$g.layout.pack=function(){function a(a,f){var g=c.call(this,a,f),h=g[0],i=e[0],j=e[1],k=null==b?Math.sqrt:"function"==typeof b?b:function(){return b};if(h.x=h.y=0,vf(h,function(a){a.r=+k(a.value)}),vf(h,Df),d){var l=d*(b?1:Math.max(2*h.r/i,2*h.r/j))/2;vf(h,function(a){a.r+=l}),vf(h,Df),vf(h,function(a){a.r-=l})}return Gf(h,i/2,j/2,b?1:1/Math.max(2*h.r/i,2*h.r/j)),g}var b,c=$g.layout.hierarchy().sort(zf),d=0,e=[1,1];return a.size=function(b){return arguments.length?(e=b,a):e},a.radius=function(c){return arguments.length?(b=null==c||"function"==typeof c?c:+c,a):b},a.padding=function(b){return arguments.length?(d=+b,a):d},Ze(a,c)},$g.layout.cluster=function(){function a(a,f){var g,h=b.call(this,a,f),i=h[0],j=0;vf(i,function(a){var b=a.children;b&&b.length?(a.x=Jf(b),a.y=If(b)):(a.x=g?j+=c(a,g):0,a.y=0,g=a)});var k=Kf(i),l=Lf(i),m=k.x-c(k,l)/2,n=l.x+c(l,k)/2;return vf(i,e?function(a){a.x=(a.x-i.x)*d[0],a.y=(i.y-a.y)*d[1]}:function(a){a.x=(a.x-m)/(n-m)*d[0],a.y=(1-(i.y?a.y/i.y:1))*d[1]}),h}var b=$g.layout.hierarchy().sort(null).value(null),c=of,d=[1,1],e=!1;return a.separation=function(b){return arguments.length?(c=b,a):c},a.size=function(b){return arguments.length?(e=null==(d=b),a):e?null:d},a.nodeSize=function(b){return arguments.length?(e=null!=(d=b),a):e?d:null},Ze(a,b)},$g.layout.treemap=function(){function a(a,b){for(var c,d,e=-1,f=a.length;++e<f;)d=(c=a[e]).value*(0>b?0:b),c.area=isNaN(d)||0>=d?0:d}function b(c){var f=c.children;if(f&&f.length){var g,h,i,j=l(c),k=[],m=f.slice(),o=1/0,p="slice"===n?j.dx:"dice"===n?j.dy:"slice-dice"===n?1&c.depth?j.dy:j.dx:Math.min(j.dx,j.dy);for(a(m,j.dx*j.dy/c.value),k.area=0;(i=m.length)>0;)k.push(g=m[i-1]),k.area+=g.area,"squarify"!==n||(h=d(k,p))<=o?(m.pop(),o=h):(k.area-=k.pop().area,e(k,p,j,!1),p=Math.min(j.dx,j.dy),k.length=k.area=0,o=1/0);k.length&&(e(k,p,j,!0),k.length=k.area=0),f.forEach(b)}}function c(b){var d=b.children;if(d&&d.length){var f,g=l(b),h=d.slice(),i=[];for(a(h,g.dx*g.dy/b.value),i.area=0;f=h.pop();)i.push(f),i.area+=f.area,null!=f.z&&(e(i,f.z?g.dx:g.dy,g,!h.length),i.length=i.area=0);d.forEach(c)}}function d(a,b){for(var c,d=a.area,e=0,f=1/0,g=-1,h=a.length;++g<h;)(c=a[g].area)&&(f>c&&(f=c),c>e&&(e=c));return d*=d,b*=b,d?Math.max(b*e*o/d,d/(b*f*o)):1/0}function e(a,b,c,d){var e,f=-1,g=a.length,h=c.x,j=c.y,k=b?i(a.area/b):0;if(b==c.dx){for((d||k>c.dy)&&(k=c.dy);++f<g;)e=a[f],e.x=h,e.y=j,e.dy=k,h+=e.dx=Math.min(c.x+c.dx-h,k?i(e.area/k):0);e.z=!0,e.dx+=c.x+c.dx-h,c.y+=k,c.dy-=k}else{for((d||k>c.dx)&&(k=c.dx);++f<g;)e=a[f],e.x=h,e.y=j,e.dx=k,j+=e.dy=Math.min(c.y+c.dy-j,k?i(e.area/k):0);e.z=!1,e.dy+=c.y+c.dy-j,c.x+=k,c.dx-=k}}function f(d){var e=g||h(d),f=e[0];return f.x=0,f.y=0,f.dx=j[0],f.dy=j[1],g&&h.revalue(f),a([f],f.dx*f.dy/f.value),(g?c:b)(f),m&&(g=e),e}var g,h=$g.layout.hierarchy(),i=Math.round,j=[1,1],k=null,l=Mf,m=!1,n="squarify",o=.5*(1+Math.sqrt(5));return f.size=function(a){return arguments.length?(j=a,f):j},f.padding=function(a){function b(b){var c=a.call(f,b,b.depth);return null==c?Mf(b):Nf(b,"number"==typeof c?[c,c,c,c]:c)}function c(b){return Nf(b,a)}if(!arguments.length)return k;var d;return l=null==(k=a)?Mf:"function"==(d=typeof a)?b:"number"===d?(a=[a,a,a,a],c):c,f},f.round=function(a){return arguments.length?(i=a?Math.round:Number,f):i!=Number},f.sticky=function(a){return arguments.length?(m=a,g=null,f):m},f.ratio=function(a){return arguments.length?(o=a,f):o},f.mode=function(a){return arguments.length?(n=a+"",f):n},Ze(f,h)},$g.random={normal:function(a,b){var c=arguments.length;return 2>c&&(b=1),1>c&&(a=0),function(){var c,d,e;do c=2*Math.random()-1,d=2*Math.random()-1,e=c*c+d*d;while(!e||e>1);return a+b*c*Math.sqrt(-2*Math.log(e)/e)}},logNormal:function(){var a=$g.random.normal.apply($g,arguments);return function(){return Math.exp(a())}},bates:function(a){var b=$g.random.irwinHall(a);return function(){return b()/a}},irwinHall:function(a){return function(){for(var b=0,c=0;a>c;c++)b+=Math.random();return b}}},$g.scale={};var pj={floor:Cb,ceil:Cb};$g.scale.linear=function(){return Uf([0,1],[0,1],re,!1)};var qj={s:1,g:1,p:1,r:1,e:1};$g.scale.log=function(){return ag($g.scale.linear().domain([0,1]),10,!0,[1,10])};var rj=$g.format(".0e"),sj={floor:function(a){return-Math.ceil(-a)},ceil:function(a){return-Math.floor(-a)}};$g.scale.pow=function(){return bg($g.scale.linear(),1,[0,1])},$g.scale.sqrt=function(){return $g.scale.pow().exponent(.5)},$g.scale.ordinal=function(){return dg([],{t:"range",a:[[]]})},$g.scale.category10=function(){return $g.scale.ordinal().range(tj)},$g.scale.category20=function(){return $g.scale.ordinal().range(uj)},$g.scale.category20b=function(){return $g.scale.ordinal().range(vj)},$g.scale.category20c=function(){return $g.scale.ordinal().range(wj)};var tj=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(sb),uj=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(sb),vj=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(sb),wj=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(sb);$g.scale.quantile=function(){return eg([],[])},$g.scale.quantize=function(){return fg(0,1,[0,1])},$g.scale.threshold=function(){return gg([.5],[0,1])},$g.scale.identity=function(){return hg([0,1])},$g.svg={},$g.svg.arc=function(){function a(){var a=b.apply(this,arguments),f=c.apply(this,arguments),g=d.apply(this,arguments)+xj,h=e.apply(this,arguments)+xj,i=(g>h&&(i=g,g=h,h=i),h-g),j=Dh>i?"0":"1",k=Math.cos(g),l=Math.sin(g),m=Math.cos(h),n=Math.sin(h);return i>=yj?a?"M0,"+f+"A"+f+","+f+" 0 1,1 0,"+-f+"A"+f+","+f+" 0 1,1 0,"+f+"M0,"+a+"A"+a+","+a+" 0 1,0 0,"+-a+"A"+a+","+a+" 0 1,0 0,"+a+"Z":"M0,"+f+"A"+f+","+f+" 0 1,1 0,"+-f+"A"+f+","+f+" 0 1,1 0,"+f+"Z":a?"M"+f*k+","+f*l+"A"+f+","+f+" 0 "+j+",1 "+f*m+","+f*n+"L"+a*m+","+a*n+"A"+a+","+a+" 0 "+j+",0 "+a*k+","+a*l+"Z":"M"+f*k+","+f*l+"A"+f+","+f+" 0 "+j+",1 "+f*m+","+f*n+"L0,0Z"}var b=ig,c=jg,d=kg,e=lg;return a.innerRadius=function(c){return arguments.length?(b=Bb(c),a):b},a.outerRadius=function(b){return arguments.length?(c=Bb(b),a):c},a.startAngle=function(b){return arguments.length?(d=Bb(b),a):d},a.endAngle=function(b){return arguments.length?(e=Bb(b),a):e},a.centroid=function(){var a=(b.apply(this,arguments)+c.apply(this,arguments))/2,f=(d.apply(this,arguments)+e.apply(this,arguments))/2+xj;return[Math.cos(f)*a,Math.sin(f)*a]},a};var xj=-Fh,yj=Eh-Gh;$g.svg.line=function(){return mg(Cb)};var zj=$g.map({linear:ng,"linear-closed":og,step:pg,"step-before":qg,"step-after":rg,basis:xg,"basis-open":yg,"basis-closed":zg,bundle:Ag,cardinal:ug,"cardinal-open":sg,"cardinal-closed":tg,monotone:Gg});zj.forEach(function(a,b){b.key=a,b.closed=/-closed$/.test(a)});var Aj=[0,2/3,1/3,0],Bj=[0,1/3,2/3,0],Cj=[0,1/6,2/3,1/6];$g.svg.line.radial=function(){var a=mg(Hg);return a.radius=a.x,delete a.x,a.angle=a.y,delete a.y,a},qg.reverse=rg,rg.reverse=qg,$g.svg.area=function(){return Ig(Cb)},$g.svg.area.radial=function(){var a=Ig(Hg);return a.radius=a.x,delete a.x,a.innerRadius=a.x0,delete a.x0,a.outerRadius=a.x1,delete a.x1,a.angle=a.y,delete a.y,a.startAngle=a.y0,delete a.y0,a.endAngle=a.y1,delete a.y1,a},$g.svg.chord=function(){function a(a,h){var i=b(this,f,a,h),j=b(this,g,a,h);return"M"+i.p0+d(i.r,i.p1,i.a1-i.a0)+(c(i,j)?e(i.r,i.p1,i.r,i.p0):e(i.r,i.p1,j.r,j.p0)+d(j.r,j.p1,j.a1-j.a0)+e(j.r,j.p1,i.r,i.p0))+"Z"}function b(a,b,c,d){var e=b.call(a,c,d),f=h.call(a,e,d),g=i.call(a,e,d)+xj,k=j.call(a,e,d)+xj;return{r:f,a0:g,a1:k,p0:[f*Math.cos(g),f*Math.sin(g)],p1:[f*Math.cos(k),f*Math.sin(k)]}}function c(a,b){return a.a0==b.a0&&a.a1==b.a1}function d(a,b,c){return"A"+a+","+a+" 0 "+ +(c>Dh)+",1 "+b}function e(a,b,c,d){return"Q 0,0 "+d}var f=sd,g=td,h=Jg,i=kg,j=lg;return a.radius=function(b){return arguments.length?(h=Bb(b),a):h},a.source=function(b){return arguments.length?(f=Bb(b),a):f},a.target=function(b){return arguments.length?(g=Bb(b),a):g},a.startAngle=function(b){return arguments.length?(i=Bb(b),a):i},a.endAngle=function(b){return arguments.length?(j=Bb(b),a):j},a},$g.svg.diagonal=function(){function a(a,e){var f=b.call(this,a,e),g=c.call(this,a,e),h=(f.y+g.y)/2,i=[f,{x:f.x,y:h},{x:g.x,y:h},g];return i=i.map(d),"M"+i[0]+"C"+i[1]+" "+i[2]+" "+i[3]}var b=sd,c=td,d=Kg;return a.source=function(c){return arguments.length?(b=Bb(c),a):b},a.target=function(b){return arguments.length?(c=Bb(b),a):c},a.projection=function(b){return arguments.length?(d=b,a):d},a},$g.svg.diagonal.radial=function(){var a=$g.svg.diagonal(),b=Kg,c=a.projection;return a.projection=function(a){return arguments.length?c(Lg(b=a)):b},a},$g.svg.symbol=function(){function a(a,d){return(Dj.get(b.call(this,a,d))||Og)(c.call(this,a,d))}var b=Ng,c=Mg;return a.type=function(c){return arguments.length?(b=Bb(c),a):b},a.size=function(b){return arguments.length?(c=Bb(b),a):c},a};var Dj=$g.map({circle:Og,cross:function(a){var b=Math.sqrt(a/5)/2;return"M"+-3*b+","+-b+"H"+-b+"V"+-3*b+"H"+b+"V"+-b+"H"+3*b+"V"+b+"H"+b+"V"+3*b+"H"+-b+"V"+b+"H"+-3*b+"Z"},diamond:function(a){var b=Math.sqrt(a/(2*Hj)),c=b*Hj;return"M0,"+-b+"L"+c+",0 0,"+b+" "+-c+",0Z"},square:function(a){var b=Math.sqrt(a)/2;return"M"+-b+","+-b+"L"+b+","+-b+" "+b+","+b+" "+-b+","+b+"Z"},"triangle-down":function(a){var b=Math.sqrt(a/Gj),c=b*Gj/2;return"M0,"+c+"L"+b+","+-c+" "+-b+","+-c+"Z"},"triangle-up":function(a){var b=Math.sqrt(a/Gj),c=b*Gj/2;return"M0,"+-c+"L"+b+","+c+" "+-b+","+c+"Z"}});$g.svg.symbolTypes=Dj.keys();var Ej,Fj,Gj=Math.sqrt(3),Hj=Math.tan(30*Ih),Ij=[],Jj=0;Ij.call=wh.call,Ij.empty=wh.empty,Ij.node=wh.node,Ij.size=wh.size,$g.transition=function(a){return arguments.length?Ej?a.transition():a:zh.transition()},$g.transition.prototype=Ij,Ij.select=function(a){var b,c,d,e=this.id,f=[];a=x(a);for(var g=-1,h=this.length;++g<h;){f.push(b=[]);for(var i=this[g],j=-1,k=i.length;++j<k;)(d=i[j])&&(c=a.call(d,d.__data__,j,g))?("__data__"in d&&(c.__data__=d.__data__),Sg(c,j,e,d.__transition__[e]),b.push(c)):b.push(null)}return Pg(f,e)},Ij.selectAll=function(a){var b,c,d,e,f,g=this.id,h=[];a=y(a);for(var i=-1,j=this.length;++i<j;)for(var k=this[i],l=-1,m=k.length;++l<m;)if(d=k[l]){f=d.__transition__[g],c=a.call(d,d.__data__,l,i),h.push(b=[]);for(var n=-1,o=c.length;++n<o;)(e=c[n])&&Sg(e,n,g,f),b.push(e)}return Pg(h,g)},Ij.filter=function(a){var b,c,d,e=[];"function"!=typeof a&&(a=J(a));for(var f=0,g=this.length;g>f;f++){e.push(b=[]);for(var c=this[f],h=0,i=c.length;i>h;h++)(d=c[h])&&a.call(d,d.__data__,h,f)&&b.push(d)}return Pg(e,this.id)},Ij.tween=function(a,b){var c=this.id;return arguments.length<2?this.node().__transition__[c].tween.get(a):L(this,null==b?function(b){b.__transition__[c].tween.remove(a)}:function(d){d.__transition__[c].tween.set(a,b)})},Ij.attr=function(a,b){function c(){this.removeAttribute(h)}function d(){this.removeAttributeNS(h.space,h.local)}function e(a){return null==a?c:(a+="",function(){var b,c=this.getAttribute(h);return c!==a&&(b=g(c,a),function(a){this.setAttribute(h,b(a))})})}function f(a){return null==a?d:(a+="",function(){var b,c=this.getAttributeNS(h.space,h.local);return c!==a&&(b=g(c,a),function(a){this.setAttributeNS(h.space,h.local,b(a))})})}if(arguments.length<2){for(b in a)this.attr(b,a[b]);return this}var g="transform"==a?Oe:re,h=$g.ns.qualify(a);return Qg(this,"attr."+a,b,h.local?f:e)},Ij.attrTween=function(a,b){function c(a,c){var d=b.call(this,a,c,this.getAttribute(e));return d&&function(a){this.setAttribute(e,d(a))}}function d(a,c){var d=b.call(this,a,c,this.getAttributeNS(e.space,e.local));return d&&function(a){this.setAttributeNS(e.space,e.local,d(a))}}var e=$g.ns.qualify(a);return this.tween("attr."+a,e.local?d:c)},Ij.style=function(a,b,c){function d(){this.style.removeProperty(a)}function e(b){return null==b?d:(b+="",function(){var d,e=dh.getComputedStyle(this,null).getPropertyValue(a);return e!==b&&(d=re(e,b),function(b){this.style.setProperty(a,d(b),c)})})}var f=arguments.length;if(3>f){if("string"!=typeof a){2>f&&(b="");for(c in a)this.style(c,a[c],b);return this}c=""}return Qg(this,"style."+a,b,e)},Ij.styleTween=function(a,b,c){function d(d,e){var f=b.call(this,d,e,dh.getComputedStyle(this,null).getPropertyValue(a));return f&&function(b){this.style.setProperty(a,f(b),c)}}return arguments.length<3&&(c=""),this.tween("style."+a,d)},Ij.text=function(a){return Qg(this,"text",a,Rg)},Ij.remove=function(){return this.each("end.transition",function(){var a;this.__transition__.count<2&&(a=this.parentNode)&&a.removeChild(this)})},Ij.ease=function(a){var b=this.id;return arguments.length<1?this.node().__transition__[b].ease:("function"!=typeof a&&(a=$g.ease.apply($g,arguments)),L(this,function(c){c.__transition__[b].ease=a}))},Ij.delay=function(a){var b=this.id;return arguments.length<1?this.node().__transition__[b].delay:L(this,"function"==typeof a?function(c,d,e){c.__transition__[b].delay=+a.call(c,c.__data__,d,e)}:(a=+a,function(c){c.__transition__[b].delay=a}))},Ij.duration=function(a){var b=this.id;return arguments.length<1?this.node().__transition__[b].duration:L(this,"function"==typeof a?function(c,d,e){c.__transition__[b].duration=Math.max(1,a.call(c,c.__data__,d,e))}:(a=Math.max(1,a),function(c){c.__transition__[b].duration=a}))},Ij.each=function(a,b){var c=this.id;if(arguments.length<2){var d=Fj,e=Ej;Ej=c,L(this,function(b,d,e){Fj=b.__transition__[c],a.call(b,b.__data__,d,e)}),Fj=d,Ej=e}else L(this,function(d){var e=d.__transition__[c];(e.event||(e.event=$g.dispatch("start","end"))).on(a,b)});return this},Ij.transition=function(){for(var a,b,c,d,e=this.id,f=++Jj,g=[],h=0,i=this.length;i>h;h++){g.push(a=[]);for(var b=this[h],j=0,k=b.length;k>j;j++)(c=b[j])&&(d=Object.create(c.__transition__[e]),d.delay+=d.duration,Sg(c,j,f,d)),a.push(c)}return Pg(g,f)},$g.svg.axis=function(){function a(a){a.each(function(){var a,j=$g.select(this),k=this.__chart__||c,l=this.__chart__=c.copy(),m=null==i?l.ticks?l.ticks.apply(l,h):l.domain():i,n=null==b?l.tickFormat?l.tickFormat.apply(l,h):Cb:b,o=j.selectAll(".tick").data(m,l),p=o.enter().insert("g",".domain").attr("class","tick").style("opacity",Gh),q=$g.transition(o.exit()).style("opacity",Gh).remove(),r=$g.transition(o.order()).style("opacity",1),s=Pf(l),t=j.selectAll(".domain").data([0]),u=(t.enter().append("path").attr("class","domain"),$g.transition(t));p.append("line"),p.append("text");var v=p.select("line"),w=r.select("line"),x=o.select("text").text(n),y=p.select("text"),z=r.select("text");switch(d){case"bottom":a=Tg,v.attr("y2",e),y.attr("y",Math.max(e,0)+g),w.attr("x2",0).attr("y2",e),z.attr("x",0).attr("y",Math.max(e,0)+g),x.attr("dy",".71em").style("text-anchor","middle"),u.attr("d","M"+s[0]+","+f+"V0H"+s[1]+"V"+f);break;case"top":a=Tg,v.attr("y2",-e),y.attr("y",-(Math.max(e,0)+g)),w.attr("x2",0).attr("y2",-e),z.attr("x",0).attr("y",-(Math.max(e,0)+g)),x.attr("dy","0em").style("text-anchor","middle"),u.attr("d","M"+s[0]+","+-f+"V0H"+s[1]+"V"+-f);break;case"left":a=Ug,v.attr("x2",-e),y.attr("x",-(Math.max(e,0)+g)),w.attr("x2",-e).attr("y2",0),z.attr("x",-(Math.max(e,0)+g)).attr("y",0),x.attr("dy",".32em").style("text-anchor","end"),u.attr("d","M"+-f+","+s[0]+"H0V"+s[1]+"H"+-f);break;case"right":a=Ug,v.attr("x2",e),y.attr("x",Math.max(e,0)+g),w.attr("x2",e).attr("y2",0),z.attr("x",Math.max(e,0)+g).attr("y",0),x.attr("dy",".32em").style("text-anchor","start"),u.attr("d","M"+f+","+s[0]+"H0V"+s[1]+"H"+f)}if(l.rangeBand){var A=l,B=A.rangeBand()/2;k=l=function(a){return A(a)+B}}else k.rangeBand?k=l:q.call(a,l);p.call(a,k),r.call(a,l)})}var b,c=$g.scale.linear(),d=Kj,e=6,f=6,g=3,h=[10],i=null;return a.scale=function(b){return arguments.length?(c=b,a):c},a.orient=function(b){return arguments.length?(d=b in Lj?b+"":Kj,a):d},a.ticks=function(){return arguments.length?(h=arguments,a):h},a.tickValues=function(b){return arguments.length?(i=b,a):i},a.tickFormat=function(c){return arguments.length?(b=c,a):b},a.tickSize=function(b){var c=arguments.length;return c?(e=+b,f=+arguments[c-1],a):e},a.innerTickSize=function(b){return arguments.length?(e=+b,a):e},a.outerTickSize=function(b){return arguments.length?(f=+b,a):f},a.tickPadding=function(b){return arguments.length?(g=+b,a):g},a.tickSubdivide=function(){return arguments.length&&a},a};var Kj="bottom",Lj={top:1,right:1,bottom:1,left:1};$g.svg.brush=function(){function a(f){f.each(function(){var f=$g.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",e).on("touchstart.brush",e),g=f.selectAll(".background").data([0]);g.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),f.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var h=f.selectAll(".resize").data(o,Cb);h.exit().remove(),h.enter().append("g").attr("class",function(a){return"resize "+a}).style("cursor",function(a){return Mj[a]}).append("rect").attr("x",function(a){return/[ew]$/.test(a)?-3:null}).attr("y",function(a){return/^[ns]/.test(a)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),h.style("display",a.empty()?"none":null);var k,l=$g.transition(f),m=$g.transition(g);i&&(k=Pf(i),m.attr("x",k[0]).attr("width",k[1]-k[0]),c(l)),j&&(k=Pf(j),m.attr("y",k[0]).attr("height",k[1]-k[0]),d(l)),b(l)})}function b(a){a.selectAll(".resize").attr("transform",function(a){return"translate("+k[+/e$/.test(a)]+","+l[+/^s/.test(a)]+")"})}function c(a){a.select(".extent").attr("x",k[0]),a.selectAll(".extent,.n>rect,.s>rect").attr("width",k[1]-k[0])}function d(a){a.select(".extent").attr("y",l[0]),a.selectAll(".extent,.e>rect,.w>rect").attr("height",l[1]-l[0])}function e(){function e(){32==$g.event.keyCode&&(C||(s=null,E[0]-=k[1],E[1]-=l[1],C=2),t())}function o(){32==$g.event.keyCode&&2==C&&(E[0]+=k[1],E[1]+=l[1],C=0,t())}function p(){var a=$g.mouse(v),e=!1;u&&(a[0]+=u[0],a[1]+=u[1]),C||($g.event.altKey?(s||(s=[(k[0]+k[1])/2,(l[0]+l[1])/2]),E[0]=k[+(a[0]<s[0])],E[1]=l[+(a[1]<s[1])]):s=null),A&&q(a,i,0)&&(c(y),e=!0),B&&q(a,j,1)&&(d(y),e=!0),e&&(b(y),x({type:"brush",mode:C?"move":"resize"}))}function q(a,b,c){var d,e,h=Pf(b),i=h[0],j=h[1],o=E[c],p=c?l:k,q=p[1]-p[0];return C&&(i-=o,j-=q+o),d=(c?n:m)?Math.max(i,Math.min(j,a[c])):a[c],C?e=(d+=o)+q:(s&&(o=Math.max(i,Math.min(j,2*s[c]-d))),d>o?(e=d,d=o):e=o),p[0]!=d||p[1]!=e?(c?g=null:f=null,p[0]=d,p[1]=e,!0):void 0}function r(){p(),y.style("pointer-events","all").selectAll(".resize").style("display",a.empty()?"none":null),$g.select("body").style("cursor",null),F.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),D(),x({type:"brushend"})}var s,u,v=this,w=$g.select($g.event.target),x=h.of(v,arguments),y=$g.select(v),z=w.datum(),A=!/^(n|s)$/.test(z)&&i,B=!/^(e|w)$/.test(z)&&j,C=w.classed("extent"),D=S(),E=$g.mouse(v),F=$g.select(dh).on("keydown.brush",e).on("keyup.brush",o);if($g.event.changedTouches?F.on("touchmove.brush",p).on("touchend.brush",r):F.on("mousemove.brush",p).on("mouseup.brush",r),y.interrupt().selectAll("*").interrupt(),C)E[0]=k[0]-E[0],E[1]=l[0]-E[1];else if(z){var G=+/w$/.test(z),H=+/^n/.test(z);u=[k[1-G]-E[0],l[1-H]-E[1]],E[0]=k[G],E[1]=l[H]}else $g.event.altKey&&(s=E.slice());y.style("pointer-events","none").selectAll(".resize").style("display",null),$g.select("body").style("cursor",w.style("cursor")),x({type:"brushstart"}),p()}var f,g,h=v(a,"brushstart","brush","brushend"),i=null,j=null,k=[0,0],l=[0,0],m=!0,n=!0,o=Nj[0];return a.event=function(a){a.each(function(){var a=h.of(this,arguments),b={x:k,y:l,i:f,j:g},c=this.__chart__||b;this.__chart__=b,Ej?$g.select(this).transition().each("start.brush",function(){f=c.i,g=c.j,k=c.x,l=c.y,a({type:"brushstart"})}).tween("brush:brush",function(){var c=se(k,b.x),d=se(l,b.y);return f=g=null,function(e){k=b.x=c(e),l=b.y=d(e),a({type:"brush",mode:"resize"})}}).each("end.brush",function(){f=b.i,g=b.j,a({type:"brush",mode:"resize"}),a({type:"brushend"})}):(a({type:"brushstart"}),a({type:"brush",mode:"resize"}),a({type:"brushend"}))})},a.x=function(b){return arguments.length?(i=b,o=Nj[!i<<1|!j],a):i},a.y=function(b){return arguments.length?(j=b,o=Nj[!i<<1|!j],a):j},a.clamp=function(b){return arguments.length?(i&&j?(m=!!b[0],n=!!b[1]):i?m=!!b:j&&(n=!!b),a):i&&j?[m,n]:i?m:j?n:null},a.extent=function(b){var c,d,e,h,m;return arguments.length?(i&&(c=b[0],d=b[1],j&&(c=c[0],d=d[0]),f=[c,d],i.invert&&(c=i(c),d=i(d)),c>d&&(m=c,c=d,d=m),(c!=k[0]||d!=k[1])&&(k=[c,d])),j&&(e=b[0],h=b[1],i&&(e=e[1],h=h[1]),g=[e,h],j.invert&&(e=j(e),h=j(h)),e>h&&(m=e,e=h,h=m),(e!=l[0]||h!=l[1])&&(l=[e,h])),a):(i&&(f?(c=f[0],d=f[1]):(c=k[0],d=k[1],i.invert&&(c=i.invert(c),d=i.invert(d)),c>d&&(m=c,c=d,d=m))),j&&(g?(e=g[0],h=g[1]):(e=l[0],h=l[1],j.invert&&(e=j.invert(e),h=j.invert(h)),e>h&&(m=e,e=h,h=m))),i&&j?[[c,e],[d,h]]:i?[c,d]:j&&[e,h])},a.clear=function(){return a.empty()||(k=[0,0],l=[0,0],f=g=null),a},a.empty=function(){return!!i&&k[0]==k[1]||!!j&&l[0]==l[1]},$g.rebind(a,h,"on")};var Mj={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},Nj=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],Oj=gi.format=mi.timeFormat,Pj=Oj.utc,Qj=Pj("%Y-%m-%dT%H:%M:%S.%LZ");Oj.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?Vg:Qj,Vg.parse=function(a){var b=new Date(a);return isNaN(b)?null:b},Vg.toString=Qj.toString,gi.second=Ob(function(a){return new hi(1e3*Math.floor(a/1e3))},function(a,b){a.setTime(a.getTime()+1e3*Math.floor(b))},function(a){return a.getSeconds()}),gi.seconds=gi.second.range,gi.seconds.utc=gi.second.utc.range,gi.minute=Ob(function(a){return new hi(6e4*Math.floor(a/6e4))},function(a,b){a.setTime(a.getTime()+6e4*Math.floor(b))},function(a){return a.getMinutes()}),gi.minutes=gi.minute.range,gi.minutes.utc=gi.minute.utc.range,gi.hour=Ob(function(a){var b=a.getTimezoneOffset()/60;return new hi(36e5*(Math.floor(a/36e5-b)+b))},function(a,b){a.setTime(a.getTime()+36e5*Math.floor(b))},function(a){return a.getHours()}),gi.hours=gi.hour.range,gi.hours.utc=gi.hour.utc.range,gi.month=Ob(function(a){return a=gi.day(a),a.setDate(1),a},function(a,b){a.setMonth(a.getMonth()+b)},function(a){return a.getMonth()}),gi.months=gi.month.range,gi.months.utc=gi.month.utc.range;var Rj=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],Sj=[[gi.second,1],[gi.second,5],[gi.second,15],[gi.second,30],[gi.minute,1],[gi.minute,5],[gi.minute,15],[gi.minute,30],[gi.hour,1],[gi.hour,3],[gi.hour,6],[gi.hour,12],[gi.day,1],[gi.day,2],[gi.week,1],[gi.month,1],[gi.month,3],[gi.year,1]],Tj=Oj.multi([[".%L",function(a){return a.getMilliseconds()}],[":%S",function(a){return a.getSeconds()}],["%I:%M",function(a){return a.getMinutes()}],["%I %p",function(a){return a.getHours()}],["%a %d",function(a){return a.getDay()&&1!=a.getDate()}],["%b %d",function(a){return 1!=a.getDate()}],["%B",function(a){return a.getMonth()}],["%Y",Cc]]),Uj={range:function(a,b,c){return $g.range(Math.ceil(a/c)*c,+b,c).map(Xg)},floor:Cb,ceil:Cb};Sj.year=gi.year,gi.scale=function(){return Wg($g.scale.linear(),Sj,Tj)};var Vj=Sj.map(function(a){return[a[0].utc,a[1]]}),Wj=Pj.multi([[".%L",function(a){return a.getUTCMilliseconds()}],[":%S",function(a){return a.getUTCSeconds()}],["%I:%M",function(a){return a.getUTCMinutes()}],["%I %p",function(a){return a.getUTCHours()}],["%a %d",function(a){return a.getUTCDay()&&1!=a.getUTCDate()}],["%b %d",function(a){return 1!=a.getUTCDate()}],["%B",function(a){return a.getUTCMonth()}],["%Y",Cc]]);Vj.year=gi.year.utc,gi.scale.utc=function(){return Wg($g.scale.linear(),Vj,Wj)},$g.text=Db(function(a){return a.responseText}),$g.json=function(a,b){return Eb(a,"application/json",Yg,b)},$g.html=function(a,b){return Eb(a,"text/html",Zg,b)},$g.xml=Db(function(a){return a.responseXML}),"function"==typeof define&&define.amd?define($g):"object"==typeof b&&b.exports?b.exports=$g:this.d3=$g}()},{}],20:[function(a,b){b.exports.Dispatcher=a("./lib/Dispatcher")},{"./lib/Dispatcher":21}],21:[function(a,b){"use strict";function c(){this.$Dispatcher_callbacks={},this.$Dispatcher_isPending={},this.$Dispatcher_isHandled={},this.$Dispatcher_isDispatching=!1,this.$Dispatcher_pendingPayload=null}var d=a("./invariant"),e=1,f="ID_";c.prototype.register=function(a){var b=f+e++;return this.$Dispatcher_callbacks[b]=a,b},c.prototype.unregister=function(a){d(this.$Dispatcher_callbacks[a],"Dispatcher.unregister(...): `%s` does not map to a registered callback.",a),delete this.$Dispatcher_callbacks[a]},c.prototype.waitFor=function(a){d(this.$Dispatcher_isDispatching,"Dispatcher.waitFor(...): Must be invoked while dispatching.");for(var b=0;b<a.length;b++){var c=a[b];this.$Dispatcher_isPending[c]?d(this.$Dispatcher_isHandled[c],"Dispatcher.waitFor(...): Circular dependency detected while waiting for `%s`.",c):(d(this.$Dispatcher_callbacks[c],"Dispatcher.waitFor(...): `%s` does not map to a registered callback.",c),this.$Dispatcher_invokeCallback(c))}},c.prototype.dispatch=function(a){d(!this.$Dispatcher_isDispatching,"Dispatch.dispatch(...): Cannot dispatch in the middle of a dispatch."),this.$Dispatcher_startDispatching(a);try{for(var b in this.$Dispatcher_callbacks)this.$Dispatcher_isPending[b]||this.$Dispatcher_invokeCallback(b)}catch(c){console.error(c.stack)}finally{this.$Dispatcher_stopDispatching()}},c.prototype.isDispatching=function(){return this.$Dispatcher_isDispatching},c.prototype.$Dispatcher_invokeCallback=function(a){this.$Dispatcher_isPending[a]=!0,this.$Dispatcher_callbacks[a](this.$Dispatcher_pendingPayload),this.$Dispatcher_isHandled[a]=!0},c.prototype.$Dispatcher_startDispatching=function(a){for(var b in this.$Dispatcher_callbacks)this.$Dispatcher_isPending[b]=!1,this.$Dispatcher_isHandled[b]=!1;
this.$Dispatcher_pendingPayload=a,this.$Dispatcher_isDispatching=!0},c.prototype.$Dispatcher_stopDispatching=function(){this.$Dispatcher_pendingPayload=null,this.$Dispatcher_isDispatching=!1},b.exports=c},{"./invariant":22}],22:[function(a,b){"use strict";var c=function(a,b,c,d,e,f,g,h){if(!a){var i;if(void 0===b)i=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var j=[c,d,e,f,g,h],k=0;i=new Error("Invariant Violation: "+b.replace(/%s/g,function(){return j[k++]}))}throw i.framesToPop=1,i}};b.exports=c},{}],23:[function(a,b){!function(c,d){"use strict";if("undefined"!=typeof b&&b.exports&&"function"==typeof a)d(a("ractive"));else if("function"==typeof define&&define.amd)define(["ractive"],d);else{if(!c.Ractive)throw new Error("Could not find Ractive! It must be loaded before the ractive-events-tap plugin");d(c.Ractive)}}("undefined"!=typeof window?window:this,function(a){"use strict";var b=function(a,b){var c,d,e,f,g,h,i;return f=5,g=400,c=function(c){var d,e,i,j,k,l,m;h||(void 0===c.which||1===c.which)&&(e=c.clientX,i=c.clientY,d=this,j=c.pointerId,k=function(a){a.pointerId==j&&(b({node:d,original:a}),m())},l=function(a){a.pointerId==j&&(Math.abs(a.clientX-e)>=f||Math.abs(a.clientY-i)>=f)&&m()},m=function(){a.removeEventListener("MSPointerUp",k,!1),document.removeEventListener("MSPointerMove",l,!1),document.removeEventListener("MSPointerCancel",m,!1),a.removeEventListener("pointerup",k,!1),document.removeEventListener("pointermove",l,!1),document.removeEventListener("pointercancel",m,!1),a.removeEventListener("click",k,!1),document.removeEventListener("mousemove",l,!1)},window.navigator.pointerEnabled?(a.addEventListener("pointerup",k,!1),document.addEventListener("pointermove",l,!1),document.addEventListener("pointercancel",m,!1)):window.navigator.msPointerEnabled?(a.addEventListener("MSPointerUp",k,!1),document.addEventListener("MSPointerMove",l,!1),document.addEventListener("MSPointerCancel",m,!1)):(a.addEventListener("click",k,!1),document.addEventListener("mousemove",l,!1)),setTimeout(m,g))},window.navigator.pointerEnabled?a.addEventListener("pointerdown",c,!1):window.navigator.msPointerEnabled?a.addEventListener("MSPointerDown",c,!1):a.addEventListener("mousedown",c,!1),d=function(c){var d,e,j,k,l,m,n,o;1===c.touches.length&&(k=c.touches[0],e=k.clientX,j=k.clientY,d=this,l=k.identifier,n=function(a){var c;c=a.changedTouches[0],c.identifier!==l&&o(),a.preventDefault(),h=!0,clearTimeout(i),i=setTimeout(function(){h=!1},400),b({node:d,original:a}),o()},m=function(a){var b;(1!==a.touches.length||a.touches[0].identifier!==l)&&o(),b=a.touches[0],(Math.abs(b.clientX-e)>=f||Math.abs(b.clientY-j)>=f)&&o()},o=function(){a.removeEventListener("touchend",n,!1),window.removeEventListener("touchmove",m,!1),window.removeEventListener("touchcancel",o,!1)},a.addEventListener("touchend",n,!1),window.addEventListener("touchmove",m,!1),window.addEventListener("touchcancel",o,!1),setTimeout(o,g))},a.addEventListener("touchstart",d,!1),("BUTTON"===a.tagName||"button"===a.type)&&(e=function(){var c,d;d=function(c){32===c.which&&b({node:a,original:c})},c=function(){a.removeEventListener("keydown",d,!1),a.removeEventListener("blur",c,!1)},a.addEventListener("keydown",d,!1),a.addEventListener("blur",c,!1)},a.addEventListener("focus",e,!1)),{teardown:function(){a.removeEventListener("pointerdown",c,!1),a.removeEventListener("MSPointerDown",c,!1),a.removeEventListener("mousedown",c,!1),a.removeEventListener("touchstart",d,!1),a.removeEventListener("focus",e,!1)}}};a.events.tap=b})},{ractive:50}],24:[function(a,b){function c(a){a=a||{},j=e(a),a.start&&(j.start=new Date(a.start)),a.end&&(j.end=new Date(a.end))}var d=a("underscore").extend,e=a("underscore").clone,f=a("events").EventEmitter,g=a("../dispatcher/dispatcher"),h=a("../constants/constants").Payload,i=a("../constants/constants").ActionTypes,j=(a("../stores/services"),{}),k=d(new f,{getState:function(){return e(j)},emitChange:function(){this.emit("change")},addChangeListener:function(a){this.on("change",a)}});k.dispatchToken=g.register(function(a){var b=a.source,d=a.action;switch(d.type){case i.RECEIVE_INITIAL_STATE:console.log("Announcer: ",d.type,d.state),c(d.state.announcer),k.emitChange();break;case i.ANNOUNCER:console.log("Announcer: ",d.type,d.state),b===h.SERVER_ACTION?(console.log("Announcer: SERVER",d.type,d.state),c(d.state.data),k.emitChange()):(console.log("Announcer: VIEW ACTION pre",j.isAnnouncing),j.isAnnouncing=!j.isAnnouncing,console.log("Announcer: VIEW ACTION post",j.isAnnouncing),k.emitChange())}}),b.exports=k},{"../constants/constants":17,"../dispatcher/dispatcher":18,"../stores/services":32,events:37,underscore:51}],25:[function(a,b){var c=a("underscore").extend,d=a("underscore").clone,e=a("events").EventEmitter,f=a("../dispatcher/dispatcher"),g=a("../constants/constants").Payload,h=a("../constants/constants").ActionTypes,i={volume:null},j=c(new e,{getState:function(){return d(i)},emitChange:function(){this.emit("change")},addChangeListener:function(a){this.on("change",a)}});j.dispatchToken=f.register(function(a){var b=a.source,c=a.action;switch(c.type){case h.RECEIVE_INITIAL_STATE:i=c.state.audio,j.emitChange();break;case h.AUDIO:b===g.SERVER_ACTION?(console.log("Audio: SERVER",c.type,c.state),i=c.state.data):(console.log("Audio: CHANGE",c.type,c.state),i.volume=c.state.volume),j.emitChange()}}),b.exports=j},{"../constants/constants":17,"../dispatcher/dispatcher":18,events:37,underscore:51}],26:[function(a,b){function c(a){j=e(a),a.start&&(j.start=new Date(a.start)),a.end&&(j.end=new Date(a.end))}var d=a("underscore").extend,e=a("underscore").clone,f=a("events").EventEmitter,g=a("../dispatcher/dispatcher"),h=a("../constants/constants").Payload,i=a("../constants/constants").ActionTypes,j=(a("../stores/services"),{}),k=d(new f,{getState:function(){return e(j)},emitChange:function(){this.emit("change")},addChangeListener:function(a){this.on("change",a)}});k.dispatchToken=g.register(function(a){var b=a.source,d=a.action;switch(d.type){case i.RECEIVE_INITIAL_STATE:console.log("Avoider: ",d.type,d.state),c(d.state.avoider),k.emitChange();break;case i.AVOIDER:console.log("Avoider: ",d.type,d.state),b===h.SERVER_ACTION?(console.log("Avoider: SERVER",d.type,d.state),c(d.state.data),k.emitChange()):(console.log("Avoider: VIEW ACTION pre",j.isAvoiding),j.isAvoiding=!j.isAvoiding,console.log("Avoider: VIEW ACTION post",j.isAvoiding),k.emitChange());break;case i.RECEIVE_AVOIDER_SETTINGS:console.log("Avoider Settings: ",d.type,d.state),b===h.SERVER_ACTION&&(console.log("Avoider: SERVER",d.type,d.state),j.settings=e(d.state),k.emitChange());break;case i.SETTINGS:b===h.SERVER_ACTION&&"settings.avoider"===d.state.topic&&(console.log("Avoider: SERVER",d.type,d.state),j.settings=e(d.state.data),k.emitChange())}}),b.exports=k},{"../constants/constants":17,"../dispatcher/dispatcher":18,"../stores/services":32,events:37,underscore:51}],27:[function(a,b){var c=a("underscore").extend,d=(a("underscore").clone,a("events").EventEmitter),e=a("../dispatcher/dispatcher"),f=a("../constants/constants").Payload,g=a("../constants/constants").ActionTypes,h=a("../stores/services"),i=null,j=c(new d,{getCurrentId:function(){return i},getCurrent:function(){return h.getService(i)},emitChange:function(){this.emit("change")},addChangeListener:function(a){this.on("change",a)}});j.dispatchToken=e.register(function(a){var b=a.source,c=a.action;switch(c.type){case g.RECEIVE_INITIAL_STATE:console.log("CurrentService: ",c.type,c.state),i=c.state.current?c.state.current.id:null,j.emitChange();break;case g.SERVICE:console.log("CurrentService: ",c.type,c.state),b===f.SERVER_ACTION&&"service.changed"===c.state.topic?(console.log("CurrentService: SERVER",c.type,c.state),i=c.state.data?c.state.data.id:null):console.log("CurrentService: CHANGE",c.type,c.state),j.emitChange()}}),b.exports=j},{"../constants/constants":17,"../dispatcher/dispatcher":18,"../stores/services":32,events:37,underscore:51}],28:[function(a,b){function c(a,b){console.log("NowAndNext update",a,b),k[a]=b}var d=a("underscore").extend,e=a("underscore").clone,f=a("events").EventEmitter,g=a("../dispatcher/dispatcher"),h=a("../stores/current-service"),i=a("../constants/constants").Payload,j=a("../constants/constants").ActionTypes,k={},l=d(new f,{get:function(a){return k[a]?e(k[a]):void 0},emitChange:function(a){this.emit("change",a)},addChangeListener:function(a){this.on("change",a)}});l.dispatchToken=g.register(function(a){var b=a.source,d=a.action;switch(d.type){case j.RECEIVE_INITIAL_STATE:g.waitFor([h.dispatchToken]),console.log("NowAndNext",d.type,d.state),d.state.current&&d.state.current.nowAndNext&&(c(d.state.current.id,d.state.current.nowAndNext),l.emitChange(d.state.current.id));break;case j.SERVICE:console.log("NowAndNext: ",d.type,d.state),b===i.SERVER_ACTION&&(g.waitFor([h.dispatchToken]),console.log("NowAndNext: SERVER",d.type,d.state),d.state.data&&d.state.data.nowAndNext&&(c(d.state.data.id,d.state.data.nowAndNext),l.emitChange(d.state.data.id)));break;case j.NOW_AND_NEXT:console.log("NowAndNext: ",d.type,d.state),b===i.SERVER_ACTION&&(console.log("NowAndNext: SERVER",d.type,d.state),d.state.service&&d.state.data&&(c(d.state.service,d.state.data),l.emitChange(d.state.service)))}}),b.exports=l},{"../constants/constants":17,"../dispatcher/dispatcher":18,"../stores/current-service":27,events:37,underscore:51}],29:[function(a,b){function c(a,b){console.log("NowPlaying update",a,b),k[a]=b}var d=a("underscore").extend,e=a("underscore").clone,f=a("events").EventEmitter,g=a("../dispatcher/dispatcher"),h=a("../stores/current-service"),i=a("../constants/constants").Payload,j=a("../constants/constants").ActionTypes,k={},l=d(new f,{get:function(a){return k[a]?e(k[a]):void 0},emitChange:function(a){this.emit("change",a)},addChangeListener:function(a){this.on("change",a)}});l.dispatchToken=g.register(function(a){var b=a.source,d=a.action;switch(d.type){case j.RECEIVE_INITIAL_STATE:g.waitFor([h.dispatchToken]),console.log("NowPlaying",d.type,d.state),d.state.current&&d.state.current.nowPlaying&&(c(d.state.current.id,d.state.current.nowPlaying),l.emitChange(d.state.current.id));break;case j.SERVICE:console.log("NowPlaying: ",d.type,d.state),b===i.SERVER_ACTION&&"service.changed"===d.state.topic&&(g.waitFor([h.dispatchToken]),console.log("NowPlaying: SERVER",d.type,d.state),d.state.data&&d.state.data.nowPlaying&&(c(d.state.data.id,d.state.data.nowPlaying),l.emitChange(d.state.data.id)));break;case j.NOW_PLAYING:console.log("NowPlaying: ",d.type,d.state),b===i.SERVER_ACTION&&(console.log("NowPlaying: SERVER",d.type,d.state),d.state.service&&d.state.data&&(c(d.state.service,d.state.data),l.emitChange(d.state.service)))}}),b.exports=l},{"../constants/constants":17,"../dispatcher/dispatcher":18,"../stores/current-service":27,events:37,underscore:51}],30:[function(a,b){var c=a("underscore").extend,d=a("underscore").clone,e=a("events").EventEmitter,f=a("../dispatcher/dispatcher"),g=a("../constants/constants").ActionTypes,h=a("../constants/constants").Payload,i={isOn:null},j=c(new e,{getState:function(){return d(i)},emitChange:function(){this.emit("change")},addChangeListener:function(a){this.on("change",a)}});j.dispatchToken=f.register(function(a){var b=a.source,c=a.action;switch(c.type){case g.RECEIVE_INITIAL_STATE:console.log("Power: RECEIVE_INITIAL_STATE",c.type,c.state.power),i=c.state.power,j.emitChange();break;case g.POWER:b===h.SERVER_ACTION?(console.log("Power: SERVER",c.type,c.state.data),i=c.state.data):i.isOn=!i.isOn,j.emitChange()}}),b.exports=j},{"../constants/constants":17,"../dispatcher/dispatcher":18,events:37,underscore:51}],31:[function(a,b){var c=a("underscore").extend,d=a("underscore").clone,e=a("underscore").without,f=a("events").EventEmitter,g=a("../dispatcher/dispatcher"),h=a("../constants/constants").Payload,i=a("../constants/constants").ActionTypes,j=(a("../stores/services"),{}),k=c(new f,{togglePreferredService:function(a){j.preferredServices&&j.preferredServices.indexOf(a)>-1?j.preferredServices=e(j.preferredServices,a):j.preferredServices.push(a)},getState:function(){return d(j)},emitChange:function(){this.emit("change")},addChangeListener:function(a){this.on("change",a)}});k.dispatchToken=g.register(function(a){var b=a.source,c=a.action;switch(c.type){case i.RECEIVE_RADIO_SETTINGS:console.log("Radio Settings: ",c.type,c.state),b===h.SERVER_ACTION&&(console.log("Radio Settings: SERVER",c.type,c.state),j=d(c.state),k.emitChange());break;case i.SETTINGS:b===h.SERVER_ACTION&&"settings.radio"===c.state.topic&&(console.log("Radio Settings: SERVER",c.type,c.state),j=d(c.state.data),k.emitChange())}}),b.exports=k},{"../constants/constants":17,"../dispatcher/dispatcher":18,"../stores/services":32,events:37,underscore:51}],32:[function(a,b){function c(a){a.id&&(i[a.id]=a)}var d=a("underscore").extend,e=a("underscore").clone,f=a("events").EventEmitter,g=a("../dispatcher/dispatcher"),h=a("../constants/constants").ActionTypes,i={},j=d(new f,{getAllServicesAsArray:function(){return Object.keys(i).map(j.getService)},getAllServices:function(){return e(i)},getService:function(a){return i[a]?e(i[a]):void 0},emitChange:function(){this.emit("change")},addChangeListener:function(a){this.on("change",a)}});j.dispatchToken=g.register(function(a){var b=a.action;switch(b.type){case h.RECEIVE_INITIAL_STATE:console.log("Services",b.type,b.state.services),b.state.services.forEach(c),j.emitChange()}}),b.exports=j},{"../constants/constants":17,"../dispatcher/dispatcher":18,events:37,underscore:51}],33:[function(a,b){"use strict";var c=a("underscore");b.exports={merge:c.extend,clone:c.clone,hasDifferentProperties:function(a,b){return Object.keys(a).some(function(c){var d=a[c],e=b[c];return d!==e})},success:function(a){return function(b){console.log(a,"success",b)}},failure:function(a){return function(b){console.warn(a,"failure",b.stack)}},createPanelToggleHandler:function(a){var b="ui.panels."+a+".isOpen";return function(){var a=this.get(b);this.set(b,!a)}},debounce:function(a,b){var c=null;return function(){var d=this,e=arguments;clearTimeout(c),c=setTimeout(function(){a.apply(d,e)},b)}},throttle:function(a,b,c){b=b||(b=250);var d,e;return function(){var f=c||this,g=+new Date,h=arguments;d&&d+b>g?(clearTimeout(e),e=setTimeout(function(){d=g,a.apply(f,h)},b)):(d=g,a.apply(f,h))}}}},{underscore:51}],34:[function(a,b){var c=a("../actions/server-action-creators"),d=a("../xhr");b.exports={getInitialState:function(){d.get("/radio/state.json").then(function(a){try{var b=JSON.parse(a)}catch(d){}c.receiveInitialState(b)})},connectEventStream:function(){var a=new EventSource("/events");a.addEventListener("message",function(a){var b=JSON.parse(a.data);c.receiveStateUpdate(b)})}}},{"../actions/server-action-creators":1,"../xhr":36}],35:[function(a,b){var c=a("ractive"),d=a("es6-promise").Promise,e=a("./utils").throttle;a("./lib/ractive-events-tap");var f,g=a("./actions/state-action-creators");b.exports={init:function(){var b=document.querySelector("[data-ui-container]"),h=document.querySelector("[data-ui-template]#mainTmpl").innerText;return new d(function(d){f=new c({el:b,template:h,debug:!0,twoway:!1,data:{mainView:"controls"},complete:function(){this.on({power:function(a){a.original.preventDefault(),g.togglePower()},"volume-slider-changed":e(function(a){var b=a.node.value;g.changeVolume(b)},1e3),"tune-service":function(a){g.changeService(a)},avoid:function(){g.toggleAvoider()},"avoider-settings-requested":function(){g.requestAvoiderSettings()},"avoider-settings-changed":function(a){g.avoiderSettings(a)},announce:function(){g.toggleAnnouncer()},"settings-panel-requested":function(){console.log("settings-panel-requested"),g.requestRadioSettings(),this.set("mainView","settings"===this.get("mainView")?"controls":"settings")},"preferred-service-changed":function(a){console.log("preferred-service-changed",a),g.toggleRadioSettingPreferredServer(a)}}),console.log("splashStartTime - now = %oms",Date.now()-splashStartTime),d()},components:{Standby:a("./components/simple")("#standbyTmpl"),Controls:a("./components/controls"),RadioSettings:a("./components/simple")("#settingsTmpl"),Masthead:a("./components/simple")("#mastheadTmpl")}})})},set:function(a,b){console.log("VIEW ",a,b),f.set(a,b)}}},{"./actions/state-action-creators":2,"./components/controls":13,"./components/simple":16,"./lib/ractive-events-tap":23,"./utils":33,"es6-promise":39,ractive:50}],36:[function(a,b){"use strict";function c(a,b,c){return c=c||{},a=a?a.toUpperCase():"GET",new d(function(d,e){var f=new XMLHttpRequest;f.open(a,b),c.headers&&Object.keys(c.headers).forEach(function(a){f.setRequestHeader(a,c.headers[a])}),f.onload=function(){200===f.status?d(f.response):e(new Error(f.statusText))},f.onerror=function(){e(new Error("Network Error"))},f.send(c.data)})}var d=d||a("es6-promise").Promise;b.exports=c,["get","delete","post","put"].forEach(function(a){b.exports[a]=function(){var b=Array.prototype.slice.call(arguments),d=[a].concat(b);return c.apply(null,d)}})},{"es6-promise":39}],37:[function(a,b){function c(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function d(a){return"function"==typeof a}function e(a){return"number"==typeof a}function f(a){return"object"==typeof a&&null!==a}function g(a){return void 0===a}b.exports=c,c.EventEmitter=c,c.prototype._events=void 0,c.prototype._maxListeners=void 0,c.defaultMaxListeners=10,c.prototype.setMaxListeners=function(a){if(!e(a)||0>a||isNaN(a))throw TypeError("n must be a positive number");return this._maxListeners=a,this},c.prototype.emit=function(a){var b,c,e,h,i,j;if(this._events||(this._events={}),"error"===a&&(!this._events.error||f(this._events.error)&&!this._events.error.length))throw b=arguments[1],b instanceof Error?b:TypeError('Uncaught, unspecified "error" event.');if(c=this._events[a],g(c))return!1;if(d(c))switch(arguments.length){case 1:c.call(this);break;case 2:c.call(this,arguments[1]);break;case 3:c.call(this,arguments[1],arguments[2]);break;default:for(e=arguments.length,h=new Array(e-1),i=1;e>i;i++)h[i-1]=arguments[i];c.apply(this,h)}else if(f(c)){for(e=arguments.length,h=new Array(e-1),i=1;e>i;i++)h[i-1]=arguments[i];for(j=c.slice(),e=j.length,i=0;e>i;i++)j[i].apply(this,h)}return!0},c.prototype.addListener=function(a,b){var e;if(!d(b))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",a,d(b.listener)?b.listener:b),this._events[a]?f(this._events[a])?this._events[a].push(b):this._events[a]=[this._events[a],b]:this._events[a]=b,f(this._events[a])&&!this._events[a].warned){var e;e=g(this._maxListeners)?c.defaultMaxListeners:this._maxListeners,e&&e>0&&this._events[a].length>e&&(this._events[a].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[a].length),"function"==typeof console.trace&&console.trace())}return this},c.prototype.on=c.prototype.addListener,c.prototype.once=function(a,b){function c(){this.removeListener(a,c),e||(e=!0,b.apply(this,arguments))}if(!d(b))throw TypeError("listener must be a function");var e=!1;return c.listener=b,this.on(a,c),this},c.prototype.removeListener=function(a,b){var c,e,g,h;if(!d(b))throw TypeError("listener must be a function");if(!this._events||!this._events[a])return this;if(c=this._events[a],g=c.length,e=-1,c===b||d(c.listener)&&c.listener===b)delete this._events[a],this._events.removeListener&&this.emit("removeListener",a,b);else if(f(c)){for(h=g;h-->0;)if(c[h]===b||c[h].listener&&c[h].listener===b){e=h;break}if(0>e)return this;1===c.length?(c.length=0,delete this._events[a]):c.splice(e,1),this._events.removeListener&&this.emit("removeListener",a,b)}return this},c.prototype.removeAllListeners=function(a){var b,c;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[a]&&delete this._events[a],this;if(0===arguments.length){for(b in this._events)"removeListener"!==b&&this.removeAllListeners(b);return this.removeAllListeners("removeListener"),this._events={},this}if(c=this._events[a],d(c))this.removeListener(a,c);else for(;c.length;)this.removeListener(a,c[c.length-1]);return delete this._events[a],this},c.prototype.listeners=function(a){var b;return b=this._events&&this._events[a]?d(this._events[a])?[this._events[a]]:this._events[a].slice():[]},c.listenerCount=function(a,b){var c;return c=a._events&&a._events[b]?d(a._events[b])?1:a._events[b].length:0}},{}],38:[function(a,b){function c(){}var d=b.exports={};d.nextTick=function(){var a="undefined"!=typeof window&&window.setImmediate,b="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(a)return function(a){return window.setImmediate(a)};if(b){var c=[];return window.addEventListener("message",function(a){var b=a.source;if((b===window||null===b)&&"process-tick"===a.data&&(a.stopPropagation(),c.length>0)){var d=c.shift();d()}},!0),function(a){c.push(a),window.postMessage("process-tick","*")}}return function(a){setTimeout(a,0)}}(),d.title="browser",d.browser=!0,d.env={},d.argv=[],d.on=c,d.addListener=c,d.once=c,d.off=c,d.removeListener=c,d.removeAllListeners=c,d.emit=c,d.binding=function(){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(){throw new Error("process.chdir is not supported")}},{}],39:[function(a,b,c){"use strict";var d=a("./promise/promise").Promise,e=a("./promise/polyfill").polyfill;c.Promise=d,c.polyfill=e},{"./promise/polyfill":44,"./promise/promise":45}],40:[function(a,b,c){"use strict";function d(a){var b=this;if(!e(a))throw new TypeError("You must pass an array to all.");return new b(function(b,c){function d(a){return function(b){e(a,b)}}function e(a,c){h[a]=c,0===--i&&b(h)}var g,h=[],i=a.length;0===i&&b([]);for(var j=0;j<a.length;j++)g=a[j],g&&f(g.then)?g.then(d(j),c):e(j,g)})}var e=a("./utils").isArray,f=a("./utils").isFunction;c.all=d},{"./utils":49}],41:[function(a,b,c){(function(a,b){"use strict";function d(){return function(){a.nextTick(g)}}function e(){var a=0,b=new k(g),c=document.createTextNode("");return b.observe(c,{characterData:!0}),function(){c.data=a=++a%2}}function f(){return function(){l.setTimeout(g,1)}}function g(){for(var a=0;a<m.length;a++){var b=m[a],c=b[0],d=b[1];c(d)}m=[]}function h(a,b){var c=m.push([a,b]);1===c&&i()}var i,j="undefined"!=typeof window?window:{},k=j.MutationObserver||j.WebKitMutationObserver,l="undefined"!=typeof b?b:void 0===this?window:this,m=[];i="undefined"!=typeof a&&"[object process]"==={}.toString.call(a)?d():k?e():f(),c.asap=h}).call(this,a("FWaASH"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{FWaASH:38}],42:[function(a,b,c){"use strict";function d(a){if(a&&"object"==typeof a&&a.constructor===this)return a;var b=this;return new b(function(b){b(a)})}c.cast=d},{}],43:[function(a,b,c){"use strict";function d(a,b){return 2!==arguments.length?e[a]:void(e[a]=b)}var e={instrument:!1};c.config=e,c.configure=d},{}],44:[function(a,b,c){(function(b){"use strict";function d(){var a;a="undefined"!=typeof b?b:"undefined"!=typeof window&&window.document?window:self;var c="Promise"in a&&"cast"in a.Promise&&"resolve"in a.Promise&&"reject"in a.Promise&&"all"in a.Promise&&"race"in a.Promise&&function(){var b;return new a.Promise(function(a){b=a}),f(b)}();c||(a.Promise=e)}var e=a("./promise").Promise,f=a("./utils").isFunction;c.polyfill=d}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./promise":45,"./utils":49}],45:[function(a,b,c){"use strict";function d(a){if(!q(a))throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");if(!(this instanceof d))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this._subscribers=[],e(a,this)}function e(a,b){function c(a){j(b,a)}function d(a){l(b,a)}try{a(c,d)}catch(e){d(e)}}function f(a,b,c,d){var e,f,g,h,k=q(c);if(k)try{e=c(d),g=!0}catch(m){h=!0,f=m}else e=d,g=!0;i(b,e)||(k&&g?j(b,e):h?l(b,f):a===z?j(b,e):a===A&&l(b,e))}function g(a,b,c,d){var e=a._subscribers,f=e.length;e[f]=b,e[f+z]=c,e[f+A]=d}function h(a,b){for(var c,d,e=a._subscribers,g=a._detail,h=0;h<e.length;h+=3)c=e[h],d=e[h+b],f(b,c,d,g);a._subscribers=null}function i(a,b){var c,d=null;try{if(a===b)throw new TypeError("A promises callback cannot return that same promise.");if(p(b)&&(d=b.then,q(d)))return d.call(b,function(d){return c?!0:(c=!0,void(b!==d?j(a,d):k(a,d)))},function(b){return c?!0:(c=!0,void l(a,b))}),!0}catch(e){return c?!0:(l(a,e),!0)}return!1}function j(a,b){a===b?k(a,b):i(a,b)||k(a,b)}function k(a,b){a._state===x&&(a._state=y,a._detail=b,o.async(m,a))}function l(a,b){a._state===x&&(a._state=y,a._detail=b,o.async(n,a))}function m(a){h(a,a._state=z)}function n(a){h(a,a._state=A)}var o=a("./config").config,p=(a("./config").configure,a("./utils").objectOrFunction),q=a("./utils").isFunction,r=(a("./utils").now,a("./cast").cast),s=a("./all").all,t=a("./race").race,u=a("./resolve").resolve,v=a("./reject").reject,w=a("./asap").asap;o.async=w;var x=void 0,y=0,z=1,A=2;d.prototype={constructor:d,_state:void 0,_detail:void 0,_subscribers:void 0,then:function(a,b){var c=this,d=new this.constructor(function(){});if(this._state){var e=arguments;o.async(function(){f(c._state,d,e[c._state-1],c._detail)})}else g(this,d,a,b);return d},"catch":function(a){return this.then(null,a)}},d.all=s,d.cast=r,d.race=t,d.resolve=u,d.reject=v,c.Promise=d},{"./all":40,"./asap":41,"./cast":42,"./config":43,"./race":46,"./reject":47,"./resolve":48,"./utils":49}],46:[function(a,b,c){"use strict";function d(a){var b=this;if(!e(a))throw new TypeError("You must pass an array to race.");return new b(function(b,c){for(var d,e=0;e<a.length;e++)d=a[e],d&&"function"==typeof d.then?d.then(b,c):b(d)})}var e=a("./utils").isArray;c.race=d},{"./utils":49}],47:[function(a,b,c){"use strict";function d(a){var b=this;return new b(function(b,c){c(a)})}c.reject=d},{}],48:[function(a,b,c){"use strict";function d(a){var b=this;return new b(function(b){b(a)})}c.resolve=d},{}],49:[function(a,b,c){"use strict";function d(a){return e(a)||"object"==typeof a&&null!==a}function e(a){return"function"==typeof a}function f(a){return"[object Array]"===Object.prototype.toString.call(a)}var g=Date.now||function(){return(new Date).getTime()};c.objectOrFunction=d,c.isFunction=e,c.isArray=f,c.now=g},{}],50:[function(a,b){!function(a){"use strict";var c=a.Ractive,d=function(){var a={el:void 0,append:!1,template:{v:1,t:[]},preserveWhitespace:!1,sanitize:!1,stripComments:!0,data:{},computed:{},magic:!1,modifyArrays:!0,adapt:[],isolated:!1,twoway:!0,lazy:!1,noIntro:!1,transitionsEnabled:!0,complete:void 0,noCssTransform:!1,debug:!1};return a}(),e={linear:function(a){return a},easeIn:function(a){return Math.pow(a,3)},easeOut:function(a){return Math.pow(a-1,3)+1},easeInOut:function(a){return(a/=.5)<1?.5*Math.pow(a,3):.5*(Math.pow(a-2,3)+2)}},f=[],g=Object.prototype.hasOwnProperty,h=function(){var a=Object.prototype.toString;return function(b){return"[object Array]"===a.call(b)}}(),i=function(){var a=Object.prototype.toString;return function(b){return b&&"[object Object]"===a.call(b)}}(),j=function(a){return!isNaN(parseFloat(a))&&isFinite(a)},k=function(a,b,c,d,e){var f,g,h;return a.push(function(){g=a.interpolate}),h=/^([+-]?[0-9]+\.?(?:[0-9]+)?)(px|em|ex|%|in|cm|mm|pt|pc)$/,f={number:function(a,b){var c;return e(a)&&e(b)?(a=+a,b=+b,c=b-a,c?function(b){return a+b*c}:function(){return a}):null},array:function(a,b){var d,e,f,h;if(!c(a)||!c(b))return null;for(d=[],e=[],h=f=Math.min(a.length,b.length);h--;)e[h]=g(a[h],b[h]);for(h=f;h<a.length;h+=1)d[h]=a[h];for(h=f;h<b.length;h+=1)d[h]=b[h];return function(a){for(var b=f;b--;)d[b]=e[b](a);return d}},object:function(a,c){var e,f,h,i,j;if(!d(a)||!d(c))return null;e=[],i={},h={};for(j in a)b.call(a,j)&&(b.call(c,j)?(e.push(j),h[j]=g(a[j],c[j])):i[j]=a[j]);for(j in c)b.call(c,j)&&!b.call(a,j)&&(i[j]=c[j]);return f=e.length,function(a){for(var b,c=f;c--;)b=e[c],i[b]=h[b](a);return i}},cssLength:function(a,b){var c,d,e,f,g,i,j,k;return 0!==a&&"string"!=typeof a||0!==b&&"string"!=typeof b?null:(c=h.exec(a),d=h.exec(b),e=c?c[2]:"",f=d?d[2]:"",e&&f&&e!==f?null:(j=e||f,g=c?+c[1]:0,i=d?+d[1]:0,k=i-g,k?function(a){return g+a*k+j}:function(){return g+j}))}}}(f,g,h,i,j),l=function(){var a;return a="undefined"==typeof document?!1:document&&document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")}(),m=function(a,b){var c=a.indexOf(b);-1!==c&&a.splice(c,1)},n=function(){function a(a){setTimeout(a,0)}function b(a,b){return function(){for(var c;c=a.shift();)c(b)}}function c(a,b,e,f){var g;if(b===a)throw new TypeError("A promise's fulfillment handler cannot return the same promise");if(b instanceof d)b.then(e,f);else if(!b||"object"!=typeof b&&"function"!=typeof b)e(b);else{try{g=b.then}catch(h){return void f(h)}if("function"==typeof g){var i,j,k;j=function(b){i||(i=!0,c(a,b,e,f))},k=function(a){i||(i=!0,f(a))};try{g.call(b,j,k)}catch(h){if(!i)return f(h),void(i=!0)}}else e(b)}}var d,e={},f={},g={};return"function"==typeof n?d=n:(d=function(h){var i,j,k,l,m,n,o=[],p=[],q=e;k=function(c){return function(d){q===e&&(i=d,q=c,j=b(q===f?o:p,i),a(j))}},l=k(f),m=k(g);try{h(l,m)}catch(r){m(r)}return n={then:function(b,f){var g=new d(function(d,h){var i=function(a,b,e){b.push("function"==typeof a?function(b){var e;try{e=a(b),c(g,e,d,h)}catch(f){h(f)}}:e)};i(b,o,d),i(f,p,h),q!==e&&a(j)});return g}},n["catch"]=function(a){return this.then(null,a)},n},d.all=function(a){return new d(function(b,c){var d,e,f,g=[];if(!a.length)return void b(g);for(f=function(e){a[e].then(function(a){g[e]=a,--d||b(g)},c)},d=e=a.length;e--;)f(e)})},d.resolve=function(a){return new d(function(b){b(a)})},d.reject=function(a){return new d(function(b,c){c(a)})}),d}(),o=function(){var a=/\[\s*(\*|[0-9]|[1-9][0-9]+)\s*\]/g;return function(b){return(b||"").replace(a,".$1")}}(),p=function(a){do if(a.context)return a.context;while(a=a.parent);return""},q=function(a,b){return null===a&&null===b?!0:"object"==typeof a||"object"==typeof b?!1:a===b},r=function(a,b,c){var d;a.push(function(){return d=a.runloop});var e=function(a,b,c,d,e){this.root=a,this.keypath=b,this.priority=e,this.otherInstance=c,this.otherKeypath=d,this.bind(),this.value=this.root.viewmodel.get(this.keypath)};return e.prototype={setValue:function(a){var e=this;return this.updating||this.counterpart&&this.counterpart.updating?void(this.value=a):void(b(a)&&a._ractive&&a._ractive.setting||c(a,this.value)||(this.updating=!0,d.addViewmodel(this.otherInstance.viewmodel),this.otherInstance.viewmodel.set(this.otherKeypath,a),this.value=a,d.scheduleTask(function(){return e.updating=!1})))},bind:function(){this.root.viewmodel.register(this.keypath,this)},rebind:function(a){this.unbind(),this.keypath=a,this.counterpart.otherKeypath=a,this.bind()},unbind:function(){this.root.viewmodel.unregister(this.keypath,this)}},function(a,b,c,d){var f,g,h,i,j,k;f=c+"="+d,h=a.bindings,h[f]||(h[f]=!0,g=a.instance,i=a.parentFragment.priority,j=new e(b,c,g,d,i),h.push(j),g.twoway&&(k=new e(g,d,b,c,1),h.push(k),j.counterpart=k,k.counterpart=j))}}(f,h,q),s=function(a,b,c){function d(a,b){var c;if("."===b)return a;if(c=a?a.split("."):[],"../"===b.substr(0,3)){for(;"../"===b.substr(0,3);){if(!c.length)throw new Error(e);c.pop(),b=b.substring(3)}return c.push(b),c.join(".")}return a?a+b.replace(/^\.\//,"."):b.replace(/^\.\/?/,"")}var e,f;return e='Could not resolve reference - too many "../" prefixes',f={evaluateWrapped:!0},function g(e,h,i){var j,k,l,m,n,o,p,q,r,s;if(h=a(h),"~/"===h.substr(0,2))return h.substring(2);if("."===h.charAt(0))return d(b(i),h);k=h.split(".")[0];do if(j=i.context,j&&(o=!0,n=e.viewmodel.get(j,f),n&&("object"==typeof n||"function"==typeof n)&&k in n))return j+"."+h;
while(i=i.parent);if(k in e.data||k in e.viewmodel.computations)return h;if(e._parent&&!e.isolated){if(i=e.component.parentFragment,i.indexRefs&&void 0!==(l=i.indexRefs[h]))return e.component.indexRefBindings[h]=h,void e.viewmodel.set(h,l,!0);if(m=g(e._parent,h,i)){for(p=m.split("."),q=h.split(".");p.length>1&&q.length>1&&p[p.length-1]===q[q.length-1];)p.pop(),q.pop();return r=p.join("."),s=q.join("."),e.viewmodel.set(s,e._parent.viewmodel.get(r),!0),c(e.component,e._parent,r,s),h}}return o?void 0!==e.viewmodel.get(h)?h:void 0:h}}(o,p,r),t=function(a){function b(a){a.detach()}function c(a){a.detachNodes()}function d(a){!a.ready||a.outros.length||a.outroChildren||(a.outrosComplete||(a.parent?a.parent.decrementOutros(a):a.detachNodes(),a.outrosComplete=!0),a.intros.length||a.totalChildren||("function"==typeof a.callback&&a.callback(),a.parent&&a.parent.decrementTotal()))}var e=function(a,b){this.callback=a,this.parent=b,this.intros=[],this.outros=[],this.children=[],this.totalChildren=this.outroChildren=0,this.detachQueue=[],this.outrosComplete=!1,b&&b.addChild(this)};return e.prototype={addChild:function(a){this.children.push(a),this.totalChildren+=1,this.outroChildren+=1},decrementOutros:function(){this.outroChildren-=1,d(this)},decrementTotal:function(){this.totalChildren-=1,d(this)},add:function(a){var b=a.isIntro?this.intros:this.outros;b.push(a)},remove:function(b){var c=b.isIntro?this.intros:this.outros;a(c,b),d(this)},init:function(){this.ready=!0,d(this)},detachNodes:function(){this.detachQueue.forEach(b),this.children.forEach(c)}},e}(m),u=function(a,b,c,d,e){function f(){var a,b,c;for(a=0;a<h.viewmodels.length;a+=1)b=h.viewmodels[a],c=b.applyChanges(),c&&b.ractive.fire("change",c);for(h.viewmodels.length=0,g(),a=0;a<h.views.length;a+=1)h.views[a].update();for(h.views.length=0,a=0;a<h.tasks.length;a+=1)h.tasks[a]();return h.tasks.length=0,h.viewmodels.length?f():void 0}function g(){var a,b,c;if(j.length)for(a=j.splice(0,j.length);b=a.pop();)b.keypath||(c=d(b.root,b.ref,b.parentFragment),void 0!==c?b.resolve(c):j.push(b))}var h,i,j=[];return i={start:function(a,b){var d,f;return b&&(d=new c(function(a){return f=a})),h={previousBatch:h,transitionManager:new e(f,h&&h.transitionManager),views:[],tasks:[],viewmodels:[]},a&&h.viewmodels.push(a.viewmodel),d},end:function(){f(),h.transitionManager.init(),h=h.previousBatch},addViewmodel:function(a){h?-1===h.viewmodels.indexOf(a)&&h.viewmodels.push(a):a.applyChanges()},registerTransition:function(a){a._manager=h.transitionManager,h.transitionManager.add(a)},addView:function(a){h.views.push(a)},addUnresolved:function(a){j.push(a)},removeUnresolved:function(a){b(j,a)},detachWhenReady:function(a){h.transitionManager.detachQueue.push(a)},scheduleTask:function(a){h?h.tasks.push(a):a()}},a.runloop=i,i}(f,m,n,s,t),v=function(){var a=/^\s*[0-9]+\s*$/;return function(b){return a.test(b)?[]:{}}}(),w=function(a,b,c){function d(b,c,d){function e(b){var d,e;b.value=c,b.updating||(e=b.ractive,d=b.keypath,b.updating=!0,a.start(e),e.viewmodel.mark(d),a.end(),b.updating=!1)}var f,g,h,i,j,k;if(f=b.obj,g=b.prop,d&&!d.configurable){if("length"===g)return;throw new Error('Cannot use magic mode with property "'+g+'" - object is not configurable')}d&&(h=d.get,i=d.set),j=h||function(){return c},k=function(a){i&&i(a),c=h?h():a,k._ractiveWrappers.forEach(e)},k._ractiveWrappers=[b],Object.defineProperty(f,g,{get:j,set:k,enumerable:!0,configurable:!0})}var e,f;try{Object.defineProperty({},"test",{value:0}),e={filter:function(a,b,d){var e,f,g,h,i;return b?(e=b.split("."),f=e.pop(),g=e.join("."),(h=d.viewmodel.wrapped[g])&&!h.magic?!1:(i=d.get(g),c(i)&&/^[0-9]+$/.test(f)?!1:i&&("object"==typeof i||"function"==typeof i))):!1},wrap:function(a,b,c){return new f(a,b,c)}},f=function(a,b,c){var e,f,g,h;return this.magic=!0,this.ractive=a,this.keypath=c,this.value=b,e=c.split("."),this.prop=e.pop(),f=e.join("."),this.obj=f?a.get(f):a.data,g=this.originalDescriptor=Object.getOwnPropertyDescriptor(this.obj,this.prop),g&&g.set&&(h=g.set._ractiveWrappers)?void(-1===h.indexOf(this)&&h.push(this)):void d(this,b,g)},f.prototype={get:function(){return this.value},reset:function(b){this.updating||(this.updating=!0,this.obj[this.prop]=b,a.addViewmodel(this.ractive.viewmodel),this.ractive.viewmodel.mark(this.keypath),this.updating=!1)},set:function(a,c){this.updating||(this.obj[this.prop]||(this.updating=!0,this.obj[this.prop]=b(a),this.updating=!1),this.obj[this.prop][a]=c)},teardown:function(){var a,b,c,d,e;return this.updating?!1:(a=Object.getOwnPropertyDescriptor(this.obj,this.prop),b=a&&a.set,void(b&&(d=b._ractiveWrappers,e=d.indexOf(this),-1!==e&&d.splice(e,1),d.length||(c=this.obj[this.prop],Object.defineProperty(this.obj,this.prop,this.originalDescriptor||{writable:!0,enumerable:!0,configurable:!0}),this.obj[this.prop]=c))))}}}catch(g){e=!1}return e}(u,v,h),x=function(a){return!!a}(w),y={html:"http://www.w3.org/1999/xhtml",mathml:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},z=function(a,b){var c;return c=a?function(a,c){return c&&c!==b.html?document.createElementNS(c,a):document.createElement(a)}:function(a,c){if(c&&c!==b.html)throw"This browser does not support namespaces other than http://www.w3.org/1999/xhtml. The most likely cause of this error is that you're trying to render SVG in an older browser. See http://docs.ractivejs.org/latest/svg-and-older-browsers for more information";return document.createElement(a)}}(l,y),A=function(){var a="object"==typeof document;return a}(),B=function(a){var b;try{Object.defineProperty({},"test",{value:0}),a&&Object.defineProperty(document.createElement("div"),"test",{value:0}),b=Object.defineProperty}catch(c){b=function(a,b,c){a[b]=c.value}}return b}(A),C=function(a,b,c){var d;try{try{Object.defineProperties({},{test:{value:0}})}catch(e){throw e}c&&Object.defineProperties(a("div"),{test:{value:0}}),d=Object.defineProperties}catch(e){d=function(a,c){var d;for(d in c)c.hasOwnProperty(d)&&b(a,d,c[d])}}return d}(z,B,A),D=function(a){return function(b,c,d){var e;if("string"!=typeof c||!a(d))throw new Error("Bad arguments");if(e=+b.get(c)||0,!a(e))throw new Error("Cannot add to a non-numeric value");return b.set(c,e+d)}}(j),E=function(a){return function(b,c){return a(this,b,void 0===c?1:+c)}}(D),F=function(a){var b=/^\.+/;return function(c){return a(c).replace(b,"")}}(o),G=["o","ms","moz","webkit"],H=function(a){var b;return"undefined"==typeof window?b=null:(!function(a,b,c){var d,e;if(!c.requestAnimationFrame){for(d=0;d<a.length&&!c.requestAnimationFrame;++d)c.requestAnimationFrame=c[a[d]+"RequestAnimationFrame"];c.requestAnimationFrame||(e=c.setTimeout,c.requestAnimationFrame=function(a){var c,d,f;return c=Date.now(),d=Math.max(0,16-(c-b)),f=e(function(){a(c+d)},d),b=c+d,f})}}(a,0,window),b=window.requestAnimationFrame),b}(G),I=function(){var a;return a="undefined"!=typeof window&&window.performance&&"function"==typeof window.performance.now?function(){return window.performance.now()}:function(){return Date.now()}}(),J=function(a,b,c){var d=[],e={tick:function(){var f,g,h;for(h=b(),c.start(),f=0;f<d.length;f+=1)g=d[f],g.tick(h)||d.splice(f--,1);c.end(),d.length?a(e.tick):e.running=!1},add:function(b){d.push(b),e.running||(e.running=!0,a(e.tick))},abort:function(a,b){for(var c,e=d.length;e--;)c=d[e],c.root===b&&c.keypath===a&&c.stop()}};return e}(H,I,u),K=function(){var a,b={};return a="undefined"!=typeof console&&"function"==typeof console.warn&&"function"==typeof console.warn.apply?function(a,c){if(!c){if(b[a])return;b[a]=!0}console.warn(a)}:function(){}}(),L=function(){function a(a){return a.trim?a.trim():a.replace(/^\s+/,"").replace(/\s+$/,"")}function b(a){return a.str}var c=/(?:^|\})?\s*([^\{\}]+)\s*\{/g,d=/\/\*.*?\*\//g,e=/((?:(?:\[[^\]+]\])|(?:[^\s\+\>\~:]))+)((?::[^\s\+\>\~]+)?\s*[\s\+\>\~]?)\s*/g,f=/^@media/,g=/\[data-rvcguid="[a-z0-9-]+"]/g;return function(h,i){var j,k;return k=function(a){var c,d,f,g,h,j,k,l,m=[];for(c=[];d=e.exec(a);)c.push({str:d[0],base:d[1],modifiers:d[2]});for(g='[data-rvcguid="'+i+'"]',h=c.map(b),l=c.length;l--;)k=h.slice(),f=c[l],k[l]=f.base+g+f.modifiers||"",j=h.slice(),j[l]=g+" "+j[l],m.push(k.join(" "),j.join(" "));return m.join(", ")},j=g.test(h)?h.replace(g,'[data-rvcguid="'+i+'"]'):h.replace(d,"").replace(c,function(b,c){var d,e;return f.test(c)?b:(d=c.split(",").map(a),e=d.map(k).join(", ")+" ",b.replace(c,e))})}}(),M=function(a){function b(a,b,d){var e,f=b.constructor._guid;(e=c(d.css,d,f)||c(a.css,a,f))&&(b.constructor.css=e)}function c(b,c,d){return b?c.noCssTransform?b:a(b,d):void 0}var d={name:"css",extend:b,init:function(){}};return d}(L),N=function(){function a(a,b){return"function"==typeof b&&/_super/.test(a)}return function(b,c,d){return d||a(b,c)?function(){var a,d="_super"in this,e=this._super;return this._super=c,a=b.apply(this,arguments),d&&(this._super=e),a}:b}}(),O=function(a){function b(a,b,c){var d=c.data||{},e=f(a.prototype.data);return g(e,d)}function c(a,c,d){c.data=b(a,c,d)}function d(a,c,d){var e=d.data,f=b(a,c,d);return"function"==typeof f&&(f=f.call(c,e)||e),c.data=f||{}}function e(a){var b=this.init(a.constructor,a,a);return b?(a.data=b,!0):void 0}function f(a){if("function"!=typeof a||!Object.keys(a).length)return a;var b={};return h(a,b),g(a,b)}function g(a,b){return"function"==typeof b?k(b,a):"function"==typeof a?j(b,a):i(b,a)}function h(a,b,c){for(var d in a)c&&d in b||(b[d]=a[d])}function i(a,b){return a=a||{},b?(h(b,a,!0),a):a}function j(a,b){return function(c){var d;if(a){d=[];for(var e in a)c&&e in c||d.push(e)}return c=b.call(this,c)||c,d&&d.length&&(c=c||{},d.forEach(function(b){c[b]=a[b]})),c}}function k(b,c){var d;return d="function"!=typeof c?function(a){i(a,c)}:function(b){return c=a(c,function(){},!0),c.call(this,b)||b},a(b,d)}var l={name:"data",extend:c,init:d,reset:e};return l}(N),P={missingParser:"Missing Ractive.parse - cannot parse template. Either preparse or use the version that includes the parser",mergeComparisonFail:"Merge operation: comparison failed. Falling back to identity checking",noComponentEventArguments:"Components currently only support simple events - you cannot include arguments. Sorry!",noTemplateForPartial:'Could not find template for partial "{name}"',noNestedPartials:"Partials ({{>{name}}}) cannot contain nested inline partials",evaluationError:'Error evaluating "{uniqueString}": {err}',badArguments:"Bad arguments \"{arguments}\". I'm not allowed to argue unless you've paid.",failedComputation:'Failed to compute "{key}": {err}',missingPlugin:'Missing "{name}" {plugin} plugin. You may need to download a {plugin} via http://docs.ractivejs.org/latest/plugins#{plugin}s',badRadioInputBinding:"A radio input can have two-way binding on its name attribute, or its checked attribute - not both",noRegistryFunctionReturn:'A function was specified for "{name}" {registry}, but no {registry} was returned'},Q={TEXT:1,INTERPOLATOR:2,TRIPLE:3,SECTION:4,INVERTED:5,CLOSING:6,ELEMENT:7,PARTIAL:8,COMMENT:9,DELIMCHANGE:10,MUSTACHE:11,TAG:12,ATTRIBUTE:13,CLOSING_TAG:14,COMPONENT:15,NUMBER_LITERAL:20,STRING_LITERAL:21,ARRAY_LITERAL:22,OBJECT_LITERAL:23,BOOLEAN_LITERAL:24,GLOBAL:26,KEY_VALUE_PAIR:27,REFERENCE:30,REFINEMENT:31,MEMBER:32,PREFIX_OPERATOR:33,BRACKETED:34,CONDITIONAL:35,INFIX_OPERATOR:36,INVOCATION:40,SECTION_IF:50,SECTION_UNLESS:51,SECTION_EACH:52,SECTION_WITH:53},R=function(){var a;try{Object.create(null),a=Object.create}catch(b){a=function(){var a=function(){};return function(b,c){var d;return null===b?{}:(a.prototype=b,d=new a,c&&Object.defineProperties(d,c),d)}}()}return a}(),S={expectedExpression:"Expected a JavaScript expression",expectedParen:"Expected closing paren"},T=function(a){var b=/^(?:[+-]?)(?:(?:(?:0|[1-9]\d*)?\.\d+)|(?:(?:0|[1-9]\d*)\.)|(?:0|[1-9]\d*))(?:[eE][+-]?\d+)?/;return function(c){var d;return(d=c.matchPattern(b))?{t:a.NUMBER_LITERAL,v:d}:null}}(Q),U=function(a){return function(b){var c=b.remaining();return"true"===c.substr(0,4)?(b.pos+=4,{t:a.BOOLEAN_LITERAL,v:"true"}):"false"===c.substr(0,5)?(b.pos+=5,{t:a.BOOLEAN_LITERAL,v:"false"}):null}}(Q),V=function(){var a,b,c;return a=/^(?=.)[^"'\\]+?(?:(?!.)|(?=["'\\]))/,b=/^\\(?:['"\\bfnrt]|0(?![0-9])|x[0-9a-fA-F]{2}|u[0-9a-fA-F]{4}|(?=.)[^ux0-9])/,c=/^\\(?:\r\n|[\u000A\u000D\u2028\u2029])/,function(d){return function(e){var f,g,h,i;for(f=e.pos,g='"',h=!1;!h;)i=e.matchPattern(a)||e.matchPattern(b)||e.matchString(d),i?g+='"'===i?'\\"':"\\'"===i?"'":i:(i=e.matchPattern(c),i?g+="\\u"+("000"+i.charCodeAt(1).toString(16)).slice(-4):h=!0);return g+='"',JSON.parse(g)}}}(),W=function(a){return a('"')}(V),X=function(a){return a("'")}(V),Y=function(a,b,c){return function(d){var e,f;return e=d.pos,d.matchString('"')?(f=c(d),d.matchString('"')?{t:a.STRING_LITERAL,v:f}:(d.pos=e,null)):d.matchString("'")?(f=b(d),d.matchString("'")?{t:a.STRING_LITERAL,v:f}:(d.pos=e,null)):null}}(Q,W,X),Z={name:/^[a-zA-Z_$][a-zA-Z_$0-9]*/},$=function(a,b,c){var d=/^[a-zA-Z_$][a-zA-Z_$0-9]*$/;return function(e){var f;return(f=a(e))?d.test(f.v)?f.v:'"'+f.v.replace(/"/g,'\\"')+'"':(f=b(e))?f.v:(f=e.matchPattern(c.name))?f:void 0}}(Y,T,Z),_=function(a,b){return function(c){var d,e,f;return d=c.pos,c.allowWhitespace(),e=b(c),null===e?(c.pos=d,null):(c.allowWhitespace(),c.matchString(":")?(c.allowWhitespace(),f=c.readExpression(),null===f?(c.pos=d,null):{t:a.KEY_VALUE_PAIR,k:e,v:f}):(c.pos=d,null))}}(Q,$),ab=function(a){return function b(c){var d,e,f,g;return d=c.pos,f=a(c),null===f?null:(e=[f],c.matchString(",")?(g=b(c),g?e.concat(g):(c.pos=d,null)):e)}}(_),bb=function(a,b){return function(c){var d,e;return d=c.pos,c.allowWhitespace(),c.matchString("{")?(e=b(c),c.allowWhitespace(),c.matchString("}")?{t:a.OBJECT_LITERAL,m:e}:(c.pos=d,null)):(c.pos=d,null)}}(Q,ab),cb=function(a){return function b(c){function d(a){f.push(a)}var e,f,g,h;return e=c.pos,c.allowWhitespace(),g=c.readExpression(),null===g?null:(f=[g],c.allowWhitespace(),c.matchString(",")&&(h=b(c),null===h&&c.error(a.expectedExpression),h.forEach(d)),f)}}(S),db=function(a,b){return function(c){var d,e;return d=c.pos,c.allowWhitespace(),c.matchString("[")?(e=b(c),c.matchString("]")?{t:a.ARRAY_LITERAL,m:e}:(c.pos=d,null)):(c.pos=d,null)}}(Q,cb),eb=function(a,b,c,d,e){return function(f){var g=a(f)||b(f)||c(f)||d(f)||e(f);return g}}(T,U,Y,bb,db),fb=function(a,b){var c,d,e,f,g;return c=/^\.[a-zA-Z_$0-9]+/,e=function(a){var b=a.matchPattern(d);return b?"."+b:null},d=/^\[(0|[1-9][0-9]*)\]/,f=/^(?:Array|Date|RegExp|decodeURIComponent|decodeURI|encodeURIComponent|encodeURI|isFinite|isNaN|parseFloat|parseInt|JSON|Math|NaN|undefined|null)$/,g=/^(?:break|case|catch|continue|debugger|default|delete|do|else|finally|for|function|if|in|instanceof|new|return|switch|throw|try|typeof|var|void|while|with)$/,function(d){var h,i,j,k,l,m,n;if(h=d.pos,d.matchString("~/"))i="~/";else for(i="";d.matchString("../");)i+="../";if(i||(k=d.matchString(".")||""),j=d.matchPattern(/^@(?:index|key)/)||d.matchPattern(b.name)||"",g.test(j))return d.pos=h,null;if(!i&&!k&&f.test(j))return{t:a.GLOBAL,v:j};if(l=(i||k)+j,!l)return null;for(;m=d.matchPattern(c)||e(d);)l+=m;return d.matchString("(")&&(n=l.lastIndexOf("."),-1!==n?(l=l.substr(0,n),d.pos=h+l.length):d.pos-=1),{t:a.REFERENCE,n:l.replace(/^this\./,"./").replace(/^this$/,".")}}}(Q,Z),gb=function(a,b){return function(c){var d,e;return d=c.pos,c.matchString("(")?(c.allowWhitespace(),e=c.readExpression(),e||c.error(b.expectedExpression),c.allowWhitespace(),c.matchString(")")||c.error(b.expectedParen),{t:a.BRACKETED,x:e}):null}}(Q,S),hb=function(a,b,c){return function(d){return a(d)||b(d)||c(d)}}(eb,fb,gb),ib=function(a,b,c){return function(d){var e,f,g;if(e=d.pos,d.allowWhitespace(),d.matchString(".")){if(d.allowWhitespace(),f=d.matchPattern(c.name))return{t:a.REFINEMENT,n:f};d.error("Expected a property name")}return d.matchString("[")?(d.allowWhitespace(),g=d.readExpression(),g||d.error(b.expectedExpression),d.allowWhitespace(),d.matchString("]")||d.error("Expected ']'"),{t:a.REFINEMENT,x:g}):null}}(Q,S,Z),jb=function(a,b,c,d,e){return function(f){var g,h,i,j;if(h=b(f),!h)return null;for(;h;)if(g=f.pos,i=d(f))h={t:a.MEMBER,x:h,r:i};else{if(!f.matchString("("))break;f.allowWhitespace(),j=c(f),f.allowWhitespace(),f.matchString(")")||f.error(e.expectedParen),h={t:a.INVOCATION,x:h},j&&(h.o=j)}return h}}(Q,hb,cb,ib,S),kb=function(a,b,c){var d,e;return e=function(c,d){return function(e){var f;return(f=d(e))?f:e.matchString(c)?(e.allowWhitespace(),f=e.readExpression(),f||e.error(b.expectedExpression),{s:c,o:f,t:a.PREFIX_OPERATOR}):null}},function(){var a,b,f,g,h;for(g="! ~ + - typeof".split(" "),h=c,a=0,b=g.length;b>a;a+=1)f=e(g[a],h),h=f;d=h}(),d}(Q,S,jb),lb=function(a,b){var c,d;return d=function(b,c){return function(d){var e,f,g;if(f=c(d),!f)return null;for(;;){if(e=d.pos,d.allowWhitespace(),!d.matchString(b))return d.pos=e,f;if("in"===b&&/[a-zA-Z_$0-9]/.test(d.remaining().charAt(0)))return d.pos=e,f;if(d.allowWhitespace(),g=c(d),!g)return d.pos=e,f;f={t:a.INFIX_OPERATOR,s:b,o:[f,g]}}}},function(){var a,e,f,g,h;for(g="* / % + - << >> >>> < <= > >= in instanceof == != === !== & ^ | && ||".split(" "),h=b,a=0,e=g.length;e>a;a+=1)f=d(g[a],h),h=f;c=h}(),c}(Q,kb),mb=function(a,b,c){return function(d){var e,f,g,h;return(f=b(d))?(e=d.pos,d.allowWhitespace(),d.matchString("?")?(d.allowWhitespace(),g=d.readExpression(),g||d.error(c.expectedExpression),d.allowWhitespace(),d.matchString(":")||d.error('Expected ":"'),d.allowWhitespace(),h=d.readExpression(),h||d.error(c.expectedExpression),{t:a.CONDITIONAL,o:[f,g,h]}):(d.pos=e,f)):null}}(Q,lb,S),nb=function(a,b){function c(a){return JSON.stringify(String(a))}function d(c,e){var f,g;if(c.t===a.REFERENCE&&-1===e.indexOf(c.n)&&e.unshift(c.n),g=c.o||c.m)if(b(g))d(g,e);else for(f=g.length;f--;)d(g[f],e);c.x&&d(c.x,e),c.r&&d(c.r,e),c.v&&d(c.v,e)}function e(b,d,f){var g=function(a){return e(b,a,f)};switch(d.t){case a.BOOLEAN_LITERAL:case a.GLOBAL:case a.NUMBER_LITERAL:return d.v;case a.STRING_LITERAL:return c(d.v);case a.ARRAY_LITERAL:return"["+(d.m?d.m.map(g).join(","):"")+"]";case a.OBJECT_LITERAL:return"{"+(d.m?d.m.map(g).join(","):"")+"}";case a.KEY_VALUE_PAIR:return d.k+":"+e(b,d.v,f);case a.PREFIX_OPERATOR:return("typeof"===d.s?"typeof ":d.s)+e(b,d.o,f);case a.INFIX_OPERATOR:return e(b,d.o[0],f)+("in"===d.s.substr(0,2)?" "+d.s+" ":d.s)+e(b,d.o[1],f);case a.INVOCATION:return e(b,d.x,f)+"("+(d.o?d.o.map(g).join(","):"")+")";case a.BRACKETED:return"("+e(b,d.x,f)+")";case a.MEMBER:return e(b,d.x,f)+e(b,d.r,f);case a.REFINEMENT:return d.n?"."+d.n:"["+e(b,d.x,f)+"]";case a.CONDITIONAL:return e(b,d.o[0],f)+"?"+e(b,d.o[1],f)+":"+e(b,d.o[2],f);case a.REFERENCE:return"${"+f.indexOf(d.n)+"}";default:b.error("Expected legal JavaScript")}}return function(a){var b,c=[];return d(a,c),b={r:c,s:e(this,a,c)}}}(Q,i),ob=function(a,b,c,d,e){var f,g,h=/^\s+/;return g=function(a){this.name="ParseError",this.message=a;try{throw new Error(a)}catch(b){this.stack=b.stack}},g.prototype=Error.prototype,f=function(a,b){var c,d;for(this.str=a,this.options=b||{},this.pos=0,this.init&&this.init(a,b),c=[];this.pos<this.str.length&&(d=this.read());)c.push(d);this.leftover=this.remaining(),this.result=this.postProcess?this.postProcess(c,b):c},f.prototype={read:function(a){var b,c,d,e;for(a||(a=this.converters),b=this.pos,d=a.length,c=0;d>c;c+=1)if(this.pos=b,e=a[c](this))return e;return null},readExpression:function(){return d(this)},flattenExpression:e,getLinePos:function(){var a,b,c,d,e,f;a=this.str.split("\n"),e=-1,d=0;do c=d,e++,b=a[e],d+=b.length+1;while(d<=this.pos);return f=this.pos-c,{line:e+1,ch:f+1,text:b,toJSON:function(){return[this.line,this.ch]},toString:function(){return"line "+this.line+" character "+this.ch+":\n"+this.text+"\n"+this.text.substr(0,this.ch-1).replace(/[\S]/g," ")+"^----"}}},error:function(a){var b,c;throw b=this.getLinePos(),c=a+" at "+b,new g(c)},matchString:function(a){return this.str.substr(this.pos,a.length)===a?(this.pos+=a.length,a):void 0},matchPattern:function(a){var b;return(b=a.exec(this.remaining()))?(this.pos+=b[0].length,b[1]||b[0]):void 0},allowWhitespace:function(){this.matchPattern(h)},remaining:function(){return this.str.substring(this.pos)},nextChar:function(){return this.str.charAt(this.pos)}},f.extend=function(a){var d,e,g=this;d=function(a,b){f.call(this,a,b)},d.prototype=b(g.prototype);for(e in a)c.call(a,e)&&(d.prototype[e]=a[e]);return d.extend=f.extend,d},a.Parser=f,f}(f,R,g,mb,nb),pb=function(){var a=/^[^\s=]+/,b=/^\s+/;return function(c){var d,e,f;return c.matchString("=")?(d=c.pos,c.allowWhitespace(),(e=c.matchPattern(a))?c.matchPattern(b)?(f=c.matchPattern(a))?(c.allowWhitespace(),c.matchString("=")?[e,f]:(c.pos=d,null)):(c.pos=d,null):null:(c.pos=d,null)):null}}(),qb=[{delimiters:"delimiters",isTriple:!1,isStatic:!1},{delimiters:"tripleDelimiters",isTriple:!0,isStatic:!1},{delimiters:"staticDelimiters",isTriple:!1,isStatic:!0},{delimiters:"staticTripleDelimiters",isTriple:!0,isStatic:!0}],rb=function(a){var b={"#":a.SECTION,"^":a.INVERTED,"/":a.CLOSING,">":a.PARTIAL,"!":a.COMMENT,"&":a.TRIPLE};return function(a){var c=b[a.str.charAt(a.pos)];return c?(a.pos+=1,c):null}}(Q),sb=function(a){return{"if":a.SECTION_IF,unless:a.SECTION_UNLESS,"with":a.SECTION_WITH,each:a.SECTION_EACH}}(Q),tb=null,ub=function(a,b,c){function d(b,c){for(var d,e=[];c.t===a.MEMBER&&c.r.t===a.REFINEMENT;)d=c.r,e.unshift(d.x?d.x.t===a.REFERENCE?d.x:b.flattenExpression(d.x):d.n),c=c.x;return c.t!==a.REFERENCE?null:{r:c.n,m:e}}var e,f=/^\s*:\s*([a-zA-Z_$][a-zA-Z_$0-9]*)/,g=/^[0-9][1-9]*$/,h=new RegExp("^("+Object.keys(c).join("|")+")\\b");return e=/^[a-zA-Z$_0-9]+(?:(\.[a-zA-Z$_0-9]+)|(\[[a-zA-Z$_0-9]+\]))*$/,function(c,i){var j,k,l,m,n,o,p,q,r,s,t;if(j=c.pos,l={},s=c[i.delimiters],i.isStatic&&(l.s=!0),i.isTriple)l.t=a.TRIPLE;else if("!"===c.remaining()[0]&&(o=c.readExpression())&&(l.t=a.INTERPOLATOR,c.allowWhitespace(),c.matchString(s[1])?c.pos-=s[1].length:(c.pos=j,o=null)),!o)if(m=b(c),l.t=m||a.INTERPOLATOR,m===a.SECTION)(n=c.matchPattern(h))&&(l.n=n),c.allowWhitespace();else if((m===a.COMMENT||m===a.CLOSING)&&(q=c.remaining(),r=q.indexOf(s[1]),-1!==r))return l.r=q.substr(0,r),c.pos+=r,l;if(!o&&(c.allowWhitespace(),o=c.readExpression(),q=c.remaining(),q.substr(0,s[1].length)!==s[1]&&":"!==q.charAt(0))){if(k=c.pos,c.pos=j,q=c.remaining(),r=q.indexOf(s[1]),-1!==r)return l.r=q.substr(0,r).trim(),e.test(l.r)||c.error("Expected a legal Mustache reference"),c.pos+=r,l;c.pos=k}if(o){for(;o.t===a.BRACKETED&&o.x;)o=o.x;o.t===a.REFERENCE?l.r=o.n:o.t===a.NUMBER_LITERAL&&g.test(o.v)?l.r=o.v:(t=d(c,o))?l.rx=t:l.x=c.flattenExpression(o)}return(p=c.matchPattern(f))&&(l.i=p),l}}(Q,rb,sb,tb),vb=function(a,b,c,d,e){function f(a){var b;return b=c.slice().sort(function(b,c){return a[c.delimiters][0].length-a[b.delimiters][0].length}),function d(c){return c?g(a,c)||d(b.shift()):null}(b.shift())}function g(c,f){var g,i,j,m,n,o,p,q,r,s;if(g=c.pos,i=c.getLinePos(),m=c[f.delimiters],!c.matchString(m[0]))return null;if(j=b(c))return c.matchString(m[1])?(c[f.delimiters]=j,l):null;if(c.allowWhitespace(),j=d(c,f),null===j)return c.pos=g,null;if(c.allowWhitespace(),c.matchString(m[1])||c.error("Expected closing delimiter '"+m[1]+"' after reference"),j.t===a.COMMENT&&(j.exclude=!0),j.t===a.CLOSING&&(c.sectionDepth-=1,c.sectionDepth<0&&(c.pos=g,c.error("Attempted to close a section that wasn't open"))),k(j)){for(c.sectionDepth+=1,n=[],q=n,o=j.n;r=c.read();){if(r.t===a.CLOSING){o&&r.r!==o&&c.error("Expected {{/"+o+"}}");break}if(r.t===a.INTERPOLATOR&&"else"===r.r)switch(j.n){case"unless":c.error("{{else}} not allowed in {{#unless}}");break;case"with":c.error("{{else}} not allowed in {{#with}}");break;default:q=p=[];continue}q.push(r)}n.length&&(j.f=n,!j.i&&"each"===j.n&&(s=h(j.f))&&(j.i=s)),p&&p.length&&(j.l=p)}return c.includeLinePositions&&(j.p=i.toJSON()),j.n?j.n=e[j.n]:j.t===a.INVERTED&&(j.t=a.SECTION,j.n=a.SECTION_UNLESS),j}function h(b){var c,d,e;for(c=b.length;c--;){if(d=b[c],d.t===a.ELEMENT&&d.f&&(e=h(d.f)))return e;if(d.t===a.INTERPOLATOR||d.t===a.TRIPLE||d.t===a.SECTION){if(d.r&&m.test(d.r))return d.r;if(d.x&&(e=i(d.x)))return e;if(d.rx&&(e=j(d.rx)))return e}}}function i(a){var b;for(b=a.r.length;b--;)if(m.test(a.r[b]))return a.r[b]}function j(b){var c,d,e;for(c=b.m.length;c--;){if(e=b.m[c],e.r&&(d=i(e)))return d;if(e.t===a.REFERENCE&&m.test(e.n))return e.n}}function k(b){return b.t===a.SECTION||b.t===a.INVERTED}var l={t:a.DELIMCHANGE,exclude:!0},m=/^@(?:index|key)$/;return f}(Q,pb,qb,ub,sb),wb=function(a){var b="<!--",c="-->";return function(d){var e,f,g,h,i;return e=d.getLinePos(),d.matchString(b)?(g=d.remaining(),h=g.indexOf(c),-1===h&&d.error("Illegal HTML - expected closing comment sequence ('-->')"),f=g.substr(0,h),d.pos+=h+3,i={t:a.COMMENT,c:f},d.includeLinePositions&&(i.p=e.toJSON()),i):null}}(Q),xb=function(){var a=/^(?:area|base|br|col|command|doctype|embed|hr|img|input|keygen|link|meta|param|source|track|wbr)$/i;return a}(),yb=function(a,b){var c,d,e;for(c=b.length;c--;){if(d=a.indexOf(b[c]),!d)return 0;-1!==d&&(!e||e>d)&&(e=d)}return e||-1},zb=function(){function a(a){return a?10===a?32:128>a?a:159>=a?c[a-128]:55296>a?a:57343>=a?65533:65535>=a?a:65533:65533}var b,c,d,e,f;return b={quot:34,amp:38,apos:39,lt:60,gt:62,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,copy:169,ordf:170,laquo:171,not:172,shy:173,reg:174,macr:175,deg:176,plusmn:177,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,sup1:185,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,Agrave:192,Aacute:193,Acirc:194,Atilde:195,Auml:196,Aring:197,AElig:198,Ccedil:199,Egrave:200,Eacute:201,Ecirc:202,Euml:203,Igrave:204,Iacute:205,Icirc:206,Iuml:207,ETH:208,Ntilde:209,Ograve:210,Oacute:211,Ocirc:212,Otilde:213,Ouml:214,times:215,Oslash:216,Ugrave:217,Uacute:218,Ucirc:219,Uuml:220,Yacute:221,THORN:222,szlig:223,agrave:224,aacute:225,acirc:226,atilde:227,auml:228,aring:229,aelig:230,ccedil:231,egrave:232,eacute:233,ecirc:234,euml:235,igrave:236,iacute:237,icirc:238,iuml:239,eth:240,ntilde:241,ograve:242,oacute:243,ocirc:244,otilde:245,ouml:246,divide:247,oslash:248,ugrave:249,uacute:250,ucirc:251,uuml:252,yacute:253,thorn:254,yuml:255,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,"int":8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},c=[8364,129,8218,402,8222,8230,8224,8225,710,8240,352,8249,338,141,381,143,144,8216,8217,8220,8221,8226,8211,8212,732,8482,353,8250,339,157,382,376],d=new RegExp("&("+Object.keys(b).join("|")+");?","g"),e=/&#x([0-9]+);?/g,f=/&#([0-9]+);?/g,function(c){var g;return g=c.replace(d,function(a,c){return b[c]?String.fromCharCode(b[c]):a}),g=g.replace(e,function(b,c){return String.fromCharCode(a(parseInt(c,16)))}),g=g.replace(f,function(b,c){return String.fromCharCode(a(c))})}}(tb),Ab=function(a,b){return function(c){var d,e,f,g;return e=c.remaining(),g=c.inside?"</"+c.inside:"<",c.inside&&!c.interpolate[c.inside]?d=e.indexOf(g):(f=[g,c.delimiters[0],c.tripleDelimiters[0],c.staticDelimiters[0],c.staticTripleDelimiters[0]],c.inAttribute===!0?f.push('"',"'","=",">","`"):c.inAttribute&&f.push(c.inAttribute),d=a(e,f)),d?(-1===d&&(d=e.length),c.pos+=d,b(e.substr(0,d))):null}}(yb,zb),Bb=function(a){var b=/^([a-zA-Z]{1,}:?[a-zA-Z0-9\-]*)\s*\>/;return function(c){var d;return c.matchString("</")?(d=c.matchPattern(b))?{t:a.CLOSING_TAG,e:d}:(c.pos-=2,void c.error("Illegal closing tag")):null}}(Q),Cb=function(a,b){function c(a){var b,c,e;return a.allowWhitespace(),(c=a.matchPattern(i))?(b={name:c},e=d(a),e&&(b.value=e),b):null}function d(a){var b,c,d,e;return b=a.pos,a.allowWhitespace(),a.matchString("=")?(a.allowWhitespace(),c=a.pos,d=a.sectionDepth,e=g(a,"'")||g(a,'"')||f(a),a.sectionDepth!==d&&(a.pos=c,a.error("An attribute value must contain as many opening section tags as closing section tags")),null===e?(a.pos=b,null):1===e.length&&"string"==typeof e[0]?e[0]:e):(a.pos=b,null)}function e(a){var b,c,d;return b=a.pos,(c=a.matchPattern(j))?(-1!==(d=c.indexOf(a.delimiters[0]))&&(c=c.substr(0,d),a.pos=b+c.length),c):null}function f(a){var c,d;for(a.inAttribute=!0,c=[],d=b(a)||e(a);null!==d;)c.push(d),d=b(a)||e(a);return c.length?(a.inAttribute=!1,c):null}function g(a,c){var d,e,f;if(d=a.pos,!a.matchString(c))return null;for(a.inAttribute=c,e=[],f=b(a)||h(a,c);null!==f;)e.push(f),f=b(a)||h(a,c);return a.matchString(c)?(a.inAttribute=!1,e):(a.pos=d,null)}function h(b,c){var d,e,f;return d=b.pos,f=b.remaining(),e=a(f,[c,b.delimiters[0],b.delimiters[1]]),-1===e&&b.error("Quoted attribute value must have a closing quote"),e?(b.pos+=e,f.substr(0,e)):null}var i=/^[^\s"'>\/=]+/,j=/^[^\s"'=<>`]+/;return c}(yb,vb),Db=function(a,b,c){function d(a){var b,d,e;return a.allowWhitespace(),(b=c(a))?(e={key:b},a.allowWhitespace(),a.matchString(":")?(a.allowWhitespace(),(d=a.read())?(e.value=d.v,e):null):null):null}var e,f,g,h,i,j,k;return f={"true":!0,"false":!1,undefined:void 0,"null":null},g=new RegExp("^(?:"+Object.keys(f).join("|")+")"),h=/^(?:[+-]?)(?:(?:(?:0|[1-9]\d*)?\.\d+)|(?:(?:0|[1-9]\d*)\.)|(?:0|[1-9]\d*))(?:[eE][+-]?\d+)?/,i=/\$\{([^\}]+)\}/g,j=/^\$\{([^\}]+)\}/,k=/^\s*$/,e=a.extend({init:function(a,b){this.values=b.values},postProcess:function(a){return 1===a.length&&k.test(this.leftover)?{value:a[0].v}:null},converters:[function(a){var b;return a.values?(b=a.matchPattern(j),b&&a.values.hasOwnProperty(b)?{v:a.values[b]}:void 0):null},function(a){var b;return(b=a.matchPattern(g))?{v:f[b]}:void 0},function(a){var b;return(b=a.matchPattern(h))?{v:+b}:void 0},function(a){var c,d=b(a);return d&&(c=a.values)?{v:d.v.replace(i,function(a,b){return b in c?c[b]:b})}:d},function(a){var b,c;if(!a.matchString("{"))return null;if(b={},a.allowWhitespace(),a.matchString("}"))return{v:b};for(;c=d(a);){if(b[c.key]=c.value,a.allowWhitespace(),a.matchString("}"))return{v:b};if(!a.matchString(","))return null}return null},function(a){var b,c;if(!a.matchString("["))return null;if(b=[],a.allowWhitespace(),a.matchString("]"))return{v:b};for(;c=a.read();){if(b.push(c.v),a.allowWhitespace(),a.matchString("]"))return{v:b};if(!a.matchString(","))return null;a.allowWhitespace()}return null}]}),function(a,b){var c=new e(a,{values:b});return c.result}}(ob,Y,$),Eb=function(a){return function(b){var c,d,e,f,g,h;if("string"==typeof b){if(-1===b.indexOf(":"))return b.trim();b=[b]}for(c={},f=[],g=[];b.length;)if(d=b.shift(),"string"==typeof d){if(e=d.indexOf(":"),-1!==e){e&&f.push(d.substr(0,e)),d.length>e+1&&(g[0]=d.substring(e+1));break}f.push(d)}else f.push(d);return g=g.concat(b),g.length||"string"!=typeof f?(c={n:1===f.length&&"string"==typeof f[0]?f[0]:f},1===g.length&&"string"==typeof g[0]?(h=a("["+g[0]+"]"),c.a=h?h.value:g[0].trim()):c.d=g):c=f,c
}}(Db),Fb=function(a,b,c,d,e,f,g,h){function i(c){var d,e,f,i,r,s,t,u,v,w,x,y;if(d=c.pos,e=c.getLinePos(),c.inside)return null;if(!c.matchString("<"))return null;if("/"===c.nextChar())return null;if(f={t:a.ELEMENT},c.includeLinePositions&&(f.p=e.toJSON()),c.matchString("!")&&(f.y=1),f.e=c.matchPattern(k),!f.e)return null;for(l.test(c.nextChar())||c.error("Illegal tag name"),t=function(a,b){var d=b.n||b;o.test(d)&&(c.pos-=d.length,c.error("Cannot use reserved event names (change, reset, teardown, update)")),f.v[a]=b};u=g(c);)(r=p[u.name])?f[r]=h(u.value):(s=n.exec(u.name))?(f.v||(f.v={}),v=h(u.value),t(s[1],v)):c.sanitizeEventAttributes&&m.test(u.name)||(f.a||(f.a={}),f.a[u.name]=u.value||0);if(c.allowWhitespace(),c.matchString("/")&&(w=!0),!c.matchString(">"))return null;if(i=f.e.toLowerCase(),!w&&!b.test(f.e)){for(("script"===i||"style"===i)&&(c.inside=i),x=[];(y=c.read(j))&&y.t!==a.CLOSING&&y.t!==a.CLOSING_TAG;)x.push(y);x.length&&(f.f=x)}return c.inside=null,c.sanitizeElements&&-1!==c.sanitizeElements.indexOf(i)?q:f}var j,k=/^[a-zA-Z]{1,}:?[a-zA-Z0-9\-]*/,l=/^[\s\n\/>]/,m=/^on/,n=/^on-([a-zA-Z$_][a-zA-Z$_0-9\-]+)$/,o=/^(?:change|reset|teardown|update)$/,p={"intro-outro":"t0",intro:"t1",outro:"t2",decorator:"o"},q={exclude:!0};return j=[c,d,i,e,f],i}(Q,xb,vb,wb,Ab,Bb,Cb,Eb),Gb=function(){var a=/^[ \t\f\r\n]+/,b=/[ \t\f\r\n]+$/;return function(c,d,e){var f;d&&(f=c[0],"string"==typeof f&&(f=f.replace(a,""),f?c[0]=f:c.shift())),e&&(f=c[c.length-1],"string"==typeof f&&(f=f.replace(b,""),f?c[c.length-1]=f:c.pop()))}}(),Hb=function(a){function b(a){return"string"==typeof a}function c(b){return b.t===a.COMMENT||b.t===a.DELIMCHANGE}function d(b){return(b.t===a.SECTION||b.t===a.INVERTED)&&b.f}var e=/^\s*\r?\n/,f=/\r?\n\s*$/;return function(a){var g,h,i,j,k;for(g=1;g<a.length;g+=1)h=a[g],i=a[g-1],j=a[g-2],b(h)&&c(i)&&b(j)&&f.test(j)&&e.test(h)&&(a[g-2]=j.replace(f,"\n"),a[g]=h.replace(e,"")),d(h)&&b(i)&&f.test(i)&&b(h.f[0])&&e.test(h.f[0])&&(a[g-1]=i.replace(f,"\n"),h.f[0]=h.f[0].replace(e,"")),b(h)&&d(i)&&(k=i.f[i.f.length-1],b(k)&&f.test(k)&&e.test(h)&&(i.f[i.f.length-1]=k.replace(f,"\n"),a[g]=h.replace(e,"")));return a}}(Q),Ib=function(a,b,c,d,e,f,g,h){function i(b,c,d,e,f,j){var k,m,n,r,s,t,u,v,w;for(h(b),k=b.length;k--;)m=b[k],m.exclude?b.splice(k,1):c&&m.t===a.COMMENT&&b.splice(k,1);for(g(b,e,f),k=b.length;k--;)if(m=b[k],m.f&&(s=d||m.t===a.ELEMENT&&o.test(m.e),s||(n=b[k-1],r=b[k+1],(!n||"string"==typeof n&&q.test(n))&&(t=!0),(!r||"string"==typeof r&&p.test(r))&&(u=!0)),i(m.f,c,s,t,u,j),m.l&&(i(m.l,c,d,t,u,j),j&&(v={t:4,n:a.SECTION_UNLESS,f:m.l},m.r&&(v.r=m.r),m.x&&(v.x=m.x),m.rx&&(v.rx=m.rx),b.splice(k+1,0,v),delete m.l))),m.a)for(w in m.a)m.a.hasOwnProperty(w)&&"string"!=typeof m.a[w]&&i(m.a[w],c,d,j);for(k=b.length;k--;)"string"==typeof b[k]&&("string"==typeof b[k+1]&&(b[k]=b[k]+b[k+1],b.splice(k+1,1)),d||(b[k]=b[k].replace(l," ")),""===b[k]&&b.splice(k,1))}var j,k,l=/[ \t\f\r\n]+/g,m=/<!--\s*\{\{\s*>\s*([a-zA-Z_$][a-zA-Z_$0-9]*)\s*}\}\s*-->/,n=/<!--\s*\{\{\s*\/\s*([a-zA-Z_$][a-zA-Z_$0-9]*)\s*}\}\s*-->/,o=/^(?:pre|script|style|textarea)$/i,p=/^\s+/,q=/\s+$/;return j=b.extend({init:function(a,b){this.delimiters=b.delimiters||["{{","}}"],this.tripleDelimiters=b.tripleDelimiters||["{{{","}}}"],this.staticDelimiters=b.staticDelimiters||["[[","]]"],this.staticTripleDelimiters=b.staticTripleDelimiters||["[[[","]]]"],this.sectionDepth=0,this.interpolate={script:!b.interpolate||b.interpolate.script!==!1,style:!b.interpolate||b.interpolate.style!==!1},b.sanitize===!0&&(b.sanitize={elements:"applet base basefont body frame frameset head html isindex link meta noframes noscript object param script style title".split(" "),eventAttributes:!0}),this.sanitizeElements=b.sanitize&&b.sanitize.elements,this.sanitizeEventAttributes=b.sanitize&&b.sanitize.eventAttributes,this.includeLinePositions=b.includeLinePositions},postProcess:function(a,b){return this.sectionDepth>0&&this.error("A section was left open"),i(a,b.stripComments!==!1,b.preserveWhitespace,!b.preserveWhitespace,!b.preserveWhitespace,b.rewriteElse!==!1),a},converters:[c,d,e,f]}),k=function(a){var b=arguments[1];void 0===b&&(b={});var c,d,e,f,g,h;if(c={v:1},m.test(a)){for(d=a,a="";g=m.exec(d);){if(f=g[1],a+=d.substr(0,g.index),d=d.substring(g.index+g[0].length),h=n.exec(d),!h||h[1]!==f)throw new Error("Inline partials must have a closing delimiter, and cannot be nested");(e||(e={}))[f]=new j(d.substr(0,h.index),b).result,d=d.substring(h.index+h[0].length)}c.p=e}return c.t=new j(a,b).result,c}}(Q,ob,vb,wb,Fb,Ab,Gb,Hb),Jb=function(){return function(a,b){var c=a.map(b);return a.forEach(function(a,b){c[a]=c[b]}),c}}(tb),Kb=function(a){var b,c;return b=["preserveWhitespace","sanitize","stripComments","delimiters","tripleDelimiters"],c=a(b,function(a){return a})}(Jb),Lb=function(a,b,c,d,e){function f(a){var b=d(l);return b.parse=function(b,c){return g(b,c||a)},b}function g(b,d){if(!c)throw new Error(a.missingParser);return c(b,d||this.options)}function h(a,c){var d;if(!b){if(c&&c.noThrow)return;throw new Error("Cannot retrieve template #"+a+" as Ractive is not running in a browser.")}if(i(a)&&(a=a.substring(1)),!(d=document.getElementById(a))){if(c&&c.noThrow)return;throw new Error("Could not find template element with id #"+a)}return d.innerHTML}function i(a){return"#"===a.charAt(0)}function j(a){return!("string"==typeof a)}function k(a){return a.defaults&&(a=a.defaults),e.reduce(function(b,c){return b[c]=a[c],b},{})}var l={parse:g,fromId:h,isHashedId:i,isParsed:j,getParseOptions:k,createHelper:f};return l}(P,A,Ib,R,Kb),Mb=function(a,b){function c(a){var b,c=a._config.template;if(c&&c.fn)return b=d(a,c.fn),b!==c.result?(c.result=b,b=e(b,a)):void 0}function d(b,c){var d=a.createHelper(a.getParseOptions(b));return c.call(b,b.data,d)}function e(c,d){if("string"==typeof c)"#"===c[0]&&(c=a.fromId(c)),c=b(c,a.getParseOptions(d));else if(1!==c.v)throw new Error("Mismatched template version! Please ensure you are using the latest version of Ractive.js in your build process as well as in your app");return c}function f(a,b,c){if(b)for(var d in b)(c||!a.hasOwnProperty(d))&&(a[d]=b[d])}var g={name:"template",extend:function(a,b,c){var d;"template"in c&&(d=c.template,b.template="function"==typeof d?d:e(d,b))},init:function(a,b,c){var g,h;g="template"in c?c.template:a.prototype.template,"function"==typeof g&&(h=g,g=d(b,h),b._config.template={fn:h,result:g}),g=e(g,b),b.template=g.t,g.p&&f(b.partials,g.p)},reset:function(a){var b,d=c(a);return d?(b=e(d,a),a.template=b.t,f(a.partials,b.p,!0),!0):void 0}};return g}(Lb,Ib),Nb=function(a){function b(a,b){this.name=a,this.useDefaults=b}function c(a,b){var d,e;return(d=b(a))?d:!a.isolated&&(e=a._parent)?c(e,b):void 0}return b.prototype={constructor:b,extend:function(a,b,c){this.configure(this.useDefaults?a.defaults:a,this.useDefaults?b:b.constructor,c)},init:function(a,b,c){this.configure(this.useDefaults?a.defaults:a,b,c)},configure:function(b,c,d){var e,f=this.name,g=d[f];e=a(b[f]);for(var h in g)e[h]=g[h];c[f]=e},reset:function(a){var b=a[this.name],c=!1;return Object.keys(b).forEach(function(a){var d=b[a];d._fn&&(d._fn.isOwner?b[a]=d._fn:delete b[a],c=!0)}),c},findOwner:function(a,b){return a[this.name].hasOwnProperty(b)?a:this.findConstructor(a.constructor,b)},findConstructor:function(a,b){return a?a[this.name].hasOwnProperty(b)?a:this.findConstructor(a._parent,b):void 0},find:function(a,b){var d=this;return c(a,function(a){return a[d.name][b]})},findInstance:function(a,b){var d=this;return c(a,function(a){return a[d.name][b]?a:void 0})}},b}(R,tb),Ob=function(a,b){var c=["adaptors","components","computed","decorators","easing","events","interpolators","partials","transitions"],d=a(c,function(a){return new b(a,"computed"===a)});return d}(Jb,Nb),Pb=function(){},Qb=function(a){function b(b,c){var d;if(c in b){var e=b[c];d="function"==typeof e?e:function(){return e}}else d=a;return d}return function(a,c,d){if(!/_super/.test(d))return d;var e=function(){var a,f=b(e._parent,c),g="_super"in this,h=this._super;return this._super=f,a=d.apply(this,arguments),g?this._super=h:delete this._super,a};return e._parent=a,e._method=d,e}}(Pb),Rb=function(a,b){function c(b,c,e){if(c in b){if(e in b)throw new Error(d(c,e,!0));a(d(c,e)),b[e]=b[c]}}function d(a,b,c){return"options."+a+" has been deprecated in favour of options."+b+"."+(c?" You cannot specify both options, please use options."+b+".":"")}function e(a){c(a,"eventDefinitions","events")}function f(a){b(a.adaptors)&&c(a,"adaptors","adapt")}return function(a){e(a),f(a)}}(K,h),Sb=function(a,b,c,d,e,f,g,h){function i(a,b,c,d,e){k[b][a](c,d,e)}function j(a,b,d,e){h(e),i(a,"data",b,d,e),m.parseOptions.forEach(function(a){a in e&&(d[a]=e[a])});for(var f in e)if(f in c&&!(f in m.parseOptions)&&!(f in k)){var j=e[f];d[f]="function"==typeof j?g(b.prototype,f,j):j}m.registries.forEach(function(c){c[a](b,d,e)}),i(a,"template",b,d,e),i(a,"css",b,d,e)}var k,l,m;k={data:b,template:d,css:a},l=Object.keys(c).filter(function(a){return!f[a]&&!k[a]&&!e[a]}),m=[].concat(k.data,e,l,f,k.template,k.css);for(var n in k)m[n]=k[n];return m.keys=Object.keys(c).concat(f.map(function(a){return a.name})).concat(["css"]),m.parseOptions=e,m.registries=f,m.extend=function(a,b,c){j("extend",a,b,c)},m.init=function(a,b,c){j("init",a,b,c),b._config&&(b._config.options=c)},m.reset=function(a){return m.filter(function(b){return b.reset&&b.reset(a)}).map(function(a){return a.name})},m}(M,O,d,Mb,Kb,Ob,Qb,Rb),Tb=function(a,b,c,d){function e(a){return function(){return a}}var f=function(a,f,g,h){if(a===f)return e(f);if(h){var i=d.registries.interpolators.find(g,h);if(i)return i(a,f)||e(f);b('Missing "'+h+'" interpolator. You may need to download a plugin from [TODO]')}return c.number(a,f)||c.array(a,f)||c.object(a,f)||c.cssLength(a,f)||e(f)};return a.interpolate=f,f}(f,K,k,Sb),Ub=function(a,b,c){var d=function(a){var b;this.startTime=Date.now();for(b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);this.interpolator=c(this.from,this.to,this.root,this.interpolator),this.running=!0};return d.prototype={tick:function(){var c,d,e,f,g,h;return h=this.keypath,this.running?(f=Date.now(),c=f-this.startTime,c>=this.duration?(null!==h&&(b.start(this.root),this.root.viewmodel.set(h,this.to),b.end()),this.step&&this.step(1,this.to),this.complete(this.to),g=this.root._animations.indexOf(this),-1===g&&a("Animation was not found"),this.root._animations.splice(g,1),this.running=!1,!1):(d=this.easing?this.easing(c/this.duration):c/this.duration,null!==h&&(e=this.interpolator(d),b.start(this.root),this.root.viewmodel.set(h,e),b.end()),this.step&&this.step(d,e),!0)):!1},stop:function(){var b;this.running=!1,b=this.root._animations.indexOf(this),-1===b&&a("Animation was not found"),this.root._animations.splice(b,1)}},d}(K,u,Tb),Vb=function(a,b,c,d,e){function f(b,f,g,i){var j,k,l,m;return f&&(f=c(f)),null!==f&&(m=b.viewmodel.get(f)),d.abort(f,b),a(m,g)?(i.complete&&i.complete(i.to),h):(i.easing&&(j="function"==typeof i.easing?i.easing:b.easing[i.easing],"function"!=typeof j&&(j=null)),k=void 0===i.duration?400:i.duration,l=new e({keypath:f,from:m,to:g,root:b,duration:k,easing:j,interpolator:i.interpolator,step:i.step,complete:i.complete}),d.add(l),b._animations.push(l),l)}var g=function(){},h={stop:g};return function(a,c,d){var e,h,i,j,k,l,m,n,o,p,q,r,s,t;if(e=new b(function(a){h=a}),"object"==typeof a){d=c||{},l=d.easing,m=d.duration,k=[],n=d.step,o=d.complete,(n||o)&&(q={},d.step=null,d.complete=null,p=function(a){return function(b,c){q[a]=c}});for(i in a)a.hasOwnProperty(i)&&((n||o)&&(r=p(i),d={easing:l,duration:m},n&&(d.step=r)),d.complete=o?r:g,k.push(f(this,i,a[i],d)));return(n||o)&&(t={easing:l,duration:m},n&&(t.step=function(a){n(a,q)}),o&&e.then(function(a){o(a,q)}),t.complete=h,s=f(this,null,null,t),k.push(s)),{stop:function(){for(var a;a=k.pop();)a.stop();s&&s.stop()}}}return d=d||{},d.complete&&e.then(d.complete),d.complete=h,j=f(this,a,c,d),e.stop=function(){j.stop()},e}}(q,n,F,J,Ub),Wb=function(a){return function(){return this.el&&a(this.el.__ractive_instances__,this),this.fragment.detach()}}(m),Xb=function(a){return this.el?this.fragment.find(a):null},Yb=function(a,b,c){var d,e,f,g,h,i,j,k;if(a){for(e=c("div"),f=["matches","matchesSelector"],k=function(a){return function(b,c){return b[a](c)}},i=f.length;i--&&!d;)if(g=f[i],e[g])d=k(g);else for(j=b.length;j--;)if(h=b[i]+g.substr(0,1).toUpperCase()+g.substring(1),e[h]){d=k(h);break}d||(d=function(a,b){var c,d,f;for(d=a.parentNode,d||(e.innerHTML="",d=e,a=a.cloneNode(),e.appendChild(a)),c=d.querySelectorAll(b),f=c.length;f--;)if(c[f]===a)return!0;return!1})}else d=null;return d}(A,G,z),Zb=function(a){return function(b,c){var d=this._isComponentQuery?!this.selector||b.name===this.selector:a(b.node,this.selector);return d?(this.push(b.node||b.instance),c||this._makeDirty(),!0):void 0}}(Yb),$b=function(){var a,b,c;a=this._root[this._isComponentQuery?"liveComponentQueries":"liveQueries"],b=this.selector,c=a.indexOf(b),-1!==c&&(a.splice(c,1),a[b]=null)},_b=function(){function a(a){var b;return(b=a.parentFragment)?b.owner:a.component&&(b=a.component.parentFragment)?b.owner:void 0}function b(b){var c,d;for(c=[b],d=a(b);d;)c.push(d),d=a(d);return c}return function(a,c){var d,e,f,g,h,i,j,k,l,m;for(d=b(a.component||a._ractive.proxy),e=b(c.component||c._ractive.proxy),f=d[d.length-1],g=e[e.length-1];f&&f===g;)d.pop(),e.pop(),h=f,f=d[d.length-1],g=e[e.length-1];if(f=f.component||f,g=g.component||g,l=f.parentFragment,m=g.parentFragment,l===m)return i=l.items.indexOf(f),j=m.items.indexOf(g),i-j||d.length-e.length;if(k=h.fragments)return i=k.indexOf(l),j=k.indexOf(m),i-j||d.length-e.length;throw new Error("An unexpected condition was met while comparing the position of two components. Please file an issue at https://github.com/RactiveJS/Ractive/issues - thanks!")}}(),ac=function(a){return function(b,c){var d;return b.compareDocumentPosition?(d=b.compareDocumentPosition(c),2&d?1:-1):a(b,c)}}(_b),bc=function(a,b){return function(){this.sort(this._isComponentQuery?b:a),this._dirty=!1}}(ac,_b),cc=function(a){return function(){var b=this;this._dirty||(this._dirty=!0,a.scheduleTask(function(){b._sort()}))}}(u),dc=function(a){var b=this.indexOf(this._isComponentQuery?a.instance:a);-1!==b&&this.splice(b,1)},ec=function(a,b,c,d,e,f){return function(g,h,i,j){var k=[];return a(k,{selector:{value:h},live:{value:i},_isComponentQuery:{value:j},_test:{value:b}}),i?(a(k,{cancel:{value:c},_root:{value:g},_sort:{value:d},_makeDirty:{value:e},_remove:{value:f},_dirty:{value:!1,writable:!0}}),k):k}}(C,Zb,$b,bc,cc,dc),fc=function(a){return function(b,c){var d,e;return this.el?(c=c||{},d=this._liveQueries,(e=d[b])?c&&c.live?e:e.slice():(e=a(this,b,!!c.live,!1),e.live&&(d.push(b),d["_"+b]=e),this.fragment.findAll(b,e),e)):[]}}(ec),gc=function(a){return function(b,c){var d,e;return c=c||{},d=this._liveComponentQueries,(e=d[b])?c&&c.live?e:e.slice():(e=a(this,b,!!c.live,!0),e.live&&(d.push(b),d["_"+b]=e),this.fragment.findAllComponents(b,e),e)}}(ec),hc=function(a){return this.fragment.findComponent(a)},ic=function(a){var b,c,d,e=this._subs[a];if(e)for(b=Array.prototype.slice.call(arguments,1),c=0,d=e.length;d>c;c+=1)e[c].apply(this,b)},jc=function(a){var b={capture:!0};return function(c){return c=a(c),this.viewmodel.get(c,b)}}(F),kc=function(a){var b;if(a&&"boolean"!=typeof a)return"undefined"!=typeof window&&document&&a?a.nodeType?a:"string"==typeof a&&(b=document.getElementById(a),!b&&document.querySelector&&(b=document.querySelector(a)),b&&b.nodeType)?b:a[0]&&a[0].nodeType?a[0]:null:null},lc=function(a){return function(b,c){if(!this.rendered)throw new Error("The API has changed - you must call `ractive.render(target[, anchor])` to render your Ractive instance. Once rendered you can use `ractive.insert()`.");if(b=a(b),c=a(c)||null,!b)throw new Error("You must specify a valid target to insert into");b.insertBefore(this.detach(),c),this.el=b,(b.__ractive_instances__||(b.__ractive_instances__=[])).push(this)}}(kc),mc=function(a,b,c){return function(d,e,f){var g,h;return d=c(d),g=this.viewmodel.get(d),b(g)&&b(e)?(h=a.start(this,!0),this.viewmodel.merge(d,g,e,f),a.end(),f&&f.complete&&h.then(f.complete),h):this.set(d,e,f&&f.complete)}}(u,h,F),nc=function(a,b){var c=function(a,b,c,d){this.root=a,this.keypath=b,this.callback=c,this.defer=d.defer,this.priority=0,this.context=d&&d.context?d.context:a};return c.prototype={init:function(a){this.value=this.root.viewmodel.get(this.keypath),a!==!1&&this.update()},setValue:function(c){var d=this;b(c,this.value)||(this.value=c,this.defer&&this.ready?a.scheduleTask(function(){return d.update()}):this.update())},update:function(){this.updating||(this.updating=!0,this.callback.call(this.context,this.value,this.oldValue,this.keypath),this.oldValue=this.value,this.updating=!1)}},c}(u,q),oc=function(a){return function(b,c){function d(c,d){var e,f,g;e=b.viewmodel.wrapped[d]?b.viewmodel.wrapped[d].get():b.get(d);for(f in e)!e.hasOwnProperty(f)||"_ractive"===f&&a(e)||(g=d?d+"."+f:f,c.push(g));return c}function e(a){return function(b){return b?b+"."+a:a}}var f,g,h;for(f=c.split("."),h=[""];g=f.shift();)"*"===g?h=h.reduce(d,[]):""===h[0]?h[0]=g:h=h.map(e(g));return h}}(h),pc=function(a){return function(b,c){var d,e;return d=a(b,c),e={},d.forEach(function(a){e[a]=b.get(a)}),e}}(oc),qc=function(a,b,c){var d,e=/\*/,f=Array.prototype.slice;return d=function(a,b,c,d){this.root=a,this.callback=c,this.defer=d.defer,this.keypath=b,this.regex=new RegExp("^"+b.replace(/\./g,"\\.").replace(/\*/g,"([^\\.]+)")+"$"),this.values={},this.defer&&(this.proxies=[]),this.priority="pattern",this.context=d&&d.context?d.context:a},d.prototype={init:function(a){var b,d;if(b=c(this.root,this.keypath),a!==!1)for(d in b)b.hasOwnProperty(d)&&this.update(d);else this.values=b},update:function(b){var d;if(e.test(b)){d=c(this.root,b);for(b in d)d.hasOwnProperty(b)&&this.update(b)}else if(!this.root.viewmodel.implicitChanges[b])return this.defer&&this.ready?void a.addObserver(this.getProxy(b)):void this.reallyUpdate(b)},reallyUpdate:function(a){var c,d,e;return c=this.root.viewmodel.get(a),this.updating?void(this.values[a]=c):(this.updating=!0,b(c,this.values[a])&&this.ready||(d=f.call(this.regex.exec(a),1),e=[c,this.values[a],a].concat(d),this.callback.apply(this.context,e),this.values[a]=c),void(this.updating=!1))},getProxy:function(a){var b=this;return this.proxies[a]||(this.proxies[a]={update:function(){b.reallyUpdate(a)}}),this.proxies[a]}},d}(u,q,pc),rc=function(a,b,c){var d=/\*/,e={};return function(f,g,h,i){var j,k,l;return g=a(g),i=i||e,d.test(g)?(j=new c(f,g,h,i),f.viewmodel.patternObservers.push(j),k=!0):j=new b(f,g,h,i),f.viewmodel.register(g,j,k?"patternObservers":"observers"),j.init(i.init),j.ready=!0,{cancel:function(){var a;l||(k&&(a=f.viewmodel.patternObservers.indexOf(j),f.viewmodel.patternObservers.splice(a,1),f.viewmodel.unregister(g,j,"patternObservers")),f.viewmodel.unregister(g,j,"observers"),l=!0)}}}}(F,nc,qc),sc=function(a,b){return function(c,d,e){var f,g,h,i;if(a(c)){e=d,g=c,f=[];for(c in g)g.hasOwnProperty(c)&&(d=g[c],f.push(this.observe(c,d,e)));return{cancel:function(){for(;f.length;)f.pop().cancel()}}}if("function"==typeof c)return e=d,d=c,c="",b(this,c,d,e);if(h=c.split(" "),1===h.length)return b(this,c,d,e);for(f=[],i=h.length;i--;)c=h[i],c&&f.push(b(this,c,d,e));return{cancel:function(){for(;f.length;)f.pop().cancel()}}}}(i,rc),tc=function(a){return a.trim()},uc=function(a){return""!==a},vc=function(a,b){return function(c,d){var e,f=this;if(c)e=c.split(" ").map(a).filter(b),e.forEach(function(a){var b,c;(b=f._subs[a])&&(d?(c=b.indexOf(d),-1!==c&&b.splice(c,1)):f._subs[a]=[])});else for(c in this._subs)delete this._subs[c];return this}}(tc,uc),wc=function(a,b){return function(c,d){var e,f,g,h=this,i=this;if("object"==typeof c){e=[];for(f in c)c.hasOwnProperty(f)&&e.push(this.on(f,c[f]));return{cancel:function(){for(var a;a=e.pop();)a.cancel()}}}return g=c.split(" ").map(a).filter(b),g.forEach(function(a){(h._subs[a]||(h._subs[a]=[])).push(d)}),{cancel:function(){i.off(c,d)}}}}(tc,uc),xc=function(a,b,c){switch(b){case"splice":return c;case"sort":case"reverse":return null;case"pop":return a.length?[-1]:null;case"push":return[a.length,0].concat(c);case"shift":return[0,1];case"unshift":return[0,0].concat(c)}},yc=function(a,b){var c,d,e,f,g,h;return b?(c=+(b[0]<0?a.length+b[0]:b[0]),f=Math.max(0,b.length-2),g=void 0!==b[1]?b[1]:a.length-c,g=Math.min(g,a.length-c),h=f-g,e=a.length+h,d=h?Math.max(a.length,e):c+f,{rangeStart:c,rangeEnd:d,balance:h,added:f,removed:g}):null},zc=function(a,b,c,d){var e=Array.prototype;return function(f){return function(g){var h,i,j,k,l=Array.prototype.slice,m=l.call(arguments,1);if(h=this.get(g),!a(h))throw new Error("Called ractive."+f+"('"+g+"'), but '"+g+"' does not refer to an array");return i=c(h,f,m),j=d(h,i),e[f].apply(h,m),k=b.start(this,!0),j?this.viewmodel.splice(g,j):this.viewmodel.mark(g),b.end(),k}}}(h,u,xc,yc),Ac=function(a){return a("pop")}(zc),Bc=function(a){return a("push")}(zc),Cc=function(a,b,c){var d,e,f,g,h,i,j,k="/* Ractive.js component styles */\n",l={},m=[];return b?(a.push(function(){f=a.runloop}),g=document.createElement("style"),g.type="text/css",h=document.getElementsByTagName("head")[0],j=!1,i=g.styleSheet,e=function(){var a;m.length?(a=k+m.join(" "),i?i.cssText=a:g.innerHTML=a,j||(h.appendChild(g),j=!0)):j&&(h.removeChild(g),j=!1)},d={add:function(a){a.css&&(l[a._guid]||(l[a._guid]=0,m.push(a.css),f.scheduleTask(e)),l[a._guid]+=1)},remove:function(a){a.css&&(l[a._guid]-=1,l[a._guid]||(c(m,a.css),f.scheduleTask(e)))}}):d=null,d}(f,A,m),Dc=function(a,b,c){function d(a){a.init&&a.init(a._config.options),e(a).forEach(d),f[a._guid]=null}function e(a){return f[a._guid]||(f[a._guid]=[])}var f={},g={};return function(f,h){var i,j,k=this;if(g[this._guid]=!0,i=a.start(this,!0),this.rendered)throw new Error("You cannot call ractive.render() on an already rendered instance! Call ractive.unrender() first");return f=c(f)||this.el,h=c(h)||this.anchor,this.el=f,this.anchor=h,this.constructor.css&&b.add(this.constructor),f&&((j=f.__ractive_instances__)?j.push(this):f.__ractive_instances__=[this],h?f.insertBefore(this.fragment.render(),h):f.appendChild(this.fragment.render())),this._hasInited||(this._hasInited=!0,this._parent&&g[this._parent._guid]?e(this._parent).push(this):d(this)),g[this._guid]=!1,a.end(),this.rendered=!0,this.complete&&i.then(function(){return k.complete()}),i}}(u,Cc,kc),Ec=function(){this.dirtyValue=this.dirtyArgs=!0,this.inited&&this.owner.bubble&&this.owner.bubble()},Fc=function(){var a;return 1===this.items.length?this.items[0].detach():(a=document.createDocumentFragment(),this.items.forEach(function(b){a.appendChild(b.detach())}),a)},Gc=function(a){var b,c,d,e;if(this.items){for(c=this.items.length,b=0;c>b;b+=1)if(d=this.items[b],d.find&&(e=d.find(a)))return e;return null}},Hc=function(a,b){var c,d,e;if(this.items)for(d=this.items.length,c=0;d>c;c+=1)e=this.items[c],e.findAll&&e.findAll(a,b);return b},Ic=function(a,b){var c,d,e;if(this.items)for(d=this.items.length,c=0;d>c;c+=1)e=this.items[c],e.findAllComponents&&e.findAllComponents(a,b);return b},Jc=function(a){var b,c,d,e;if(this.items){for(b=this.items.length,c=0;b>c;c+=1)if(d=this.items[c],d.findComponent&&(e=d.findComponent(a)))return e;return null}},Kc=function(a){var b,c=a.index;return b=this.items[c+1]?this.items[c+1].firstNode():this.owner===this.root?this.owner.component?this.owner.component.findNextNode():null:this.owner.findNextNode(this)},Lc=function(){return this.items&&this.items[0]?this.items[0].firstNode():null},Mc=function(){var a=this;do if(a.pElement)return a.pElement.node;while(a=a.parent);return this.root.el},Nc=function(a){function b(a,c,d,e){return e=e||0,a.map(function(a){var f,g,h;return a.text?a.text:a.fragments?a.fragments.map(function(a){return b(a.items,c,d,e)}).join(""):(f=d+"-"+e++,h=(g=a.root.viewmodel.wrapped[a.keypath])?g.value:a.getValue(),c[f]=h,"${"+f+"}")}).join("")}var c={};return function(){var d=arguments[0];void 0===d&&(d=c);var e,f,g,h,i,j,k;return e=d.args,i=e?"argsList":"value",j=e?"dirtyArgs":"dirtyValue",this[j]&&(g=b(this.items,f={},this.root._guid),h=a(e?"["+g+"]":g,f),k=h?h.value:e?[this.toString()]:this.toString(),this[i]=k,this[j]=!1),this[i]}}(Db),Oc=function(){var a=/</g,b=/>/g;return function(c){return c.replace(a,"&lt;").replace(b,"&gt;")}}(),Pc=function(a){return a&&a.parentNode&&a.parentNode.removeChild(a),a},Qc=function(a){return function(){return a(this.node)}}(Pc),Rc=function(a,b,c){var d=function(b){this.type=a.TEXT,this.text=b.template};return d.prototype={detach:c,firstNode:function(){return this.node},render:function(){return this.node||(this.node=document.createTextNode(this.text)),this.node},toString:function(a){return a?b(this.text):this.text},unrender:function(a){return a?this.detach():void 0}},d}(Q,Oc,Qc),Sc=function(a){return function(){this.keypath?this.root.viewmodel.unregister(this.keypath,this):a.removeUnresolved(this),this.resolver&&this.resolver.teardown()}}(u),Tc=function(){return this.value},Uc=function(a){var b=function(b,c,d,e){this.root=b,this.ref=c,this.parentFragment=d,this.resolve=e,a.addUnresolved(this)};return b.prototype={teardown:function(){a.removeUnresolved(this)}},b}(u),Vc=function(a,b){return a.substr(0,b.length+1)===b+"."},Wc=function(a){return function(b,c,d){return b===c?d:a(b,c)?b.replace(c+".",d+"."):void 0}}(Vc),Xc=function(a,b){function c(a){var c=b[a.message]||a.message||"";return d(c,a.args)}function d(a,b){return a.replace(/{([^{}]*)}/g,function(a,c){return b[c]})}var e={warn:function(a,b){(a.debug||b)&&this.logger(c(a),a.allowDuplicates)},error:function(a){this.errorOnly(a),a.debug||this.warn(a,!0)},errorOnly:function(a){a.debug&&this.critical(a)},critical:function(a){var b=a.err||new Error(c(a));this.thrower(b)},logger:a,thrower:function(a){throw a}};return e}(K,P),Yc=function(a,b,c){var d,e;for(d=b.length;d--;)e=b[d],-1===c.indexOf(e)&&a.viewmodel.unregister(e,a,"computed");for(d=c.length;d--;)e=c[d],-1===b.indexOf(e)&&a.viewmodel.register(e,a,"computed");a.dependencies=c.slice()},Zc=function(a,b,c,d){function e(a,b){var c,d;if(a=a.replace(/\$\{([0-9]+)\}/g,"_$1"),i[a])return i[a];for(d=[];b--;)d[b]="_"+b;return c=new Function(d.join(","),"return("+a+")"),i[a]=c,c}function f(a,b){var d,e;return a._noWrap?a:(e="__ractive_"+b._guid,(d=a[e])?d:/this/.test(a.toString())?(c(a,e,{value:a.bind(b)}),a[e]):(c(a,"__ractive_nowrap",{value:a}),a.__ractive_nowrap))}function g(a){return"function"==typeof a?a():a}var h,i={};return h=function(a,b,c,d,g,h){var i=this,j=a.viewmodel;i.root=a,i.viewmodel=j,i.uniqueString=c,i.keypath=b,i.priority=h,i.fn=e(d,g.length),i.explicitDependencies=[],i.dependencies=[],i.argumentGetters=g.map(function(b){var c,d;return b?b.indexRef?d=b.value:(c=b.keypath,i.explicitDependencies.push(c),j.register(c,i,"computed"),function(){var b=j.get(c);return"function"==typeof b?f(b,a):b}):void 0})},h.prototype={wake:function(){this.awake=!0},sleep:function(){this.awake=!1},getValue:function(){var b,c,e;if(b=this.argumentGetters.map(g),!this.updating){this.updating=!0,this.viewmodel.capture();try{c=this.fn.apply(null,b)}catch(f){this.root.debug&&a.warn({debug:this.root.debug,message:"evaluationError",args:{uniqueString:this.uniqueString,err:f.message||f}}),c=void 0}return e=this.viewmodel.release(),d(this,this.dependencies,e),this.updating=!1,c}},update:function(){var a=this.getValue();return b(a,this.value)||(this.value=a,this.root.viewmodel.mark(this.keypath)),this},teardown:function(){var a=this;this.explicitDependencies.concat(this.dependencies).forEach(function(b){return a.viewmodel.unregister(b,a,"computed")}),this.root.viewmodel.evaluators[this.keypath]=null}},h}(Xc,q,B,Yc),$c=function(a,b,c,d,e){function f(a,b){return a.replace(/\$\{([0-9]+)\}/g,function(a,c){var d=b[c];return d?d.indexRef?d.value:d.keypath:"undefined"})}function g(a){return"${"+a.replace(/[\.\[\]]/g,"-")+"}"}var h=function(d,e,f,g){var h,i,j,k=this;return h=d.root,this.root=h,this.callback=g,this.owner=d,this.str=f.s,this.args=j=[],this.unresolved=[],this.pending=0,i=e.indexRefs,f.r&&f.r.length?(f.r.forEach(function(d,f){var g,l,m;return i&&void 0!==(g=i[d])?void(j[f]={indexRef:d,value:g}):(l=b(h,d,e))?void(j[f]={keypath:l}):(j[f]=null,k.pending+=1,m=new c(h,d,e,function(b){k.resolve(f,b),a(k.unresolved,m)}),void k.unresolved.push(m))}),this.ready=!0,void this.bubble()):(this.resolved=this.ready=!0,void this.bubble())};return h.prototype={bubble:function(){this.ready&&(this.uniqueString=f(this.str,this.args),this.keypath=g(this.uniqueString),this.createEvaluator(),this.callback(this.keypath))},teardown:function(){for(var a;a=this.unresolved.pop();)a.teardown()},resolve:function(a,b){this.args[a]={keypath:b},this.bubble(),this.resolved=!--this.pending},createEvaluator:function(){var a=this.root.viewmodel.evaluators[this.keypath];a||(a=new d(this.root,this.keypath,this.uniqueString,this.str,this.args,this.owner.priority),this.root.viewmodel.evaluators[this.keypath]=a),a.update()},rebind:function(a,b,c,d){var f;this.args.forEach(function(g){var h;g&&(g.keypath&&(h=e(g.keypath,c,d))?(g.keypath=h,f=!0):g.indexRef&&g.indexRef===a&&(g.value=b,f=!0))}),f&&this.bubble()}},h}(m,s,Uc,Zc,Wc),_c=function(a,b,c,d,e){var f=function(d,f,g){var h,i,j,k,l,m=this;m.resolver=f,m.root=f.root,m.viewmodel=f.root.viewmodel,"string"==typeof d?m.value=d:d.t===a.REFERENCE?(h=m.ref=d.n,(i=g.indexRefs)&&void 0!==(j=i[h])?(m.indexRef=h,m.value=j):(k=f.root,(l=b(k,h,g))?m.resolve(l):m.unresolved=new c(k,h,g,function(a){m.unresolved=null,m.resolve(a)}))):new e(f,g,d,function(a){m.resolve(a)})};return f.prototype={resolve:function(a){this.keypath=a,this.value=this.viewmodel.get(a),this.bind(),this.resolver.bubble()},bind:function(){this.viewmodel.register(this.keypath,this)},rebind:function(a,b,c,e){var f;if(a&&this.indexRef===a){if(b!==this.value)return this.value=b,!0}else if(this.keypath&&(f=d(this.keypath,c,e)))return this.unbind(),this.keypath=f,this.value=this.root.viewmodel.get(f),this.bind(),!0},setValue:function(a){this.value=a,this.resolver.bubble()},unbind:function(){this.keypath&&this.root.viewmodel.unregister(this.keypath,this)},teardown:function(){this.unbind(),this.unresolved&&this.unresolved.teardown()},forceResolution:function(){this.unresolved&&(this.unresolved.teardown(),this.unresolved=null,this.keypath=this.ref,this.value=this.viewmodel.get(this.ref),this.bind())}},f}(Q,s,Uc,Wc,$c),ad=function(a,b,c){function d(a){return a.value}function e(a){return void 0!=a}function f(a){a.unbind()}var g=function(d,e,f){var g,h,i,j,k=this,l=this;j=d.parentFragment,l.root=g=d.root,l.mustache=d,l.priority=d.priority,l.ref=h=e.r,l.callback=f,l.unresolved=[],(i=a(g,h,j))?l.base=i:l.baseResolver=new b(g,h,j,function(a){l.base=a,l.baseResolver=null,l.bubble()}),l.members=e.m.map(function(a){return new c(a,k,j)}),l.ready=!0,l.bubble()};return g.prototype={getKeypath:function(){var a=this.members.map(d);if(a.every(e)&&!this.baseResolver)return this.base+"."+a.join(".")},bubble:function(){this.ready&&!this.baseResolver&&this.callback(this.getKeypath())},teardown:function(){this.members.forEach(f)},rebind:function(a,b,c,d){var e;this.members.forEach(function(f){f.rebind(a,b,c,d)&&(e=!0)}),e&&this.bubble()},forceResolution:function(){this.baseResolver&&(this.base=this.ref,this.baseResolver.teardown(),this.baseResolver=null),this.members.forEach(function(a){return a.forceResolution()}),this.bubble()}},g}(s,Uc,_c),bd=function(a,b,c,d,e){return function(f,g){function h(a){var b=f.keypath;a!==b&&(f.resolve(a),void 0!==b&&f.fragments&&f.fragments.forEach(function(c){c.rebind(null,null,b,a)}))}var i,j,k,l,m,n;if(m=g.parentFragment,n=g.template,f.root=m.root,f.parentFragment=m,f.pElement=m.pElement,f.template=g.template,f.index=g.index||0,f.priority=m.priority,f.isStatic=g.template.s,f.type=g.template.t,i=n.r){if(k=m.indexRefs,k&&void 0!==(l=k[i]))return f.indexRef=i,void f.setValue(l);j=c(f.root,i,f.parentFragment),void 0!==j?f.resolve(j):(f.ref=i,b.addUnresolved(f))
}g.template.x&&(f.resolver=new e(f,m,g.template.x,h)),g.template.rx&&(f.resolver=new d(f,g.template.rx,h)),f.template.n!==a.SECTION_UNLESS||f.hasOwnProperty("value")||f.setValue(void 0)}}(Q,u,s,ad,$c),cd=function(a){var b,c,d;void 0!==this.keypath&&(this.root.viewmodel.unregister(this.keypath,this),b=!0),this.keypath=a,void 0!==a&&(c=this.root.viewmodel.get(a),this.root.viewmodel.register(a,this)),this.setValue(c),b&&(d=this.twowayBinding)&&d.rebound()},dd=function(a){return function(b,c,d,e){var f;this.fragments&&this.fragments.forEach(function(a){return a.rebind(b,c,d,e)}),this.resolver&&this.resolver.rebind(b,c,d,e),this.keypath?(f=a(this.keypath,d,e))&&this.resolve(f):void 0!==b&&this.indexRef===b&&this.setValue(c)}}(Wc),ed=function(a,b,c,d){return{getValue:a,init:b,resolve:c,rebind:d}}(Tc,bd,cd,dd),fd=function(a,b,c,d,e,f,g){var h=function(b){this.type=a.INTERPOLATOR,f.init(this,b)};return h.prototype={update:function(){this.node.data=void 0==this.value?"":this.value},resolve:f.resolve,rebind:f.rebind,detach:g,unbind:e,render:function(){return this.node||(this.node=document.createTextNode(void 0!=this.value?this.value:"")),this.node},unrender:function(a){a&&d(this.node)},getValue:f.getValue,setValue:function(a){var c;(c=this.root.viewmodel.wrapped[this.keypath])&&(a=c.get()),a!==this.value&&(this.value=a,this.parentFragment.bubble(),this.node&&b.addView(this))},firstNode:function(){return this.node},toString:function(a){var b=void 0!=this.value?""+this.value:"";return a?c(b):b}},h}(Q,u,Oc,Pc,Sc,ed,Qc),gd=function(){this.parentFragment.bubble()},hd=function(){var a;return 1===this.fragments.length?this.fragments[0].detach():(a=document.createDocumentFragment(),this.fragments.forEach(function(b){a.appendChild(b.detach())}),a)},id=function(a){var b,c,d;for(c=this.fragments.length,b=0;c>b;b+=1)if(d=this.fragments[b].find(a))return d;return null},jd=function(a,b){var c,d;for(d=this.fragments.length,c=0;d>c;c+=1)this.fragments[c].findAll(a,b)},kd=function(a,b){var c,d;for(d=this.fragments.length,c=0;d>c;c+=1)this.fragments[c].findAllComponents(a,b)},ld=function(a){var b,c,d;for(c=this.fragments.length,b=0;c>b;b+=1)if(d=this.fragments[b].findComponent(a))return d;return null},md=function(a){return this.fragments[a.index+1]?this.fragments[a.index+1].firstNode():this.parentFragment.findNextNode(this)},nd=function(){var a,b,c;if(a=this.fragments.length)for(b=0;a>b;b+=1)if(c=this.fragments[b].firstNode())return c;return this.parentFragment.findNextNode(this)},od=function(a,b){var c;return b.push(function(){c=b.Fragment}),function(b){var c,d,e,f,g,h,i,j,k=this;if(!this.unbound){if(c=this.parentFragment,g=[],b.forEach(function(a,b){var c,e,f,h;return a===b?void(g[a]=k.fragments[b]):(c=k.fragments[b],void 0===d&&(d=b),-1===a?(k.fragmentsToUnrender.push(c),void c.unbind()):(e=a-b,f=k.keypath+"."+b,h=k.keypath+"."+a,c.rebind(k.template.i,a,f,h),void(g[a]=c)))}),f=this.root.get(this.keypath).length,void 0===d){if(this.length===f)return;d=this.length}for(this.length=this.fragments.length=f,a.addView(this),h={template:this.template.f,root:this.root,owner:this},this.template.i&&(h.indexRef=this.template.i),e=d;f>e;e+=1)(i=g[e])?this.docFrag.appendChild(i.detach(!1)):this.fragmentsToCreate.push(e),this.fragments[e]=i;j=c.findNextNode(this),this.parentFragment.getNode().insertBefore(this.docFrag,j)}}}(u,f),pd=function(){var a;return a=this.docFrag=document.createDocumentFragment(),this.update(),this.rendered=!0,a},qd=function(a,b,c,d,e){function f(d,e){var f={template:d.template.f,root:d.root,pElement:d.parentFragment.pElement,owner:d};if(d.subtype)switch(d.subtype){case a.SECTION_IF:return j(d,e,!1,f);case a.SECTION_UNLESS:return j(d,e,!0,f);case a.SECTION_WITH:return i(d,f);case a.SECTION_EACH:if(c(e))return h(d,e,f)}return d.ordered=!!b(e),d.ordered?g(d,e,f):c(e)||"function"==typeof e?d.template.i?h(d,e,f):i(d,f):j(d,e,!1,f)}function g(a,b,c){var d,e,f;if(e=b.length,e===a.length)return!1;if(e<a.length)a.fragmentsToUnrender=a.fragments.splice(e,a.length-e),a.fragmentsToUnrender.forEach(k);else if(e>a.length)for(d=a.length;e>d;d+=1)c.context=a.keypath+"."+d,c.index=d,a.template.i&&(c.indexRef=a.template.i),f=new l(c),a.fragmentsToRender.push(a.fragments[d]=f);return a.length=e,!0}function h(a,b,c){var d,e,f,g,h;for(f=a.hasKey||(a.hasKey={}),e=a.fragments.length;e--;)g=a.fragments[e],g.index in b||(h=!0,g.unbind(),a.fragmentsToUnrender.push(g),a.fragments.splice(e,1),f[g.index]=!1);for(d in b)f[d]||(h=!0,c.context=a.keypath+"."+d,c.index=d,a.template.i&&(c.indexRef=a.template.i),g=new l(c),a.fragmentsToRender.push(g),a.fragments.push(g),f[d]=!0);return a.length=a.fragments.length,h}function i(a,b){var c;return a.length?void 0:(b.context=a.keypath,b.index=0,c=new l(b),a.fragmentsToRender.push(a.fragments[0]=c),a.length=1,!0)}function j(a,c,d,e){var f,g,h;if(g=b(c)&&0===c.length,f=d?g||!c:c&&!g){if(!a.length)return e.index=0,h=new l(e),a.fragmentsToRender.push(a.fragments[0]=h),a.length=1,!0;if(a.length>1)return a.fragmentsToUnrender=a.fragments.splice(1),a.fragmentsToUnrender.forEach(k),!0}else if(a.length)return a.fragmentsToUnrender=a.fragments.splice(0,a.fragments.length),a.fragmentsToUnrender.forEach(k),a.length=0,!0}function k(a){a.unbind()}var l;return e.push(function(){l=e.Fragment}),function(a){var b,c,e=this;this.updating||(this.updating=!0,(b=this.root.viewmodel.wrapped[this.keypath])&&(a=b.get()),this.fragmentsToCreate.length?(c={template:this.template.f,root:this.root,pElement:this.pElement,owner:this,indexRef:this.template.i},this.fragmentsToCreate.forEach(function(a){var b;c.context=e.keypath+"."+a,c.index=a,b=new l(c),e.fragmentsToRender.push(e.fragments[a]=b)}),this.fragmentsToCreate.length=0):f(this,a)&&(this.bubble(),this.rendered&&d.addView(this)),this.value=a,this.updating=!1)}}(Q,h,i,u,f),rd=function(a,b){function c(a){a.unbind()}function d(a,b){var c,d=[];for(c=a;b>c;c+=1)d.push(c);return d}function e(a,b,c,d){var e,f,g,h,i;for(g=a.template.i,e=b;c>e;e+=1)f=a.fragments[e],h=a.keypath+"."+(e-d),i=a.keypath+"."+e,f.index=e,f.rebind(g,e,h,i)}var f;return b.push(function(){f=b.Fragment}),function(b){var f,g,h,i,j,k=this;if(!this.unbound&&(f=b.balance)){if(a.addView(k),g=b.rangeStart,k.length+=f,0>f)return k.fragmentsToUnrender=k.fragments.splice(g,-f),k.fragmentsToUnrender.forEach(c),void e(k,g,k.length,f);h=g+b.removed,i=g+b.added,j=[h,0],j.length+=f,k.fragments.splice.apply(k.fragments,j),e(k,i,k.length,f),k.fragmentsToCreate=d(h,i)}}}(u,f),sd=function(a){var b,c,d;for(b="",c=0,d=this.length,c=0;d>c;c+=1)b+=this.fragments[c].toString(a);return b},td=function(a){function b(a){a.unbind()}return function(){this.fragments.forEach(b),a.call(this),this.length=0,this.unbound=!0}}(Sc),ud=function(){function a(a){a.unrender(!0)}function b(a){a.unrender(!1)}return function(c){this.fragments.forEach(c?a:b)}}(),vd=function(){for(var a,b,c,d,e;a=this.fragmentsToUnrender.pop();)a.unrender(!0);if(this.fragmentsToRender.length){for(this.rendered&&(e=this.parentFragment.getNode());a=this.fragmentsToRender.shift();)b=a.render(),this.docFrag.appendChild(b),this.rendered&&this.ordered&&(c=this.fragments[a.index+1],c&&c.rendered&&e.insertBefore(this.docFrag,c.firstNode()||null));this.rendered&&this.docFrag.childNodes.length&&(d=this.parentFragment.findNextNode(this),e.insertBefore(this.docFrag,d))}},wd=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){var s=function(c){this.type=a.SECTION,this.subtype=c.template.n,this.inverted=this.subtype===a.SECTION_UNLESS,this.pElement=c.pElement,this.fragments=[],this.fragmentsToCreate=[],this.fragmentsToRender=[],this.fragmentsToUnrender=[],this.length=0,b.init(this,c)};return s.prototype={bubble:c,detach:d,find:e,findAll:f,findAllComponents:g,findComponent:h,findNextNode:i,firstNode:j,getValue:b.getValue,merge:k,rebind:b.rebind,render:l,resolve:b.resolve,setValue:m,splice:n,toString:o,unbind:p,unrender:q,update:r},s}(Q,ed,gd,hd,id,jd,kd,ld,md,nd,od,pd,qd,rd,sd,td,ud,vd),xd=function(){var a,b;if(this.docFrag){for(a=this.nodes.length,b=0;a>b;b+=1)this.docFrag.appendChild(this.nodes[b]);return this.docFrag}},yd=function(a){return function(b){var c,d,e,f;for(d=this.nodes.length,c=0;d>c;c+=1)if(e=this.nodes[c],1===e.nodeType){if(a(e,b))return e;if(f=e.querySelector(b))return f}return null}}(Yb),zd=function(a){return function(b,c){var d,e,f,g,h,i;for(e=this.nodes.length,d=0;e>d;d+=1)if(f=this.nodes[d],1===f.nodeType&&(a(f,b)&&c.push(f),g=f.querySelectorAll(b)))for(h=g.length,i=0;h>i;i+=1)c.push(g[i])}}(Yb),Ad=function(){return this.rendered&&this.nodes[0]?this.nodes[0]:this.parentFragment.findNextNode(this)},Bd=function(a,b){function c(a){return f[a]||(f[a]=b(a))}var d,e,f={};try{b("table").innerHTML="foo"}catch(g){d=!0,e={TABLE:['<table class="x">',"</table>"],THEAD:['<table><thead class="x">',"</thead></table>"],TBODY:['<table><tbody class="x">',"</tbody></table>"],TR:['<table><tr class="x">',"</tr></table>"],SELECT:['<select class="x">',"</select>"]}}return function(b,f,g){var h,i,j,k,l,m=[];if(b){for(d&&(i=e[f.tagName])?(h=c("DIV"),h.innerHTML=i[0]+b+i[1],h=h.querySelector(".x"),"SELECT"===h.tagName&&(j=h.options[h.selectedIndex])):f.namespaceURI===a.svg?(h=c("DIV"),h.innerHTML='<svg class="x">'+b+"</svg>",h=h.querySelector(".x")):(h=c(f.tagName),h.innerHTML=b);k=h.firstChild;)m.push(k),g.appendChild(k);if(d&&"SELECT"===f.tagName)for(l=m.length;l--;)m[l]!==j&&(m[l].selected=!1)}return m}}(y,z),Cd=function(a){for(var b=[],c=a.length;c--;)b[c]=a[c];return b},Dd=function(a){function b(a){return a.selected}return function(c){var d,e,f;c&&"select"===c.name&&c.binding&&(d=a(c.node.options).filter(b),c.getAttribute("multiple")?f=d.map(function(a){return a.value}):(e=d[0])&&(f=e.value),void 0!==f&&c.binding.setValue(f),c.bubble())}}(Cd),Ed=function(a,b){return function(){if(this.rendered)throw new Error("Attempted to render an item that was already rendered");return this.docFrag=document.createDocumentFragment(),this.nodes=a(this.value,this.parentFragment.getNode(),this.docFrag),b(this.pElement),this.rendered=!0,this.docFrag}}(Bd,Dd),Fd=function(a){return function(b){var c;(c=this.root.viewmodel.wrapped[this.keypath])&&(b=c.get()),b!==this.value&&(this.value=b,this.parentFragment.bubble(),this.rendered&&a.addView(this))}}(u),Gd=function(){return void 0!=this.value?this.value:""},Hd=function(a){return function(b){this.rendered&&b&&(this.nodes.forEach(a),this.rendered=!1)}}(Pc),Id=function(a,b){return function(){var c,d;if(this.rendered){for(;this.nodes&&this.nodes.length;)c=this.nodes.pop(),c.parentNode.removeChild(c);d=this.parentFragment.getNode(),this.nodes=a(this.value,d,this.docFrag),d.insertBefore(this.docFrag,this.parentFragment.findNextNode(this)),b(this.pElement)}}}(Bd,Dd),Jd=function(a,b,c,d,e,f,g,h,i,j,k,l){var m=function(c){this.type=a.TRIPLE,b.init(this,c)};return m.prototype={detach:c,find:d,findAll:e,firstNode:f,getValue:b.getValue,rebind:b.rebind,render:g,resolve:b.resolve,setValue:h,toString:i,unbind:l,unrender:j,update:k},m}(Q,ed,xd,yd,zd,Ad,Ed,Fd,Gd,Hd,Id,Sc),Kd=function(){this.parentFragment.bubble()},Ld=function(){var a,b=this.node;return b?((a=b.parentNode)&&a.removeChild(b),b):void 0},Md=function(a){return function(b){return a(this.node,b)?this.node:this.fragment&&this.fragment.find?this.fragment.find(b):void 0}}(Yb),Nd=function(a,b){b._test(this,!0)&&b.live&&(this.liveQueries||(this.liveQueries=[])).push(b),this.fragment&&this.fragment.findAll(a,b)},Od=function(a,b){this.fragment&&this.fragment.findAllComponents(a,b)},Pd=function(a){return this.fragment?this.fragment.findComponent(a):void 0},Qd=function(){return null},Rd=function(){return this.node},Sd=function(a){return this.attributes&&this.attributes[a]?this.attributes[a].value:void 0},Td=function(){var a,b,c,d;return a="altGlyph altGlyphDef altGlyphItem animateColor animateMotion animateTransform clipPath feBlend feColorMatrix feComponentTransfer feComposite feConvolveMatrix feDiffuseLighting feDisplacementMap feDistantLight feFlood feFuncA feFuncB feFuncG feFuncR feGaussianBlur feImage feMerge feMergeNode feMorphology feOffset fePointLight feSpecularLighting feSpotLight feTile feTurbulence foreignObject glyphRef linearGradient radialGradient textPath vkern".split(" "),b="attributeName attributeType baseFrequency baseProfile calcMode clipPathUnits contentScriptType contentStyleType diffuseConstant edgeMode externalResourcesRequired filterRes filterUnits glyphRef gradientTransform gradientUnits kernelMatrix kernelUnitLength keyPoints keySplines keyTimes lengthAdjust limitingConeAngle markerHeight markerUnits markerWidth maskContentUnits maskUnits numOctaves pathLength patternContentUnits patternTransform patternUnits pointsAtX pointsAtY pointsAtZ preserveAlpha preserveAspectRatio primitiveUnits refX refY repeatCount repeatDur requiredExtensions requiredFeatures specularConstant specularExponent spreadMethod startOffset stdDeviation stitchTiles surfaceScale systemLanguage tableValues targetX targetY textLength viewBox viewTarget xChannelSelector yChannelSelector zoomAndPan".split(" "),c=function(a){for(var b={},c=a.length;c--;)b[a[c].toLowerCase()]=a[c];return b},d=c(a.concat(b)),function(a){var b=a.toLowerCase();return d[b]||b}}(),Ud=function(a){return function(){var b=this.fragment.getValue();b!==this.value&&(this.value=b,"value"===this.name&&this.node&&(this.node._ractive.value=b),this.rendered&&a.addView(this))}}(u),Vd=function(a,b){return function(c,d){var e,f;if(e=d.indexOf(":"),-1===e||(f=d.substr(0,e),"xmlns"===f))c.name=c.element.namespace!==a.html?b(d):d;else if(d=d.substring(e+1),c.name=b(d),c.namespace=a[f.toLowerCase()],!c.namespace)throw'Unknown namespace ("'+f+'")'}}(y,Td),Wd=function(a){return function(b){var c=b.fragment.items;if(1===c.length)return c[0].type===a.INTERPOLATOR?c[0]:void 0}}(Q),Xd=function(a){var b={"accept-charset":"acceptCharset",accesskey:"accessKey",bgcolor:"bgColor","class":"className",codebase:"codeBase",colspan:"colSpan",contenteditable:"contentEditable",datetime:"dateTime",dirname:"dirName","for":"htmlFor","http-equiv":"httpEquiv",ismap:"isMap",maxlength:"maxLength",novalidate:"noValidate",pubdate:"pubDate",readonly:"readOnly",rowspan:"rowSpan",tabindex:"tabIndex",usemap:"useMap"};return function(c,d){var e;!c.pNode||c.namespace||d.pNode.namespaceURI&&d.pNode.namespaceURI!==a.html||(e=b[c.name]||c.name,void 0!==d.pNode[e]&&(c.propertyName=e),("boolean"==typeof d.pNode[e]||"value"===e)&&(c.useProperty=!0))}}(y),Yd=function(a,b,c,d,e){var f;return e.push(function(){f=e.Fragment}),function(e){return this.type=a.ATTRIBUTE,this.element=e.element,this.root=e.root,b(this,e.name),e.value&&"string"!=typeof e.value?(this.parentFragment=this.element.parentFragment,this.fragment=new f({template:e.value,root:this.root,owner:this}),this.value=this.fragment.getValue(),this.interpolator=c(this),this.isBindable=!!this.interpolator,d(this,e),void(this.ready=!0)):void(this.value=e.value||!0)}}(Q,Vd,Wd,Xd,f),Zd=function(a,b,c,d){this.fragment&&this.fragment.rebind(a,b,c,d)},$d=function(a){var b={"accept-charset":"acceptCharset",accesskey:"accessKey",bgcolor:"bgColor","class":"className",codebase:"codeBase",colspan:"colSpan",contenteditable:"contentEditable",datetime:"dateTime",dirname:"dirName","for":"htmlFor","http-equiv":"httpEquiv",ismap:"isMap",maxlength:"maxLength",novalidate:"noValidate",pubdate:"pubDate",readonly:"readOnly",rowspan:"rowSpan",tabindex:"tabIndex",usemap:"useMap"};return function(c){var d;this.node=c,c.namespaceURI&&c.namespaceURI!==a.html||(d=b[this.name]||this.name,void 0!==c[d]&&(this.propertyName=d),("boolean"==typeof c[d]||"value"===d)&&(this.useProperty=!0),"value"===d&&(this.useProperty=!0,c._ractive.value=this.value)),this.rendered=!0,this.update()}}(y),_d=function(){function a(a){return a.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}return function(){var b,c,d;return b=this.name,c=this.value,"value"!==b||"select"!==this.element.name?"name"===b&&"input"===this.element.name&&(d=this.interpolator)?"name={{"+(d.keypath||d.ref)+"}}":"number"==typeof c?b+'="'+c+'"':"string"==typeof c?b+'="'+a(c)+'"':c?b:"":void 0}}(),ae=function(){this.fragment&&this.fragment.unbind()},be=function(){var a,b,c,d,e=this.value;if(!this.locked)for(this.node._ractive.value=e,a=this.node.options,d=a.length;d--;)if(b=a[d],c=b._ractive?b._ractive.value:b.value,c==e){b.selected=!0;break}},ce=function(a){return function(){var b,c,d,e,f=this.value;for(a(f)||(f=[f]),b=this.node.options,c=b.length;c--;)d=b[c],e=d._ractive?d._ractive.value:d.value,d.selected=-1!==f.indexOf(e)}}(h),de=function(){var a=(b=this).node,b=b.value;a.checked=b==a._ractive.value},ee=function(a){return function(){var b,c,d,e,f=this.node;if(b=f.checked,f.value=this.element.getAttribute("value"),f.checked=this.element.getAttribute("value")===this.element.getAttribute("name"),b&&!f.checked&&this.element.binding&&(d=this.element.binding.siblings,e=d.length)){for(;e--;){if(c=d[e],!c.element.node)return;if(c.element.node.checked)return a.addViewmodel(c.root.viewmodel),c.handleChange()}a.addViewmodel(c.root.viewmodel),this.root.viewmodel.set(c.keypath,void 0)}}}(u),fe=function(a){return function(){var b,c;b=this.node,c=this.value,b.checked=a(c)?-1!==c.indexOf(b._ractive.value):c==b._ractive.value}}(h),ge=function(){var a,b;a=this.node,b=this.value,void 0===b&&(b=""),a.className=b},he=function(){var a,b;a=this.node,b=this.value,void 0!==b&&(this.root.nodes[b]=void 0),this.root.nodes[b]=a,a.id=b},ie=function(){var a,b;a=this.node,b=this.value,void 0===b&&(b=""),a.style.setAttribute("cssText",b)},je=function(){var a,b;a=this.node,b=this.value,void 0===b&&(b=""),this.locked||(a.innerHTML=b)},ke=function(){var a,b;a=this.node,b=this.value,a._ractive.value=b,this.locked||(a.value=void 0==b?"":b)},le=function(){this.locked||(this.node[this.propertyName]=this.value)},me=function(){var a,b,c;a=this.node,b=this.name,c=this.value,this.namespace?a.setAttributeNS(this.namespace,b,c):"string"==typeof c||"number"==typeof c?a.setAttribute(b,c):c?a.setAttribute(b,""):a.removeAttribute(b)},ne=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){return function(){var o,p,q,r,s;o=this.name,p=this.element,q=this.node,"id"===o?s=i:"value"===o?"select"===p.name&&"value"===o?s=q.multiple?d:c:"textarea"===p.name?s=l:q.getAttribute("contenteditable")?s=k:"input"===p.name&&(r=p.getAttribute("type"),s="file"===r?b:"radio"===r&&p.binding&&"name"===p.binding.name?f:l):this.twoway&&"name"===o?"radio"===q.type?s=e:"checkbox"===q.type&&(s=g):"style"===o&&q.style.setAttribute?s=j:"class"!==o||q.namespaceURI&&q.namespaceURI!==a.html?this.useProperty&&(s=m):s=h,s||(s=n),this.update=s,this.update()}}(y,Pb,be,ce,de,ee,fe,ge,he,ie,je,ke,le,me),oe=function(a,b,c,d,e,f,g){var h=function(a){this.init(a)};return h.prototype={bubble:a,init:b,rebind:c,render:d,toString:e,unbind:f,update:g},h}(Ud,Yd,Zd,$d,_d,ae,ne),pe=function(a){return function(b,c){var d,e,f=[];for(d in c)c.hasOwnProperty(d)&&(e=new a({element:b,name:d,value:c[d],root:b.root}),f.push(f[d]=e));return f}}(oe),qe=function(a){for(var b,c,d=Array.prototype.slice,e=d.call(arguments,1);c=e.shift();)for(b in c)c.hasOwnProperty(b)&&(a[b]=c[b]);return a},re=function(a,b,c,d,e){var f=function(a){var c,d,e;return this.element=a,this.root=a.root,this.attribute=a.attributes[this.name||"value"],c=this.attribute.interpolator,c.twowayBinding=this,c.keypath&&"${"===c.keypath.substr?(b("Two-way binding does not work with expressions: "+c.keypath),!1):(c.keypath||(c.ref&&c.resolve(c.ref),c.resolver&&c.resolver.forceResolution()),this.keypath=d=c.keypath,void(void 0===this.root.viewmodel.get(d)&&this.getInitialValue&&(e=this.getInitialValue(),void 0!==e&&this.root.viewmodel.set(d,e))))};return f.prototype={handleChange:function(){var b=this;a.start(this.root),this.attribute.locked=!0,this.root.viewmodel.set(this.keypath,this.getValue()),a.scheduleTask(function(){return b.attribute.locked=!1}),a.end()},rebound:function(){var a,b,c;b=this.keypath,c=this.attribute.interpolator.keypath,b!==c&&(e(this.root._twowayBindings[b],this),this.keypath=c,a=this.root._twowayBindings[c]||(this.root._twowayBindings[c]=[]),a.push(this))},unbind:function(){}},f.extend=function(a){var b,e=this;return b=function(a){f.call(this,a),this.init&&this.init()},b.prototype=c(e.prototype),d(b.prototype,a),b.extend=f.extend,b},f}(u,K,R,qe,m),se=function(){this._ractive.binding.handleChange()},te=function(a,b){var c=a.extend({getInitialValue:function(){return this.element.fragment?this.element.fragment.toString():""},render:function(){var a=this.element.node;a.addEventListener("change",b,!1),this.root.lazy||(a.addEventListener("input",b,!1),a.attachEvent&&a.addEventListener("keyup",b,!1))},unrender:function(){var a=this.element.node;a.removeEventListener("change",b,!1),a.removeEventListener("input",b,!1),a.removeEventListener("keyup",b,!1)},getValue:function(){return this.element.node.innerHTML}});return c}(re,se),ue=function(){var a={};return function(b,c,d){var e=b+c+d;return a[e]||(a[e]=[])}}(),ve=function(a,b,c,d,e){var f=c.extend({name:"checked",init:function(){this.siblings=d(this.root._guid,"radio",this.element.getAttribute("name")),this.siblings.push(this)},render:function(){var a=this.element.node;a.addEventListener("change",e,!1),a.attachEvent&&a.addEventListener("click",e,!1)},unrender:function(){var a=this.element.node;a.removeEventListener("change",e,!1),a.removeEventListener("click",e,!1)},handleChange:function(){a.start(this.root),this.siblings.forEach(function(a){a.root.viewmodel.set(a.keypath,a.getValue())}),a.end()},getValue:function(){return this.element.node.checked},unbind:function(){b(this.siblings,this)}});return f}(u,m,re,ue,se),we=function(a,b,c,d){var e=b.extend({name:"name",init:function(){this.siblings=d(this.root._guid,"radioname",this.keypath),this.siblings.push(this),this.radioName=!0,this.attribute.twoway=!0},getInitialValue:function(){return this.element.getAttribute("checked")?this.element.getAttribute("value"):void 0},render:function(){var a=this.element.node;a.name="{{"+this.keypath+"}}",a.checked=this.root.viewmodel.get(this.keypath)==this.element.getAttribute("value"),a.addEventListener("change",c,!1),a.attachEvent&&a.addEventListener("click",c,!1)},unrender:function(){var a=this.element.node;a.removeEventListener("change",c,!1),a.removeEventListener("click",c,!1)},getValue:function(){var a=this.element.node;return a._ractive?a._ractive.value:a.value},handleChange:function(){this.element.node.checked&&b.prototype.handleChange.call(this)},rebound:function(a,c,d,e){var f;b.prototype.rebound.call(this,a,c,d,e),(f=this.element.node)&&(f.name="{{"+this.keypath+"}}")},unbind:function(){a(this.siblings,this)}});return e}(m,re,se,ue),xe=function(a,b,c,d,e){function f(a){return a.isChecked}function g(a){return a.element.getAttribute("value")}var h=c.extend({name:"name",getInitialValue:function(){return this.noInitialValue=!0,[]},init:function(){var b,c,e;this.checkboxName=!0,this.siblings=d(this.root._guid,"checkboxes",this.keypath),this.siblings.push(this),this.noInitialValue&&(this.siblings.noInitialValue=!0),e=this.siblings.noInitialValue,b=this.root.viewmodel.get(this.keypath),c=this.element.getAttribute("value"),e?(this.isChecked=this.element.getAttribute("checked"),this.isChecked&&b.push(c)):this.isChecked=a(b)?-1!==b.indexOf(c):b===c},unbind:function(){b(this.siblings,this)},render:function(){var a=this.element.node;a.name="{{"+this.keypath+"}}",a.checked=this.isChecked,a.addEventListener("change",e,!1),a.attachEvent&&a.addEventListener("click",e,!1)},unrender:function(){var a=this.element.node;a.removeEventListener("change",e,!1),a.removeEventListener("click",e,!1)},changed:function(){var a=!!this.isChecked;return this.isChecked=this.element.node.checked,this.isChecked===a},handleChange:function(){this.isChecked=this.element.node.checked,c.prototype.handleChange.call(this)},getValue:function(){return this.siblings.filter(f).map(g)}});return h}(h,m,re,ue,se),ye=function(a,b){var c=a.extend({name:"checked",render:function(){var a=this.element.node;a.addEventListener("change",b,!1),a.attachEvent&&a.addEventListener("click",b,!1)},unrender:function(){var a=this.element.node;a.removeEventListener("change",b,!1),a.removeEventListener("click",b,!1)},getValue:function(){return this.element.node.checked}});return c}(re,se),ze=function(a,b,c){var d=b.extend({getInitialValue:function(){var a,b,c=this.element.options;if(b=a=c.length,a){for(;b--;)if(c[b].getAttribute("selected"))return c[b].getAttribute("value");for(;++b<a;)if(!c[b].getAttribute("disabled"))return c[b].getAttribute("value")}},render:function(){this.element.node.addEventListener("change",c,!1)},unrender:function(){this.element.node.removeEventListener("change",c,!1)},setValue:function(b){a.addViewmodel(this.root.viewmodel),this.root.viewmodel.set(this.keypath,b)},getValue:function(){var a,b,c,d,e;for(a=this.element.node.options,c=a.length,b=0;c>b;b+=1)if(d=a[b],a[b].selected)return e=d._ractive?d._ractive.value:d.value},forceUpdate:function(){var b=this,c=this.getValue();void 0!==c&&(this.attribute.locked=!0,a.addViewmodel(this.root.viewmodel),a.scheduleTask(function(){return b.attribute.locked=!1}),this.root.viewmodel.set(this.keypath,c))}});return d}(u,re,se),Ae=function(a){return function(b,c){var d;if(!a(b)||!a(c))return!1;if(b.length!==c.length)return!1;for(d=b.length;d--;)if(b[d]!==c[d])return!1;return!0}}(h),Be=function(a,b,c,d){var e=c.extend({getInitialValue:function(){return this.element.options.filter(function(a){return a.getAttribute("selected")}).map(function(a){return a.getAttribute("value")})},render:function(){var a;this.element.node.addEventListener("change",d,!1),a=this.root.viewmodel.get(this.keypath),void 0===a&&this.handleChange()},unrender:function(){this.element.node.removeEventListener("change",d,!1)},setValue:function(){throw new Error("TODO not implemented yet")},getValue:function(){var a,b,c,d,e,f;for(a=[],b=this.element.node.options,d=b.length,c=0;d>c;c+=1)e=b[c],e.selected&&(f=e._ractive?e._ractive.value:e.value,a.push(f));return a},handleChange:function(){var a,d,e;return a=this.attribute,d=a.value,e=this.getValue(),void 0!==d&&b(e,d)||c.prototype.handleChange.call(this),this},forceUpdate:function(){var b=this,c=this.getValue();void 0!==c&&(this.attribute.locked=!0,a.addViewmodel(this.root.viewmodel),a.scheduleTask(function(){return b.attribute.locked=!1}),this.root.viewmodel.set(this.keypath,c))},updateModel:function(){void 0!==this.attribute.value&&this.attribute.value.length||this.root.viewmodel.set(this.keypath,this.initialValue)}});return e}(u,Ae,ze,se),Ce=function(a,b){var c=a.extend({render:function(){this.element.node.addEventListener("change",b,!1)},unrender:function(){this.element.node.removeEventListener("change",b,!1)},getValue:function(){return this.element.node.files}});return c}(re,se),De=function(a,b){function c(){var a;b.call(this),a=this._ractive.root.viewmodel.get(this._ractive.binding.keypath,e),this.value=void 0==a?"":a}var d,e;return e={evaluateWrapped:!0},d=a.extend({getInitialValue:function(){return""},getValue:function(){return this.element.node.value},render:function(){var a=this.element.node;a.addEventListener("change",b,!1),this.root.lazy||(a.addEventListener("input",b,!1),a.attachEvent&&a.addEventListener("keyup",b,!1)),a.addEventListener("blur",c,!1)},unrender:function(){var a=this.element.node;a.removeEventListener("change",b,!1),a.removeEventListener("input",b,!1),a.removeEventListener("keyup",b,!1),a.removeEventListener("blur",c,!1)}})}(re,se),Ee=function(a){return a.extend({getInitialValue:function(){return void 0},getValue:function(){var a=parseFloat(this.element.node.value);return isNaN(a)?void 0:a}})}(De),Fe=function(a,b,c,d,e,f,g,h,i,j,k){function l(a){return a&&a.isBindable}return function(m){var n,o,p,q,r=m.attributes;return m.binding&&(m.binding.teardown(),m.binding=null),m.getAttribute("contenteditable")&&l(r.value)?o=b:"input"===m.name?(n=m.getAttribute("type"),"radio"===n||"checkbox"===n?(p=l(r.name),q=l(r.checked),p&&q&&a.error({message:"badRadioInputBinding"}),p?o="radio"===n?d:e:q&&(o="radio"===n?c:f)):"file"===n&&l(r.value)?o=i:l(r.value)&&(o="number"===n||"range"===n?j:k)):"select"===m.name&&l(r.value)?o=m.getAttribute("multiple")?h:g:"textarea"===m.name&&l(r.value)&&(o=k),o?new o(m):void 0}}(Xc,te,ve,we,xe,ye,ze,Be,Ce,Ee,De),Ge=function(a){this.root.fire(this.action.toString().trim(),a)},He=function(a){function b(a){this.root.fire.apply(this.root,[this.action.toString().trim(),a].concat(this.params))}function c(a){var b=this.dynamicParams.getValue(e);"string"==typeof b&&(b=b.substr(1,b.length-2)),this.root.fire.apply(this.root,[this.action.toString().trim(),a].concat(b))}var d,e={args:!0};return a.push(function(){d=a.Fragment}),function(a,e,f){var g;this.element=a,this.root=a.root,this.name=e,this.proxies=[],g=f.n||f,"string"!=typeof g&&(g=new d({template:g,root:this.root,owner:this.element})),this.action=g,f.d?(this.dynamicParams=new d({template:f.d,root:this.root,owner:this.element}),this.fire=c):f.a&&(this.params=f.a,this.fire=b)}}(f),Ie=function(a,b,c,d){"string"!=typeof this.action&&this.action.rebind(a,b,c,d),this.dynamicParams&&this.dynamicParams.rebind(a,b,c,d)},Je=function(a){var b,c;b=this._ractive,c=b.events[a.type],c.fire({node:this,original:a,index:b.index,keypath:b.keypath,context:b.root.get(b.keypath)})},Ke=function(a,b,c){function d(a){return e[a]||(e[a]=function(b){var c=b.node._ractive;b.index=c.index,b.keypath=c.keypath,b.context=c.root.get(c.keypath),c.events[a].fire(b)}),e[a]}var e={};return function(){var e,f=this.name;this.node=this.element.node,(e=b.registries.events.find(this.root,f))?this.custom=e(this.node,d(f)):("on"+f in this.node||window&&"on"+f in window||a('Missing "'+this.name+'" event. You may need to download a plugin via http://docs.ractivejs.org/latest/plugins#events'),this.node.addEventListener(f,c,!1)),this.node._ractive.events[f]=this}}(K,Sb,Je),Le=function(){"string"!=typeof this.action&&this.action.teardown(),this.dynamicParams&&this.dynamicParams.teardown()},Me=function(a){return function(){this.custom?this.custom.teardown():this.node.removeEventListener(this.name,a,!1)}}(Je),Ne=function(a,b,c,d,e,f){var g=function(a,b,c){this.init(a,b,c)};return g.prototype={fire:a,init:b,rebind:c,render:d,teardown:e,unrender:f},g}(Ge,He,Ie,Ke,Le,Me),Oe=function(a){return function(b,c){var d,e,f,g,h=[];for(e in c)if(c.hasOwnProperty(e))for(f=e.split("-"),d=f.length;d--;)g=new a(b,f[d],c[e]),h.push(g);return h}}(Ne),Pe=function(a,b,c){var d,e,f;return b.push(function(){d=b.Fragment}),e={args:!0},f=function(b,f){var g,h,i,j=this;j.element=b,j.root=g=b.root,h=f.n||f,"string"!=typeof h&&(i=new d({template:h,root:g,owner:b}),h=i.toString(),i.unbind()),f.a?j.params=f.a:f.d&&(j.fragment=new d({template:f.d,root:g,owner:b}),j.params=j.fragment.getValue(e),j.fragment.bubble=function(){this.dirtyArgs=this.dirtyValue=!0,j.params=this.getValue(e),j.ready&&j.update()}),j.fn=c.registries.decorators.find(g,h),j.fn||a.error({debug:g.debug,message:"missingPlugin",args:{plugin:"decorator",name:h}})},f.prototype={init:function(){var a,b,c,d=this;if(a=d.element.node,d.params?(c=[a].concat(d.params),b=d.fn.apply(d.root,c)):b=d.fn.call(d.root,a),!b||!b.teardown)throw new Error("Decorator definition must return an object with a teardown method");d.actual=b,d.ready=!0},update:function(){this.actual.update?this.actual.update.apply(this.root,this.params):(this.actual.teardown(!0),this.init())},teardown:function(a){this.actual.teardown(),!a&&this.fragment&&this.fragment.unbind()}},f}(Xc,f,Sb),Qe=function(a){function b(a,b){for(var c=a.length;c--;)if(a[c]==b)return!0}return function(c){var d,e,f,g,h;d=c.node,d&&(g=a(d.options),e=c.getAttribute("value"),f=c.getAttribute("multiple"),void 0!==e?(g.forEach(function(a){var c,d;c=a._ractive?a._ractive.value:a.value,d=f?b(e,c):e==c,d&&(h=!0),a.selected=d}),h||(g[0]&&(g[0].selected=!0),c.binding&&c.binding.forceUpdate())):c.binding&&c.binding.forceUpdate())}}(Cd),Re=function(a,b){return function(){var c=this;this.dirty||(this.dirty=!0,a.scheduleTask(function(){b(c),c.dirty=!1
})),this.parentFragment.bubble()}}(u,Qe),Se=function(a){do if("select"===a.name)return a;while(a=a.parent)},Te=function(a){return function(b,c){b.select=a(b.parent),b.select.options.push(b),c.a||(c.a={}),c.a.value||c.a.hasOwnProperty("disabled")||(c.a.value=c.f),"selected"in c.a&&void 0!==b.select.getAttribute("value")&&delete c.a.selected}}(Se),Ue=function(a,b,c,d,e,f,g,h,i){var j;return i.push(function(){j=i.Fragment}),function(i){var k,l,m,n,o;this.type=a.ELEMENT,k=this.parentFragment=i.parentFragment,l=this.template=i.template,this.parent=i.pElement||k.pElement,this.root=m=k.root,this.index=i.index,this.name=b(l.e),"option"===this.name&&h(this,l),"select"===this.name&&(this.options=[],this.bubble=g),this.attributes=c(this,l.a),l.f&&(this.fragment=new j({template:l.f,root:m,owner:this,pElement:this})),m.twoway&&(n=d(this,l.a))&&(this.binding=n,o=this.root._twowayBindings[n.keypath]||(this.root._twowayBindings[n.keypath]=[]),o.push(n)),l.v&&(this.eventHandlers=e(this,l.v)),l.o&&(this.decorator=new f(this,l.o)),this.intro=l.t0||l.t1,this.outro=l.t0||l.t2}}(Q,Td,pe,Fe,Oe,Pe,Re,Te,f),Ve=function(a){return function(b,c){return b===c||a(b,c)}}(Vc),We=function(a,b){return function(c,d,e,f){var g=c[d];g&&!a(g,f)&&a(g,e)&&(c[d]=b(g,e,f))}}(Ve,Wc),Xe=function(a){return function(b,c,d,e){function f(a){a.rebind(b,c,d,e)}var g,h,i,j;if(this.attributes&&this.attributes.forEach(f),this.eventHandlers&&this.eventHandlers.forEach(f),this.fragment&&f(this.fragment),i=this.liveQueries)for(j=this.root,g=i.length;g--;)i[g]._makeDirty();this.node&&(h=this.node._ractive)&&(a(h,"keypath",d,e),void 0!=b&&(h.index[b]=c))}}(We),Ye=function(a){var b,c,d;((b=a.getAttribute("width"))||(c=a.getAttribute("height")))&&a.node.addEventListener("load",d=function(){b&&(a.node.width=b.value),c&&(a.node.height=c.value),a.node.removeEventListener("load",d,!1)},!1)},Ze=function(a,b,c){var d,e={};return c.push(function(){d=c.Fragment}),function(c,f,g){var h,i,j,k=this;return k.element=c,k.root=h=c.root,k.isIntro=g,i=f.n||f,"string"!=typeof i&&(j=new d({template:i,root:h,owner:c}),i=j.toString(),j.unbind()),k.name=i,f.a?k.params=f.a:f.d&&(j=new d({template:f.d,root:h,owner:c}),k.params=j.getValue(e),j.unbind()),k._fn=b.registries.transitions.find(h,i),k._fn?void 0:void a.error({debug:h.debug,message:"missingPlugin",args:{plugin:"transition",name:i}})}}(Xc,Sb,f),$e=function(a){return a.replace(/-([a-zA-Z])/g,function(a,b){return b.toUpperCase()})},_e=function(a,b,c,d){var e,f,g;return a?(f={},g=c("div").style,e=function(a){var c,e,h;if(a=d(a),!f[a])if(void 0!==g[a])f[a]=a;else for(h=a.charAt(0).toUpperCase()+a.substring(1),c=b.length;c--;)if(e=b[c],void 0!==g[e+h]){f[a]=e+h;break}return f[a]}):e=null,e}(A,G,z,$e),af=function(a,b,c,d){var e,f;return b?(f=window.getComputedStyle||a.getComputedStyle,e=function(a){var b,e,g,h,i;if(b=f(this.node),"string"==typeof a)return i=b[d(a)],"0px"===i&&(i=0),i;if(!c(a))throw new Error("Transition$getStyle must be passed a string, or an array of strings representing CSS properties");for(e={},g=a.length;g--;)h=a[g],i=b[d(h)],"0px"===i&&(i=0),e[h]=i;return e}):e=null,e}(tb,A,h,_e),bf=function(a){return function(b,c){var d;if("string"==typeof b)this.node.style[a(b)]=c;else for(d in b)b.hasOwnProperty(d)&&(this.node.style[a(d)]=b[d]);return this}}(_e),cf=function(a,b,c){function d(a){return a}var e=function(e){var f;this.duration=e.duration,this.step=e.step,this.complete=e.complete,"string"==typeof e.easing?(f=e.root.easing[e.easing],f||(a('Missing easing function ("'+e.easing+'"). You may need to download a plugin from [TODO]'),f=d)):f="function"==typeof e.easing?e.easing:d,this.easing=f,this.start=b(),this.end=this.start+this.duration,this.running=!0,c.add(this)};return e.prototype={tick:function(a){var b,c;return this.running?a>this.end?(this.step&&this.step(1),this.complete&&this.complete(1),!1):(b=a-this.start,c=this.easing(b/this.duration),this.step&&this.step(c),!0):!1},stop:function(){this.abort&&this.abort(),this.running=!1}},e}(K,I,J),df=function(a){var b=new RegExp("^-(?:"+a.join("|")+")-");return function(a){return a.replace(b,"")}}(G),ef=function(a){var b=new RegExp("^(?:"+a.join("|")+")([A-Z])");return function(a){var c;return a?(b.test(a)&&(a="-"+a),c=a.replace(/[A-Z]/g,function(a){return"-"+a.toLowerCase()})):""}}(G),ff=function(a,b,c,d,e,f,g,h,i){var j,k,l,m,n,o,p,q,r={},s={};return a?(k=c("div").style,function(){void 0!==k.transition?(l="transition",m="transitionend",n=!0):void 0!==k.webkitTransition?(l="webkitTransition",m="webkitTransitionEnd",n=!0):n=!1}(),l&&(o=l+"Duration",p=l+"Property",q=l+"TimingFunction"),j=function(a,c,j,k,l){setTimeout(function(){var t,u,v,w,x;w=function(){u&&v&&(a.root.fire(a.name+":end",a.node,a.isIntro),l())},t=(a.node.namespaceURI||"")+a.node.tagName,a.node.style[p]=k.map(g).map(i).join(","),a.node.style[q]=i(j.easing||"linear"),a.node.style[o]=j.duration/1e3+"s",x=function(b){var c;c=k.indexOf(d(h(b.propertyName))),-1!==c&&k.splice(c,1),k.length||(a.node.removeEventListener(m,x,!1),v=!0,w())},a.node.addEventListener(m,x,!1),setTimeout(function(){for(var h,i,l,o,p,q=k.length,y=[];q--;)o=k[q],h=t+o,n&&!s[h]&&(a.node.style[g(o)]=c[o],r[h]||(i=a.getStyle(o),r[h]=a.getStyle(o)!=c[o],s[h]=!r[h],s[h]&&(a.node.style[g(o)]=i))),(!n||s[h])&&(void 0===i&&(i=a.getStyle(o)),l=k.indexOf(o),-1===l?b("Something very strange happened with transitions. If you see this message, please let @RactiveJS know. Thanks!"):k.splice(l,1),p=/[^\d]*$/.exec(c[o])[0],y.push({name:g(o),interpolator:e(parseFloat(i),parseFloat(c[o])),suffix:p}));y.length?new f({root:a.root,duration:j.duration,easing:d(j.easing||""),step:function(b){var c,d;for(d=y.length;d--;)c=y[d],a.node.style[c.name]=c.interpolator(b)+c.suffix},complete:function(){u=!0,w()}}):u=!0,k.length||(a.node.removeEventListener(m,x,!1),v=!0,w())},0)},j.delay||0)}):j=null,j}(A,K,z,$e,Tb,cf,_e,df,ef),gf=function(a){function b(){i.hidden=document[e]}function c(){i.hidden=!0}function d(){i.hidden=!1}var e,f,g,h,i;if("undefined"!=typeof document){if(e="hidden",i={},e in document)g="";else for(h=a.length;h--;)f=a[h],e=f+"Hidden",e in document&&(g=f);void 0!==g?(document.addEventListener(g+"visibilitychange",b),b()):("onfocusout"in document?(document.addEventListener("focusout",c),document.addEventListener("focusin",d)):(window.addEventListener("pagehide",c),window.addEventListener("blur",c),window.addEventListener("pageshow",d),window.addEventListener("focus",d)),i.hidden=!1)}return i}(G),hf=function(a,b,c,d,e,f,g){var h,i,j;return b?(i=window.getComputedStyle||a.getComputedStyle,h=function(a,b,h,k){var l,m=this;if(g.hidden)return this.setStyle(a,b),j||(j=d.resolve());"string"==typeof a?(l={},l[a]=b):(l=a,k=h,h=b),h||(c('The "'+m.name+'" transition does not supply an options object to `t.animateStyle()`. This will break in a future version of Ractive. For more info see https://github.com/RactiveJS/Ractive/issues/340'),h=m,k=m.complete);var n=new d(function(a){var b,c,d,g,j,k,n;if(!h.duration)return m.setStyle(l),void a();for(b=Object.keys(l),c=[],d=i(m.node),j={},k=b.length;k--;)n=b[k],g=d[e(n)],"0px"===g&&(g=0),g!=l[n]&&(c.push(n),m.node.style[e(n)]=g);return c.length?void f(m,l,h,c,a):void a()});return k&&(c("t.animateStyle returns a Promise as of 0.4.0. Transition authors should do t.animateStyle(...).then(callback)"),n.then(k)),n}):h=null,h}(tb,A,K,n,_e,ff,gf),jf=function(a,b){var c;for(c in b)!b.hasOwnProperty(c)||c in a||(a[c]=b[c]);return a},kf=function(a){return function(b,c){return"number"==typeof b?b={duration:b}:"string"==typeof b?b="slow"===b?{duration:600}:"fast"===b?{duration:200}:{duration:400}:b||(b={}),a(b,c)}}(jf),lf=function(){function a(a,b){b?a.setAttribute("style",b):(a.getAttribute("style"),a.removeAttribute("style"))}return function(){var b,c,d=this;return b=d.node=d.element.node,c=b.getAttribute("style"),d.complete=function(e){!e&&d.isIntro&&a(b,c),b._ractive.transition=null,d._manager.remove(d)},d._fn?void d._fn.apply(d.root,[d].concat(d.params)):void d.complete()}}(),mf=function(a,b,c,d,e,f,g){var h,i;return g.push(function(){h=g.Fragment}),i=function(a,b,c){this.init(a,b,c)},i.prototype={init:a,start:f,getStyle:b,setStyle:c,animateStyle:d,processParams:e},i}(Ze,af,bf,hf,kf,lf,f),nf=function(a,b,c,d,e,f,g,h,i,j,k){function l(b){var c,d,e;return c=(d=b.getAttribute("xmlns"))?d:"svg"===b.name?a.svg:(e=b.parent)?"foreignObject"===e.name?a.html:e.node.namespaceURI:b.root.el.namespaceURI}function m(a){var c,d,e;if(d=a.select.getAttribute("value"),void 0!==d)if(c=a.getAttribute("value"),a.select.node.multiple&&b(d)){for(e=d.length;e--;)if(c==d[e]){a.node.selected=!0;break}}else a.node.selected=c==d}function n(a){var b,c,d,e,f;b=a.root;do for(c=b._liveQueries,d=c.length;d--;)e=c[d],f=c["_"+e],f._test(a)&&(a.liveQueries||(a.liveQueries=[])).push(f);while(b=b._parent)}var o,p;return o=function(){var a=this.node,b=this.fragment.toString(!1);if(a.styleSheet)a.styleSheet.cssText=b;else{for(;a.hasChildNodes();)a.removeChild(a.firstChild);a.appendChild(document.createTextNode(b))}},p=function(){this.node.type&&"text/javascript"!==this.node.type||c("Script tag was updated. This does not cause the code to be re-evaluated!"),this.node.text=this.fragment.toString(!1)},function(){var a,b,c=this,q=this.root;if(a=l(this),b=this.node=e(this.name,a),q.constructor.css&&this.parentFragment.getNode()===q.el&&this.node.setAttribute("data-rvcguid",q.constructor._guid),f(this.node,"_ractive",{value:{proxy:this,keypath:i(this.parentFragment),index:this.parentFragment.indexRefs,events:d(null),root:q}}),this.attributes.forEach(function(a){return a.render(b)}),this.fragment&&("script"===this.name?(this.bubble=p,this.node.text=this.fragment.toString(!1),this.fragment.unrender=g):"style"===this.name?(this.bubble=o,this.bubble(),this.fragment.unrender=g):this.binding&&this.getAttribute("contenteditable")?this.fragment.unrender=g:this.node.appendChild(this.fragment.render())),this.eventHandlers&&this.eventHandlers.forEach(function(a){return a.render()}),this.binding&&(this.binding.render(),this.node._ractive.binding=this.binding),"img"===this.name&&j(this),this.decorator&&this.decorator.fn&&h.scheduleTask(function(){c.decorator.init()}),q.transitionsEnabled&&this.intro){var r=new k(this,this.intro,!0);h.registerTransition(r),h.scheduleTask(function(){return r.start()})}return"option"===this.name&&m(this),this.node.autofocus&&h.scheduleTask(function(){return c.node.focus()}),n(this),this.node}}(y,h,K,R,z,B,Pb,u,p,Ye,mf),of=function(a,b){function c(a){var c,d,e;if(c=a.getAttribute("value"),void 0===c)return!1;if(d=a.select.getAttribute("value"),d==c)return!0;if(a.select.getAttribute("multiple")&&b(d))for(e=d.length;e--;)if(d[e]==c)return!0}function d(a){var b,c,d,e;return b=a.attributes,c=b.type,d=b.value,e=b.name,c&&"radio"===c.value&&d&&e.interpolator&&d.value===e.interpolator.value?!0:void 0}function e(a){var b=a.toString();return b?" "+b:""}return function(){var b,f;return b="<"+(this.template.y?"!DOCTYPE":this.template.e),b+=this.attributes.map(e).join(""),"option"===this.name&&c(this)&&(b+=" selected"),"input"===this.name&&d(this)&&(b+=" checked"),b+=">",this.fragment&&(f="script"!==this.name&&"style"!==this.name,b+=this.fragment.toString(f)),a.test(this.template.e)||(b+="</"+this.template.e+">"),b}}(xb,h),pf=function(a){return function(b){a(b.select.options,b)}}(m),qf=function(a){function b(a){a.unbind()}return function(){this.fragment&&this.fragment.unbind(),this.binding&&this.binding.unbind(),"option"===this.name&&a(this),this.attributes.forEach(b)}}(pf),rf=function(a,b){function c(a){var b,c,d;for(d=a.liveQueries.length;d--;)b=a.liveQueries[d],c=b.selector,b._remove(a.node)}return function(d){var e,f;if("option"===this.name?this.detach():d&&a.detachWhenReady(this),this.fragment&&this.fragment.unrender(!1),(e=this.binding)&&(this.binding.unrender(),this.node._ractive.binding=null,f=this.root._twowayBindings[e.keypath],f.splice(f.indexOf(e),1)),this.eventHandlers&&this.eventHandlers.forEach(function(a){return a.unrender()}),this.decorator&&this.decorator.teardown(),this.root.transitionsEnabled&&this.outro){var g=new b(this,this.outro,!1);a.registerTransition(g),a.scheduleTask(function(){return g.start()})}this.liveQueries&&c(this)}}(u,mf),sf=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){var p=function(a){this.init(a)};return p.prototype={bubble:a,detach:b,find:c,findAll:d,findAllComponents:e,findComponent:f,findNextNode:g,firstNode:h,getAttribute:i,init:j,rebind:k,render:l,toString:m,unbind:n,unrender:o},p}(Kd,Ld,Md,Nd,Od,Pd,Qd,Rd,Sd,Ue,Xe,nf,of,qf,rf),tf=function(){function a(a,b){var d=c.exec(b)[0];return null===a||d.length<a.length?d:a}var b=/^\s*$/,c=/^\s*/;return function(c){var d,e,f,g;return d=c.split("\n"),e=d[0],void 0!==e&&b.test(e)&&d.shift(),f=d[d.length-1],void 0!==f&&b.test(f)&&d.pop(),g=d.reduce(a,null),g&&(c=d.map(function(a){return a.replace(g,"")}).join("\n")),c}}(),uf=function(a,b,c,d){function e(d,e){var f=b.registries.partials,g=f.findInstance(d,e);if(g){var h,i=g.partials[e];if("function"==typeof i&&(h=i.bind(g),h.isOwner=g.partials.hasOwnProperty(e),i=h(g.data,c)),!i)return void a.warn({debug:d.debug,message:"noRegistryFunctionReturn",args:{registry:"partial",name:e}});if(!c.isParsed(i)){var j=c.parse(i,c.getParseOptions(g));j.p&&a.warn({debug:d.debug,message:"noNestedPartials",args:{rname:e}});var k=h?g:f.findOwner(g,e);k.partials[e]=i=j.t}return h&&(i._fn=h),i.v?i.t:i}}return function(b,f){var g;if(g=e(b,f))return g;if(g=c.fromId(f,{noThrow:!0})){g=d(g);var h=c.parse(g,c.getParseOptions(b));return b.partials[f]=h.t}return a.error({debug:b.debug,message:"noTemplateForPartial",args:{name:f}}),[]}}(Xc,Sb,Lb,tf),vf=function(a,b){var c;return b?c=a.split("\n").map(function(a,c){return c?b+a:a}).join("\n"):a},wf=function(a,b,c,d){var e,f;return d.push(function(){f=d.Fragment}),e=function(c){var d,e=this.parentFragment=c.parentFragment;if(this.type=a.PARTIAL,this.name=c.template.r,this.index=c.index,this.root=e.root,!c.template.r)throw new Error("Partials must have a static reference (no expressions). This may change in a future version of Ractive.");d=b(e.root,c.template.r),this.fragment=new f({template:d,root:e.root,owner:this,pElement:e.pElement})},e.prototype={bubble:function(){this.parentFragment.bubble()},firstNode:function(){return this.fragment.firstNode()},findNextNode:function(){return this.parentFragment.findNextNode(this)},detach:function(){return this.fragment.detach()},render:function(){return this.fragment.render()},unrender:function(a){this.fragment.unrender(a)},rebind:function(a,b,c,d){return this.fragment.rebind(a,b,c,d)},unbind:function(){this.fragment.unbind()},toString:function(b){var d,e,f,g;return d=this.fragment.toString(b),e=this.parentFragment.items[this.index-1],e&&e.type===a.TEXT?(f=e.template.split("\n").pop(),(g=/^\s+$/.exec(f))?c(d,g[0]):d):d},find:function(a){return this.fragment.find(a)},findAll:function(a,b){return this.fragment.findAll(a,b)},findComponent:function(a){return this.fragment.findComponent(a)},findAllComponents:function(a,b){return this.fragment.findAllComponents(a,b)},getValue:function(){return this.fragment.getValue()}},e}(Q,uf,vf,f),xf=function(a,b,c){var d;return c.push(function(){d=c.Ractive}),function e(c,d){var f,g=a.registries.components.findInstance(c,d);if(g&&(f=g.components[d],!f._parent)){var h=f.bind(g);if(h.isOwner=g.components.hasOwnProperty(d),f=h(g.data),!f)return void b.warn({debug:c.debug,message:"noRegistryFunctionReturn",args:{registry:"component",name:d}});"string"==typeof f&&(f=e(c,f)),f._fn=h,g.components[d]=f}return f}}(Sb,Xc,f),yf=function(){return this.instance.fragment.detach()},zf=function(a){return this.instance.fragment.find(a)},Af=function(a,b){return this.instance.fragment.findAll(a,b)},Bf=function(a,b){b._test(this,!0),this.instance.fragment&&this.instance.fragment.findAllComponents(a,b)},Cf=function(a){return a&&a!==this.name?this.instance.fragment?this.instance.fragment.findComponent(a):null:this.instance},Df=function(){return this.parentFragment.findNextNode(this)},Ef=function(){return this.rendered?this.instance.fragment.firstNode():null},Ff=function(a,b){var c,d;return b.push(function(){c=b.Fragment}),d=function(a,b,d){this.parentFragment=a.parentFragment,this.component=a,this.key=b,this.fragment=new c({template:d,root:a.root,owner:this}),this.value=this.fragment.getValue()},d.prototype={bubble:function(){this.dirty||(this.dirty=!0,a.addView(this))},update:function(){var b=this.fragment.getValue();this.component.instance.viewmodel.set(this.key,b),a.addViewmodel(this.component.instance.viewmodel),this.value=b,this.dirty=!1},rebind:function(a,b,c,d){this.fragment.rebind(a,b,c,d)},unbind:function(){this.fragment.unbind()}},d}(u,f),Gf=function(a,b,c,d){function e(e,f,g,h){var i,j,k,l,m,n;return k=e.root,l=e.parentFragment,"string"==typeof g?(j=b(g),j?j.value:g):null===g?!0:1===g.length&&g[0].t===a.INTERPOLATOR&&g[0].r?l.indexRefs&&void 0!==l.indexRefs[n=g[0].r]?(e.indexRefBindings[n]=f,l.indexRefs[n]):(m=c(k,g[0].r,l)||g[0].r,h.push({childKeypath:f,parentKeypath:m}),k.viewmodel.get(m)):(i=new d(e,f,g),e.complexParameters.push(i),i.value)}return function(a,b,c,d){var f,g,h={};a.complexParameters=[];for(f in c)c.hasOwnProperty(f)&&(g=e(a,f,c[f],d),(void 0!==g||void 0===b[f])&&(h[f]=g));return h}}(Q,Db,s,Ff),Hf=function(a,b,c,d){var e,f,g,h;return f=a.parentFragment,h=a.root,g={content:d||[]},e=new b({append:!0,data:c,partials:g,magic:h.magic||b.defaults.magic,modifyArrays:h.modifyArrays,_parent:h,_component:a,adapt:h.adapt})},If=function(a){return function(b,c){c.forEach(function(c){var d,e;a(b,b.root,c.parentKeypath,c.childKeypath),d=b.instance.viewmodel.get(c.childKeypath),e=b.root.viewmodel.get(c.parentKeypath),void 0!==d&&void 0===e&&b.root.viewmodel.set(c.parentKeypath,d)})}}(r),Jf=function(a){function b(b,c,d,e){"string"!=typeof e&&a.error({debug:c.debug,message:"noComponentEventArguments"}),b.on(d,function(){var a=Array.prototype.slice.call(arguments);a.unshift(e),c.fire.apply(c,a)})}return function(a,c){var d;for(d in c)c.hasOwnProperty(d)&&b(a.instance,a.root,d,c[d])}}(Xc),Kf=function(a){var b,c;for(b=a.root;b;)(c=b._liveComponentQueries["_"+a.name])&&c.push(a.instance),b=b._parent},Lf=function(a,b,c,d,e,f,g){return function(h,i){var j,k,l,m;if(j=this.parentFragment=h.parentFragment,k=j.root,this.root=k,this.type=a.COMPONENT,this.name=h.template.e,this.index=h.index,this.indexRefBindings={},this.bindings=[],!i)throw new Error('Component "'+this.name+'" not found');m=[],l=c(this,i.defaults.data||{},h.template.a,m),d(this,i,l,h.template.f),e(this,m),f(this,h.template.v),(h.template.t1||h.template.t2||h.template.o)&&b('The "intro", "outro" and "decorator" directives have no effect on components'),g(this)}}(Q,K,Gf,Hf,If,Jf,Kf),Mf=function(a,b){return function(c,d,e,f){var g,h,i=this.instance,j=i._parent;this.bindings.forEach(function(a){var c;a.root===j&&(c=b(a.keypath,e,f))&&a.rebind(c)}),this.complexParameters.forEach(function(a){a.rebind(c,d,e,f)}),(g=this.indexRefBindings[c])&&(a.addViewmodel(i.viewmodel),i.viewmodel.set(g,d)),(h=this.root._liveComponentQueries["_"+this.name])&&h._makeDirty()}}(u,Wc),Nf=function(){var a=this.instance;return a.render(this.parentFragment.getNode()),this.rendered=!0,a.detach()},Of=function(){return this.instance.fragment.toString()},Pf=function(){function a(a){a.unbind()}function b(a){var b,c;b=a.root;do(c=b._liveComponentQueries["_"+a.name])&&c._remove(a);while(b=b._parent)}return function(){this.complexParameters.forEach(a),this.bindings.forEach(a),b(this),this.instance.fragment.unbind()}}(),Qf=function(a){this.instance.fire("teardown"),this.shouldDestroy=a,this.instance.unrender()},Rf=function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n=function(a,b){this.init(a,b)};return n.prototype={detach:a,find:b,findAll:c,findAllComponents:d,findComponent:e,findNextNode:f,firstNode:g,init:h,rebind:i,render:j,toString:k,unbind:l,unrender:m},n}(yf,zf,Af,Bf,Cf,Df,Ef,Lf,Mf,Nf,Of,Pf,Qf),Sf=function(a,b){var c=function(b){this.type=a.COMMENT,this.value=b.template.c};return c.prototype={detach:b,firstNode:function(){return this.node},render:function(){return this.node||(this.node=document.createComment(this.value)),this.node},toString:function(){return"<!--"+this.value+"-->"},unrender:function(a){a&&this.node.parentNode.removeChild(this.node)}},c}(Q,Qc),Tf=function(a,b,c,d,e,f,g,h,i,j){return function(k){if("string"==typeof k.template)return new b(k);switch(k.template.t){case a.INTERPOLATOR:return new c(k);case a.SECTION:return new d(k);case a.TRIPLE:return new e(k);case a.ELEMENT:var l;return(l=h(k.parentFragment.root,k.template.e))?new i(k,l):new f(k);case a.PARTIAL:return new g(k);case a.COMMENT:return new j(k);default:throw new Error("Something very strange happened. Please file an issue at https://github.com/ractivejs/ractive/issues. Thanks!")}}}(Q,Rc,fd,wd,Jd,sf,wf,xf,Rf,Sf),Uf=function(a,b,c){return function(d){var e,f,g,h=this;if(this.owner=d.owner,e=this.parent=this.owner.parentFragment,this.root=d.root,this.pElement=d.pElement,this.context=d.context,this.owner.type===a.SECTION&&(this.index=d.index),e&&(f=e.indexRefs)){this.indexRefs=b(null);for(g in f)this.indexRefs[g]=f[g]}this.priority=e?e.priority+1:1,d.indexRef&&(this.indexRefs||(this.indexRefs={}),this.indexRefs[d.indexRef]=d.index),"string"==typeof d.template?d.template=[d.template]:d.template||(d.template=[]),this.items=d.template.map(function(a,b){return c({parentFragment:h,pElement:d.pElement,template:a,index:b})}),this.value=this.argsList=null,this.dirtyArgs=this.dirtyValue=!0,this.inited=!0}}(Q,R,Tf),Vf=function(a){return function(b,c,d,e){a(this,"context",d,e),this.indexRefs&&void 0!==this.indexRefs[b]&&(this.indexRefs[b]=c),this.items.forEach(function(a){a.rebind&&a.rebind(b,c,d,e)})}}(We),Wf=function(){var a;return 1===this.items.length?a=this.items[0].render():(a=document.createDocumentFragment(),this.items.forEach(function(b){a.appendChild(b.render())})),this.rendered=!0,a},Xf=function(a){return this.items?this.items.map(function(b){return b.toString(a)}).join(""):""},Yf=function(){function a(a){a.unbind&&a.unbind()}return function(){this.items.forEach(a)}}(),Zf=function(a){if(!this.rendered)throw new Error("Attempted to unrender a fragment that was not rendered");this.items.forEach(function(b){return b.unrender(a)})},$f=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){var r=function(a){this.init(a)};return r.prototype={bubble:a,detach:b,find:c,findAll:d,findAllComponents:e,findComponent:f,findNextNode:g,firstNode:h,getNode:i,getValue:j,init:k,rebind:l,render:m,toString:n,unbind:o,unrender:p},q.Fragment=r,r}(Ec,Fc,Gc,Hc,Ic,Jc,Kc,Lc,Mc,Nc,Uf,Vf,Wf,Xf,Yf,Zf,f),_f=function(a,b,c){var d=["template","partials","components","decorators","events"];return function(e,f){var g,h,i,j,k;if("function"!=typeof e||f?e=e||{}:(f=e,e={}),"object"!=typeof e)throw new Error("The reset method takes either no arguments, or an object containing new data");for((h=this.viewmodel.wrapped[""])&&h.reset?h.reset(e)===!1&&(this.data=e):this.data=e,i=c.reset(this),j=i.length;j--;)if(d.indexOf(i[j])>-1){k=!0;break}if(k){var l;this.viewmodel.mark(""),(l=this.component)&&(l.shouldDestroy=!0),this.unrender(),l&&(l.shouldDestroy=!1),this.fragment.template!==this.template&&(this.fragment.unbind(),this.fragment=new b({template:this.template,root:this,owner:this})),g=this.render(this.el,this.anchor)}else g=a.start(this,!0),this.viewmodel.mark(""),a.end();return this.fire("reset",e),f&&g.then(f),g}}(u,$f,Sb),ag=function(a,b){return function(c){var d,e;a.template.init(null,this,{template:c}),d=this.transitionsEnabled,this.transitionsEnabled=!1,(e=this.component)&&(e.shouldDestroy=!0),this.unrender(),e&&(e.shouldDestroy=!1),this.fragment.unbind(),this.fragment=new b({template:this.template,root:this,owner:this}),this.render(this.el,this.anchor),this.transitionsEnabled=d}}(Sb,$f),bg=function(a){return a("reverse")}(zc),cg=function(a,b,c,d){var e=/\*/;return function(f,g,h){var i,j,k=this;if(j=a.start(this,!0),b(f)){i=f,h=g;for(f in i)i.hasOwnProperty(f)&&(g=i[f],f=c(f),this.viewmodel.set(f,g))}else f=c(f),e.test(f)?d(this,f).forEach(function(a){k.viewmodel.set(a,g)}):this.viewmodel.set(f,g);return a.end(),h&&j.then(h.bind(this)),j}}(u,i,F,oc),dg=function(a){return a("shift")}(zc),eg=function(a){return a("sort")}(zc),fg=function(a){return a("splice")}(zc),gg=function(a){return function(b,c){return a(this,b,void 0===c?-1:-c)}}(D),hg=function(a){return function(b){var c;return this.fire("teardown"),this.fragment.unbind(),this.viewmodel.teardown(),c=this.rendered?this.unrender():a.resolve(),b&&c.then(b.bind(this)),c}}(n),ig=function(a){return function(b,c){var d;return"string"!=typeof b&&a.errorOnly({debug:this.debug,messsage:"badArguments",arg:{arguments:b}}),d=this.get(b),this.set(b,!d,c)}}(Xc),jg=function(){return this.fragment.toString(!0)},kg=function(a,b,c){return function(){var d,e,f=this;if(!this.rendered)throw new Error("ractive.unrender() was called on a Ractive instance that was not rendered");for(d=b.start(this,!0),e=!this.component||this.component.shouldDestroy,e=e||this.shouldDestroy,this.constructor.css&&d.then(function(){c.remove(f.constructor)});this._animations[0];)this._animations[0].stop();return this.fragment.unrender(e),this.rendered=!1,a(this.el.__ractive_instances__,this),b.end(),d}}(m,u,Cc),lg=function(a){return a("unshift")}(zc),mg=function(a){return function(b,c){var d;return"function"==typeof b?(c=b,b=""):b=b||"",d=a.start(this,!0),this.viewmodel.mark(b),a.end(),this.fire("update",b),c&&d.then(c.bind(this)),d}}(u),ng=function(a,b){function c(d,e,f,g){var h,i,j,k,l,m,n=[];if(h=d._twowayBindings[e],h&&(j=h.length))for(;j--;)k=h[j],(!k.radioName||k.element.node.checked)&&(k.checkboxName?n[k.keypath]||k.changed()||(n.push(k.keypath),n[k.keypath]=k):(l=k.attribute.value,m=k.getValue(),a(l,m)||b(l,m)||(f[e]=m)));if(n.length&&n.forEach(function(b){var c,d,e;c=n[b],d=c.attribute.value,e=c.getValue(),a(d,e)||(f[b]=e)}),g&&(i=d.viewmodel.depsMap["default"][e]))for(j=i.length;j--;)c(d,i[j],f,g)}return function(a,b){var d;return"string"!=typeof a&&(a="",b=!0),c(this,a,d={},b),this.set(d)}}(Ae,q),og=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F){return{add:a,animate:b,detach:c,find:d,findAll:e,findAllComponents:f,findComponent:g,fire:h,get:i,insert:j,merge:k,observe:l,off:m,on:n,pop:o,push:p,render:q,reset:r,resetTemplate:s,reverse:t,set:u,shift:v,sort:w,splice:x,subtract:y,teardown:z,toggle:A,toHTML:B,unrender:C,unshift:D,update:E,updateModel:F}}(E,Vb,Wb,Xb,fc,gc,hc,ic,jc,lc,mc,sc,vc,wc,Ac,Bc,Dc,_f,ag,bg,cg,dg,eg,fg,gg,hg,ig,jg,kg,lg,mg,ng),pg=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b,c;return b=16*Math.random()|0,c="x"==a?b:3&b|8,c.toString(16)})},qg=function(){var a=0;return function(){return"r-"+a++}}(),rg=function(a,b,c,d){var e=a.root,f=a.keypath;return"sort"===c||"reverse"===c?void e.viewmodel.set(f,b):void(d&&e.viewmodel.splice(f,d))},sg=function(a,b,c,d,e){var f,g,h,i=[],j=["pop","push","reverse","shift","sort","splice","unshift"];return j.forEach(function(f){var g=function(){var b,g,h,i,j;for(b=c(this,f,Array.prototype.slice.call(arguments)),g=d(this,b),h=Array.prototype[f].apply(this,arguments),this._ractive.setting=!0,j=this._ractive.wrappers.length;j--;)i=this._ractive.wrappers[j],a.start(i.root),e(i,this,f,g),a.end();return this._ractive.setting=!1,h};b(i,f,{value:g})}),f={},f.__proto__?(g=function(a){a.__proto__=i},h=function(a){a.__proto__=Array.prototype}):(g=function(a){var c,d;for(c=j.length;c--;)d=j[c],b(a,d,{value:i[d],configurable:!0})},h=function(a){var b;for(b=j.length;b--;)delete a[j[b]]}),g.unpatch=h,g}(u,B,xc,yc,rg),tg=function(a,b,c){var d,e,f;return d={filter:function(a){return b(a)&&(!a._ractive||!a._ractive.setting)},wrap:function(a,b,c){return new e(a,b,c)}},e=function(b,d,e){this.root=b,this.value=d,this.keypath=e,d._ractive||(a(d,"_ractive",{value:{wrappers:[],instances:[],setting:!1},configurable:!0}),c(d)),d._ractive.instances[b._guid]||(d._ractive.instances[b._guid]=0,d._ractive.instances.push(b)),d._ractive.instances[b._guid]+=1,d._ractive.wrappers.push(this)},e.prototype={get:function(){return this.value},teardown:function(){var a,b,d,e,g;if(a=this.value,b=a._ractive,d=b.wrappers,e=b.instances,b.setting)return!1;if(g=d.indexOf(this),-1===g)throw new Error(f);if(d.splice(g,1),d.length){if(e[this.root._guid]-=1,!e[this.root._guid]){if(g=e.indexOf(this.root),-1===g)throw new Error(f);e.splice(g,1)}}else delete a._ractive,c.unpatch(this.value)}},f="Something went wrong in a rather interesting way",d}(B,h,sg),ug=function(a,b){var c,d;return a&&(c={filter:function(c,d,e){return a.filter(c,d,e)&&b.filter(c)},wrap:function(a,b,c){return new d(a,b,c)}},d=function(c,d,e){this.value=d,this.magic=!0,this.magicWrapper=a.wrap(c,d,e),this.arrayWrapper=b.wrap(c,d,e)},d.prototype={get:function(){return this.value},teardown:function(){this.arrayWrapper.teardown(),this.magicWrapper.teardown()},reset:function(a){return this.magicWrapper.reset(a)}}),c}(w,tg),vg=function(a,b,c,d){function e(a,b){var c,d={};if(!b)return a;b+=".";for(c in a)a.hasOwnProperty(c)&&(d[b+c]=a[c]);return d}function f(a){var b;return g[a]||(b=a?a+".":"",g[a]=function(c,d){var f;return"string"==typeof c?(f={},f[b+c]=d,f):"object"==typeof c?b?e(c,a):c:void 0}),g[a]}var g={};return function(e,g){var h,i,j,k,l=this.ractive;for(h=l.adapt.length,i=0;h>i;i+=1){if(j=l.adapt[i],"string"==typeof j){var m=a.registries.adaptors.find(l,j);if(!m)throw new Error('Missing adaptor "'+j+'"');j=l.adapt[i]=m}if(j.filter(g,e,l))return k=this.wrapped[e]=j.wrap(l,g,e,f(e)),k.value=g,g}return l.magic?d.filter(g,e,l)?this.wrapped[e]=d.wrap(l,g,e):c.filter(g,e,l)&&(this.wrapped[e]=c.wrap(l,g,e)):l.modifyArrays&&b.filter(g,e,l)&&(this.wrapped[e]=b.wrap(l,g,e)),g}}(Sb,tg,w,ug),wg=function(a){var b,c,d,e,f=[""];for(b=a.length;b--;)for(c=a[b],d=c.split(".");d.length>1;)d.pop(),e=d.join("."),-1===f.indexOf(e)&&f.push(e);return f},xg=function(){function a(a){var c,d,e,f,g,h="";if(!b[a]){for(e=[];h.length<a;)h+=1;for(c=parseInt(h,2),f=function(a){return"1"===a},g=0;c>=g;g+=1){for(d=g.toString(2);d.length<a;)d="0"+d;e[g]=Array.prototype.map.call(d,f)}b[a]=e}return b[a]}var b={};return function(b){var c,d,e,f;return c=b.split("."),d=a(c.length),e=function(a,b){return a?"*":c[b]},f=d.map(function(a){return a.map(e).join(".")})}}(),yg=function(a){function b(b,e,f){var g;d(b,e),f||(g=a(e),g.forEach(function(a){c(b,a,e)}))}function c(a,b,f){var g,h,i;g=a.depsMap.patternObservers,h=g[b],h&&h.forEach(function(b){var g=e.exec(b)[0];i=f?f+"."+g:g,d(a,i),c(a,b,i)})}function d(a,b){a.patternObservers.forEach(function(a){a.regex.test(b)&&a.update(b)})}var e=/[^\.]+$/;return b}(xg),zg=function(a,b){function c(a){a.update()}function d(a,b,c){var d,e;(d=f(a,b,c))&&(e=a.get(b),d.forEach(function(a){return a.setValue(e)}))}function e(a,b,c){function d(a){a.forEach(e),a.forEach(g)}function e(b){var d=f(a,b,c);d&&i.push({keypath:b,deps:d})}function g(b){var e;(e=a.depsMap[c][b])&&d(e)}function h(b){var c=a.get(b.keypath);b.deps.forEach(function(a){return a.setValue(c)})}var i=[];d(b),i.forEach(h)}function f(a,b,c){var d=a.deps[c];return d?d[b]:null}function g(a,b){b.forEach(function(b){-1===a.indexOf(b)&&a.push(b)})}var h=["observers","default"];return function(){var f,i,j,k,l,m=this,n=this,o=[],p={};if(this.changes.length){k=function(a){var b;(b=n.deps.computed[a])&&g(j,b)},l=function(a){var b;k(a),(b=n.depsMap.computed[a])&&b.forEach(l)};do f=this.changes,g(o,f),this.changes=[],j=[],i=a(f),i.forEach(k),f.forEach(l),j.forEach(c);while(this.changes.length);return i=a(o),this.patternObservers.length&&(i.forEach(function(a){return b(m,a,!0)}),o.forEach(function(a){return b(m,a)})),h.forEach(function(a){m.deps[a]&&(i.forEach(function(b){return d(m,b,a)}),e(m,o,a))}),o.forEach(function(a){p[a]=m.get(a)}),this.implicitChanges={},p}}}(wg,yg),Ag=function(){this.capturing=!0,this.captured=[]},Bg=function(a,b){var c,d,e;if(b||(d=this.wrapped[a])&&d.teardown()!==!1&&(this.wrapped[a]=null),(e=this.computations[a])&&e.compute(),this.cache[a]=void 0,c=this.cacheMap[a])for(;c.length;)this.clearCache(c.pop())
},Cg={FAILED_LOOKUP:!0},Dg=function(a,b){var c={},d=function(a,d){this.viewmodel=a,this.root=a.ractive,this.ref=d,this.parentFragment=c,a.unresolvedImplicitDependencies[d]=!0,a.unresolvedImplicitDependencies.push(this),b.addUnresolved(this)};return d.prototype={resolve:function(){this.viewmodel.mark(this.ref),this.viewmodel.unresolvedImplicitDependencies[this.ref]=!1,a(this.viewmodel.unresolvedImplicitDependencies,this)},teardown:function(){b.removeUnresolved(this)}},d}(m,u),Eg=function(a,b){function c(b,c){var d,e,f,g,h,i,j;return d=c.split("."),e=d.pop(),f=d.join("."),g=b.get(f),(j=b.wrapped[f])&&(g=j.get()),null!==g&&void 0!==g?((h=b.cacheMap[f])?-1===h.indexOf(c)&&h.push(c):b.cacheMap[f]=[c],"object"!=typeof g||e in g?(i=g[e],b.adapt(c,i,!1),b.cache[c]=i,i):b.cache[c]=a):void 0}var d={};return function(e){var f=arguments[1];void 0===f&&(f=d);var g,h,i,j,k=this.ractive,l=this.cache;return void 0===l[e]?((h=this.computations[e])?g=h.value:(i=this.wrapped[e])?g=i.value:e?g=(j=this.evaluators[e])?j.value:c(this,e):(this.adapt("",k.data),g=k.data),l[e]=g):g=l[e],f.evaluateWrapped&&(i=this.wrapped[e])&&(g=i.get()),f.capture&&this.capturing&&-1===this.captured.indexOf(e)&&(this.captured.push(e),g===a&&this.unresolvedImplicitDependencies[e]!==!0&&new b(this,e)),g===a?void 0:g}}(Cg,Dg),Fg=function(a,b){b&&(this.implicitChanges[a]=!0),-1===this.changes.indexOf(a)&&(this.changes.push(a),this.clearCache(a))},Gg=function(a,b){var c,d,e,f;return c={},d=0,e=a.map(function(a,e){var g,h,i;h=d,i=b.length;do{if(g=b.indexOf(a,h),-1===g)return f=!0,-1;h=g+1}while(c[g]&&i>h);return g===d&&(d+=1),g!==e&&(f=!0),c[g]=!0,g}),e.unchanged=!f,e},Hg=function(a,b,c){function d(b){return"function"==typeof b.merge&&(!b.subtype||b.subtype===a.SECTION_EACH)}function e(a){return JSON.stringify(a)}function f(a){if(a===!0)return e;if("string"==typeof a)return g[a]||(g[a]=function(b){return b[a]}),g[a];if("function"==typeof a)return a;throw new Error("The `compare` option must be a function, or a string representing an identifying field (or `true` to use JSON.stringify)")}var g={};return function(a,e,g,h){var i,j,k,l,m,n=this;if(this.mark(a),h&&h.compare){k=f(h.compare);try{i=e.map(k),j=g.map(k)}catch(o){if(this.debug)throw o;b("Merge operation: comparison failed. Falling back to identity checking"),i=e,j=g}}else i=e,j=g;l=c(i,j),l.forEach(function(b,c){-1===b&&n.mark(a+"."+c)}),this.set(a,g,!0),(m=this.deps["default"][a])&&m.filter(d).forEach(function(a){return a.merge(l)}),e.length!==g.length&&this.mark(a+".length",!0)}}(Q,K,Gg),Ig=function(){function a(a,b,c){var d,e,f,g;for(d=b.split(".");d.length;)d.pop(),e=d.join("."),f=a.depsMap[c]||(a.depsMap[c]={}),g=f[e]||(f[e]=[]),void 0===g[b]&&(g[b]=0,g.push(b)),g[b]+=1,b=e}return function(b,c){var d=arguments[2];void 0===d&&(d="default");var e,f,g;c.isStatic||(e=this.deps[d]||(this.deps[d]={}),f=e[b]||(e[b]=[]),f.push(c),b&&((g=this.evaluators[b])&&(g.dependants||g.wake(),g.dependants+=1),a(this,b,d)))}}(),Jg=function(){return this.capturing=!1,this.captured},Kg=function(a,b){return function(c,d,e){var f,g,h,i,j,k,l,m;a(this.cache[c],d)||(j=this.computations[c],k=this.wrapped[c],l=this.evaluators[c],j&&!j.setting&&j.set(d),k&&k.reset&&(m=k.reset(d)!==!1,m&&(d=k.get())),l&&(l.value=d),j||l||m||(f=c.split("."),g=f.pop(),h=f.join("."),k=this.wrapped[h],k&&k.set?k.set(g,d):(i=k?k.get():this.get(h),i||(i=b(g),this.set(h,i,!0)),i[g]=d)),e?this.clearCache(c):this.mark(c))}}(q,v),Lg=function(a){function b(b){return b.type===a.SECTION&&(!b.subtype||b.subtype===a.SECTION_EACH)&&b.rendered}return function(a,c){var d,e,f=this;for(d=c.rangeStart;d<c.rangeEnd;d+=1)f.mark(a+"."+d);c.balance&&f.mark(a+".length",!0),(e=f.deps["default"][a])&&e.filter(b).forEach(function(a){return a.splice(c)})}}(Q),Mg=function(){var a,b=this;for(Object.keys(this.cache).forEach(function(a){return b.clearCache(a)});a=this.unresolvedImplicitDependencies.pop();)a.teardown()},Ng=function(){function a(a,b,c){var d,e,f,g;for(d=b.split(".");d.length;)d.pop(),e=d.join("."),f=a.depsMap[c],g=f[e],g[b]-=1,g[b]||(g.splice(g.indexOf(b),1),g[b]=void 0),b=e}return function(b,c){var d=arguments[2];void 0===d&&(d="default");var e,f,g;if(!c.isStatic){if(e=this.deps[d][b],f=e.indexOf(c),-1===f)throw new Error("Attempted to remove a dependant that was no longer registered! This should not happen. If you are seeing this bug in development please raise an issue at https://github.com/RactiveJS/Ractive/issues - thanks");e.splice(f,1),b&&((g=this.evaluators[b])&&(g.dependants-=1,g.dependants||g.sleep()),a(this,b,d))}}}(),Og=function(){function a(a){var c="var __ractive=this;return("+a.replace(b,function(a,b){return'__ractive.get("'+b+'")'})+")";return new Function(c)}var b=/\$\{([^\}]+)\}/g;return function(b){return"function"==typeof b?{get:b}:"string"==typeof b?{get:a(b)}:("object"==typeof b&&"string"==typeof b.get&&(b={get:a(b.get),set:b.set}),b)}}(),Pg=function(a,b,c){var d=function(a,b,c){this.ractive=a,this.viewmodel=a.viewmodel,this.key=b,this.getter=c.get,this.setter=c.set,this.dependencies=[],this.update()};return d.prototype={set:function(a){if(this.setting)return void(this.value=a);if(!this.setter)throw new Error("Computed properties without setters are read-only. (This may change in a future version of Ractive!)");this.setter.call(this.ractive,a)},compute:function(){var b,d,e;b=this.ractive,b.viewmodel.capture();try{this.value=this.getter.call(b)}catch(f){a.warn({debug:b.debug,message:"failedComputation",args:{key:this.key,err:f.message||f}}),d=!0}return e=b.viewmodel.release(),c(this,this.dependencies,e),d?!1:!0},update:function(){var a=this.value;this.compute()&&!b(this.value,a)&&this.ractive.viewmodel.mark(this.key)}},d}(Xc,q,Yc),Qg=function(a,b){return function(c,d){var e,f;for(e in d)f=a(d[e]),c.viewmodel.computations[e]=new b(c,e,f)}}(Og,Pg),Rg=function(){function a(a){return"string"==typeof a&&(a=[a]),a}var b={lookup:function(a,b){var c,d=a.adapt;if(!d||!d.length)return d;if(b&&Object.keys(b).length&&(c=d.length))for(;c--;){var e=d[c];"string"==typeof e&&(d[c]=b[e]||e)}return d},combine:function(b,c){return b=a(b),c=a(c),b&&b.length?c&&c.length?(b.forEach(function(a){-1===c.indexOf(a)&&c.push(a)}),c):b.slice():c}};return b}(),Sg=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){var q;try{Object.defineProperty({},"test",{value:0})}catch(r){q=!0}var s=function(b){this.ractive=b,s.extend(b.constructor,b),this.cache={},this.cacheMap=a(null),this.deps={computed:{},"default":{}},this.depsMap={computed:{},"default":{}},this.patternObservers=[],this.wrapped=a(null),this.evaluators=a(null),this.computations=a(null),this.captured=null,this.unresolvedImplicitDependencies=[],this.changes=[],this.implicitChanges={}};return s.extend=function(a,b){if(b.magic&&q)throw new Error("Getters and setters (magic mode) are not supported in this browser");b.adapt=p.combine(a.prototype.adapt,b.adapt)||[],b.adapt=p.lookup(b,b.adaptors)},s.prototype={adapt:b,applyChanges:c,capture:d,clearCache:e,get:f,mark:g,merge:h,register:i,release:j,set:k,splice:l,teardown:m,unregister:n,compute:function(){o(this.ractive,this.ractive.computed)}},s}(R,vg,zg,Ag,Bg,Eg,Fg,Hg,Ig,Jg,Kg,Lg,Mg,Ng,Qg,Rg),Tg=function(a,b,c,d,e,f){function g(a){var b;if(b=c(a.el)){var d=a.transitionsEnabled;if(a.noIntro&&(a.transitionsEnabled=!1),b&&!a.append){if(b.__ractive_instances__)try{b.__ractive_instances__.splice(0,b.__ractive_instances__.length).forEach(function(a){return a.teardown()})}catch(e){}b.innerHTML=""}a.render(b,a.append),a.transitionsEnabled=d}}function h(a,c){a._guid=d(),a._subs=b(null),a._config={},a._twowayBindings=b(null),a._animations=[],a.nodes={},a._liveQueries=[],a._liveComponentQueries=[],c._parent&&c._component&&(a._parent=c._parent,a.component=c._component,c._component.instance=a)}return function(b){var c=arguments[1];void 0===c&&(c={}),h(b,c),a.init(b.constructor,b,c),b.viewmodel=new e(b),b.viewmodel.compute(),b.template&&(b.fragment=new f({template:b.template,root:b,owner:b})),b.viewmodel.applyChanges(),g(b)}}(Sb,R,kc,qg,Sg,$f),Ug=function(a){return function(b,c,d){b.beforeInit&&b.beforeInit(d),a(b,d)}}(Tg),Vg=function(a,b,c,d){function e(b,c,d){for(var e in d)if(!(e in i)&&d.hasOwnProperty(e)){var f=d[e];"function"==typeof f&&(f=a(b,e,f)),c[e]=f}}function f(a){if(!(a.prototype instanceof h))return a;for(var c={};a;)k.forEach(function(b){g(b.useDefaults?a.prototype:a,c,b.name)}),Object.keys(a.prototype).forEach(function(d){if("computed"!==d){var e=a.prototype[d];if(d in c){if("function"==typeof c[d]&&"function"==typeof e&&c[d]._method){var f,g=e._method;g&&(e=e._method),f=b(c[d]._method,e),g&&(f._method=f),c[d]=f}}else c[d]=e._method?e._method:e}}),a=a._parent!==h?a._parent:!1;return c}function g(a,b,c){var d,e=Object.keys(a[c]);e.length&&((d=b[c])||(d=b[c]={}),e.filter(function(a){return!(a in d)}).forEach(function(b){return d[b]=a[c][b]}))}var h,i={_parent:!0,_component:!0},j={toPrototype:e,toOptions:f},k=c.registries;return c.keys.forEach(function(a){return i[a]=!0}),d.push(function(){h=d.Ractive}),j}(Qb,N,Sb,f),Wg=function(a,b,c,d,e,f,g){return function h(){var i=arguments[0];void 0===i&&(i={});var j,k,l,m=this;return i=g.toOptions(i),j=function(a){e(this,j,a)},k=a(m.prototype),k.constructor=j,l={_guid:{value:c()},defaults:{value:k},extend:{value:h,writable:!0,configurable:!0},_parent:{value:m}},b(j,l),d.extend(m,k,i),f.extend(m,k),g.toPrototype(m.prototype,k,i),j.prototype=k,j}}(R,C,pg,Sb,Ug,Sg,Vg),Xg=function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n,o;for(n=function(a){l(this,a)},o={extend:{value:j},parse:{value:k},Promise:{value:h},svg:{value:d},magic:{value:e},VERSION:{value:"0.5.5"},adaptors:{writable:!0,value:{}},components:{writable:!0,value:{}},decorators:{writable:!0,value:{}},easing:{writable:!0,value:b},events:{writable:!0,value:{}},interpolators:{writable:!0,value:c},partials:{writable:!0,value:{}},transitions:{writable:!0,value:{}}},f(n,o),n.prototype=i(g,a),n.prototype.constructor=n,n.defaults=n.prototype,m.Ractive=n;m.length;)m.pop()();var p="function";if(typeof Date.now!==p||typeof String.prototype.trim!==p||typeof Object.keys!==p||typeof Array.prototype.indexOf!==p||typeof Array.prototype.forEach!==p||typeof Array.prototype.map!==p||typeof Array.prototype.filter!==p||"undefined"!=typeof window&&typeof window.addEventListener!==p)throw new Error("It looks like you're attempting to use Ractive.js in an older browser. You'll need to use one of the 'legacy builds' in order to continue - see http://docs.ractivejs.org/latest/legacy-builds for more information.");return n}(d,e,k,l,x,C,og,n,qe,Wg,Ib,Tg,f);"undefined"!=typeof b&&b.exports?b.exports=Xg:"function"==typeof define&&define.amd&&define(function(){return Xg}),a.Ractive=Xg,Xg.noConflict=function(){return a.Ractive=c,Xg}}("undefined"!=typeof window?window:this)},{}],51:[function(a,b,c){(function(){var a=this,d=a._,e={},f=Array.prototype,g=Object.prototype,h=Function.prototype,i=f.push,j=f.slice,k=f.concat,l=g.toString,m=g.hasOwnProperty,n=f.forEach,o=f.map,p=f.reduce,q=f.reduceRight,r=f.filter,s=f.every,t=f.some,u=f.indexOf,v=f.lastIndexOf,w=Array.isArray,x=Object.keys,y=h.bind,z=function(a){return a instanceof z?a:this instanceof z?void(this._wrapped=a):new z(a)};"undefined"!=typeof c?("undefined"!=typeof b&&b.exports&&(c=b.exports=z),c._=z):a._=z,z.VERSION="1.6.0";var A=z.each=z.forEach=function(a,b,c){if(null==a)return a;if(n&&a.forEach===n)a.forEach(b,c);else if(a.length===+a.length){for(var d=0,f=a.length;f>d;d++)if(b.call(c,a[d],d,a)===e)return}else for(var g=z.keys(a),d=0,f=g.length;f>d;d++)if(b.call(c,a[g[d]],g[d],a)===e)return;return a};z.map=z.collect=function(a,b,c){var d=[];return null==a?d:o&&a.map===o?a.map(b,c):(A(a,function(a,e,f){d.push(b.call(c,a,e,f))}),d)};var B="Reduce of empty array with no initial value";z.reduce=z.foldl=z.inject=function(a,b,c,d){var e=arguments.length>2;if(null==a&&(a=[]),p&&a.reduce===p)return d&&(b=z.bind(b,d)),e?a.reduce(b,c):a.reduce(b);if(A(a,function(a,f,g){e?c=b.call(d,c,a,f,g):(c=a,e=!0)}),!e)throw new TypeError(B);return c},z.reduceRight=z.foldr=function(a,b,c,d){var e=arguments.length>2;if(null==a&&(a=[]),q&&a.reduceRight===q)return d&&(b=z.bind(b,d)),e?a.reduceRight(b,c):a.reduceRight(b);var f=a.length;if(f!==+f){var g=z.keys(a);f=g.length}if(A(a,function(h,i,j){i=g?g[--f]:--f,e?c=b.call(d,c,a[i],i,j):(c=a[i],e=!0)}),!e)throw new TypeError(B);return c},z.find=z.detect=function(a,b,c){var d;return C(a,function(a,e,f){return b.call(c,a,e,f)?(d=a,!0):void 0}),d},z.filter=z.select=function(a,b,c){var d=[];return null==a?d:r&&a.filter===r?a.filter(b,c):(A(a,function(a,e,f){b.call(c,a,e,f)&&d.push(a)}),d)},z.reject=function(a,b,c){return z.filter(a,function(a,d,e){return!b.call(c,a,d,e)},c)},z.every=z.all=function(a,b,c){b||(b=z.identity);var d=!0;return null==a?d:s&&a.every===s?a.every(b,c):(A(a,function(a,f,g){return(d=d&&b.call(c,a,f,g))?void 0:e}),!!d)};var C=z.some=z.any=function(a,b,c){b||(b=z.identity);var d=!1;return null==a?d:t&&a.some===t?a.some(b,c):(A(a,function(a,f,g){return d||(d=b.call(c,a,f,g))?e:void 0}),!!d)};z.contains=z.include=function(a,b){return null==a?!1:u&&a.indexOf===u?-1!=a.indexOf(b):C(a,function(a){return a===b})},z.invoke=function(a,b){var c=j.call(arguments,2),d=z.isFunction(b);return z.map(a,function(a){return(d?b:a[b]).apply(a,c)})},z.pluck=function(a,b){return z.map(a,z.property(b))},z.where=function(a,b){return z.filter(a,z.matches(b))},z.findWhere=function(a,b){return z.find(a,z.matches(b))},z.max=function(a,b,c){if(!b&&z.isArray(a)&&a[0]===+a[0]&&a.length<65535)return Math.max.apply(Math,a);var d=-1/0,e=-1/0;return A(a,function(a,f,g){var h=b?b.call(c,a,f,g):a;h>e&&(d=a,e=h)}),d},z.min=function(a,b,c){if(!b&&z.isArray(a)&&a[0]===+a[0]&&a.length<65535)return Math.min.apply(Math,a);var d=1/0,e=1/0;return A(a,function(a,f,g){var h=b?b.call(c,a,f,g):a;e>h&&(d=a,e=h)}),d},z.shuffle=function(a){var b,c=0,d=[];return A(a,function(a){b=z.random(c++),d[c-1]=d[b],d[b]=a}),d},z.sample=function(a,b,c){return null==b||c?(a.length!==+a.length&&(a=z.values(a)),a[z.random(a.length-1)]):z.shuffle(a).slice(0,Math.max(0,b))};var D=function(a){return null==a?z.identity:z.isFunction(a)?a:z.property(a)};z.sortBy=function(a,b,c){return b=D(b),z.pluck(z.map(a,function(a,d,e){return{value:a,index:d,criteria:b.call(c,a,d,e)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;if(c!==d){if(c>d||void 0===c)return 1;if(d>c||void 0===d)return-1}return a.index-b.index}),"value")};var E=function(a){return function(b,c,d){var e={};return c=D(c),A(b,function(f,g){var h=c.call(d,f,g,b);a(e,h,f)}),e}};z.groupBy=E(function(a,b,c){z.has(a,b)?a[b].push(c):a[b]=[c]}),z.indexBy=E(function(a,b,c){a[b]=c}),z.countBy=E(function(a,b){z.has(a,b)?a[b]++:a[b]=1}),z.sortedIndex=function(a,b,c,d){c=D(c);for(var e=c.call(d,b),f=0,g=a.length;g>f;){var h=f+g>>>1;c.call(d,a[h])<e?f=h+1:g=h}return f},z.toArray=function(a){return a?z.isArray(a)?j.call(a):a.length===+a.length?z.map(a,z.identity):z.values(a):[]},z.size=function(a){return null==a?0:a.length===+a.length?a.length:z.keys(a).length},z.first=z.head=z.take=function(a,b,c){return null==a?void 0:null==b||c?a[0]:0>b?[]:j.call(a,0,b)},z.initial=function(a,b,c){return j.call(a,0,a.length-(null==b||c?1:b))},z.last=function(a,b,c){return null==a?void 0:null==b||c?a[a.length-1]:j.call(a,Math.max(a.length-b,0))},z.rest=z.tail=z.drop=function(a,b,c){return j.call(a,null==b||c?1:b)},z.compact=function(a){return z.filter(a,z.identity)};var F=function(a,b,c){return b&&z.every(a,z.isArray)?k.apply(c,a):(A(a,function(a){z.isArray(a)||z.isArguments(a)?b?i.apply(c,a):F(a,b,c):c.push(a)}),c)};z.flatten=function(a,b){return F(a,b,[])},z.without=function(a){return z.difference(a,j.call(arguments,1))},z.partition=function(a,b){var c=[],d=[];return A(a,function(a){(b(a)?c:d).push(a)}),[c,d]},z.uniq=z.unique=function(a,b,c,d){z.isFunction(b)&&(d=c,c=b,b=!1);var e=c?z.map(a,c,d):a,f=[],g=[];return A(e,function(c,d){(b?d&&g[g.length-1]===c:z.contains(g,c))||(g.push(c),f.push(a[d]))}),f},z.union=function(){return z.uniq(z.flatten(arguments,!0))},z.intersection=function(a){var b=j.call(arguments,1);return z.filter(z.uniq(a),function(a){return z.every(b,function(b){return z.contains(b,a)})})},z.difference=function(a){var b=k.apply(f,j.call(arguments,1));return z.filter(a,function(a){return!z.contains(b,a)})},z.zip=function(){for(var a=z.max(z.pluck(arguments,"length").concat(0)),b=new Array(a),c=0;a>c;c++)b[c]=z.pluck(arguments,""+c);return b},z.object=function(a,b){if(null==a)return{};for(var c={},d=0,e=a.length;e>d;d++)b?c[a[d]]=b[d]:c[a[d][0]]=a[d][1];return c},z.indexOf=function(a,b,c){if(null==a)return-1;var d=0,e=a.length;if(c){if("number"!=typeof c)return d=z.sortedIndex(a,b),a[d]===b?d:-1;d=0>c?Math.max(0,e+c):c}if(u&&a.indexOf===u)return a.indexOf(b,c);for(;e>d;d++)if(a[d]===b)return d;return-1},z.lastIndexOf=function(a,b,c){if(null==a)return-1;var d=null!=c;if(v&&a.lastIndexOf===v)return d?a.lastIndexOf(b,c):a.lastIndexOf(b);for(var e=d?c:a.length;e--;)if(a[e]===b)return e;return-1},z.range=function(a,b,c){arguments.length<=1&&(b=a||0,a=0),c=arguments[2]||1;for(var d=Math.max(Math.ceil((b-a)/c),0),e=0,f=new Array(d);d>e;)f[e++]=a,a+=c;return f};var G=function(){};z.bind=function(a,b){var c,d;if(y&&a.bind===y)return y.apply(a,j.call(arguments,1));if(!z.isFunction(a))throw new TypeError;return c=j.call(arguments,2),d=function(){if(!(this instanceof d))return a.apply(b,c.concat(j.call(arguments)));G.prototype=a.prototype;var e=new G;G.prototype=null;var f=a.apply(e,c.concat(j.call(arguments)));return Object(f)===f?f:e}},z.partial=function(a){var b=j.call(arguments,1);return function(){for(var c=0,d=b.slice(),e=0,f=d.length;f>e;e++)d[e]===z&&(d[e]=arguments[c++]);for(;c<arguments.length;)d.push(arguments[c++]);return a.apply(this,d)}},z.bindAll=function(a){var b=j.call(arguments,1);if(0===b.length)throw new Error("bindAll must be passed function names");return A(b,function(b){a[b]=z.bind(a[b],a)}),a},z.memoize=function(a,b){var c={};return b||(b=z.identity),function(){var d=b.apply(this,arguments);return z.has(c,d)?c[d]:c[d]=a.apply(this,arguments)}},z.delay=function(a,b){var c=j.call(arguments,2);return setTimeout(function(){return a.apply(null,c)},b)},z.defer=function(a){return z.delay.apply(z,[a,1].concat(j.call(arguments,1)))},z.throttle=function(a,b,c){var d,e,f,g=null,h=0;c||(c={});var i=function(){h=c.leading===!1?0:z.now(),g=null,f=a.apply(d,e),d=e=null};return function(){var j=z.now();h||c.leading!==!1||(h=j);var k=b-(j-h);return d=this,e=arguments,0>=k?(clearTimeout(g),g=null,h=j,f=a.apply(d,e),d=e=null):g||c.trailing===!1||(g=setTimeout(i,k)),f}},z.debounce=function(a,b,c){var d,e,f,g,h,i=function(){var j=z.now()-g;b>j?d=setTimeout(i,b-j):(d=null,c||(h=a.apply(f,e),f=e=null))};return function(){f=this,e=arguments,g=z.now();var j=c&&!d;return d||(d=setTimeout(i,b)),j&&(h=a.apply(f,e),f=e=null),h}},z.once=function(a){var b,c=!1;return function(){return c?b:(c=!0,b=a.apply(this,arguments),a=null,b)}},z.wrap=function(a,b){return z.partial(b,a)},z.compose=function(){var a=arguments;return function(){for(var b=arguments,c=a.length-1;c>=0;c--)b=[a[c].apply(this,b)];return b[0]}},z.after=function(a,b){return function(){return--a<1?b.apply(this,arguments):void 0}},z.keys=function(a){if(!z.isObject(a))return[];if(x)return x(a);var b=[];for(var c in a)z.has(a,c)&&b.push(c);return b},z.values=function(a){for(var b=z.keys(a),c=b.length,d=new Array(c),e=0;c>e;e++)d[e]=a[b[e]];return d},z.pairs=function(a){for(var b=z.keys(a),c=b.length,d=new Array(c),e=0;c>e;e++)d[e]=[b[e],a[b[e]]];return d},z.invert=function(a){for(var b={},c=z.keys(a),d=0,e=c.length;e>d;d++)b[a[c[d]]]=c[d];return b},z.functions=z.methods=function(a){var b=[];for(var c in a)z.isFunction(a[c])&&b.push(c);return b.sort()},z.extend=function(a){return A(j.call(arguments,1),function(b){if(b)for(var c in b)a[c]=b[c]}),a},z.pick=function(a){var b={},c=k.apply(f,j.call(arguments,1));return A(c,function(c){c in a&&(b[c]=a[c])}),b},z.omit=function(a){var b={},c=k.apply(f,j.call(arguments,1));for(var d in a)z.contains(c,d)||(b[d]=a[d]);return b},z.defaults=function(a){return A(j.call(arguments,1),function(b){if(b)for(var c in b)void 0===a[c]&&(a[c]=b[c])}),a},z.clone=function(a){return z.isObject(a)?z.isArray(a)?a.slice():z.extend({},a):a},z.tap=function(a,b){return b(a),a};var H=function(a,b,c,d){if(a===b)return 0!==a||1/a==1/b;if(null==a||null==b)return a===b;a instanceof z&&(a=a._wrapped),b instanceof z&&(b=b._wrapped);var e=l.call(a);if(e!=l.call(b))return!1;switch(e){case"[object String]":return a==String(b);case"[object Number]":return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case"[object Date]":case"[object Boolean]":return+a==+b;case"[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if("object"!=typeof a||"object"!=typeof b)return!1;for(var f=c.length;f--;)if(c[f]==a)return d[f]==b;var g=a.constructor,h=b.constructor;if(g!==h&&!(z.isFunction(g)&&g instanceof g&&z.isFunction(h)&&h instanceof h)&&"constructor"in a&&"constructor"in b)return!1;c.push(a),d.push(b);var i=0,j=!0;if("[object Array]"==e){if(i=a.length,j=i==b.length)for(;i--&&(j=H(a[i],b[i],c,d)););}else{for(var k in a)if(z.has(a,k)&&(i++,!(j=z.has(b,k)&&H(a[k],b[k],c,d))))break;if(j){for(k in b)if(z.has(b,k)&&!i--)break;j=!i}}return c.pop(),d.pop(),j};z.isEqual=function(a,b){return H(a,b,[],[])},z.isEmpty=function(a){if(null==a)return!0;if(z.isArray(a)||z.isString(a))return 0===a.length;for(var b in a)if(z.has(a,b))return!1;return!0},z.isElement=function(a){return!(!a||1!==a.nodeType)},z.isArray=w||function(a){return"[object Array]"==l.call(a)},z.isObject=function(a){return a===Object(a)},A(["Arguments","Function","String","Number","Date","RegExp"],function(a){z["is"+a]=function(b){return l.call(b)=="[object "+a+"]"}}),z.isArguments(arguments)||(z.isArguments=function(a){return!(!a||!z.has(a,"callee"))}),"function"!=typeof/./&&(z.isFunction=function(a){return"function"==typeof a}),z.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))},z.isNaN=function(a){return z.isNumber(a)&&a!=+a},z.isBoolean=function(a){return a===!0||a===!1||"[object Boolean]"==l.call(a)},z.isNull=function(a){return null===a},z.isUndefined=function(a){return void 0===a},z.has=function(a,b){return m.call(a,b)},z.noConflict=function(){return a._=d,this},z.identity=function(a){return a},z.constant=function(a){return function(){return a}},z.property=function(a){return function(b){return b[a]}},z.matches=function(a){return function(b){if(b===a)return!0;for(var c in a)if(a[c]!==b[c])return!1;return!0}},z.times=function(a,b,c){for(var d=Array(Math.max(0,a)),e=0;a>e;e++)d[e]=b.call(c,e);return d},z.random=function(a,b){return null==b&&(b=a,a=0),a+Math.floor(Math.random()*(b-a+1))},z.now=Date.now||function(){return(new Date).getTime()};var I={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};I.unescape=z.invert(I.escape);var J={escape:new RegExp("["+z.keys(I.escape).join("")+"]","g"),unescape:new RegExp("("+z.keys(I.unescape).join("|")+")","g")};z.each(["escape","unescape"],function(a){z[a]=function(b){return null==b?"":(""+b).replace(J[a],function(b){return I[a][b]})}}),z.result=function(a,b){if(null==a)return void 0;var c=a[b];return z.isFunction(c)?c.call(a):c},z.mixin=function(a){A(z.functions(a),function(b){var c=z[b]=a[b];z.prototype[b]=function(){var a=[this._wrapped];return i.apply(a,arguments),O.call(this,c.apply(z,a))}})};var K=0;z.uniqueId=function(a){var b=++K+"";return a?a+b:b},z.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var L=/(.)^/,M={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},N=/\\|'|\r|\n|\t|\u2028|\u2029/g;z.template=function(a,b,c){var d;c=z.defaults({},c,z.templateSettings);var e=new RegExp([(c.escape||L).source,(c.interpolate||L).source,(c.evaluate||L).source].join("|")+"|$","g"),f=0,g="__p+='";a.replace(e,function(b,c,d,e,h){return g+=a.slice(f,h).replace(N,function(a){return"\\"+M[a]}),c&&(g+="'+\n((__t=("+c+"))==null?'':_.escape(__t))+\n'"),d&&(g+="'+\n((__t=("+d+"))==null?'':__t)+\n'"),e&&(g+="';\n"+e+"\n__p+='"),f=h+b.length,b}),g+="';\n",c.variable||(g="with(obj||{}){\n"+g+"}\n"),g="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+g+"return __p;\n";try{d=new Function(c.variable||"obj","_",g)}catch(h){throw h.source=g,h}if(b)return d(b,z);var i=function(a){return d.call(this,a,z)};return i.source="function("+(c.variable||"obj")+"){\n"+g+"}",i},z.chain=function(a){return z(a).chain()};var O=function(a){return this._chain?z(a).chain():a};z.mixin(z),A(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=f[a];z.prototype[a]=function(){var c=this._wrapped;return b.apply(c,arguments),"shift"!=a&&"splice"!=a||0!==c.length||delete c[0],O.call(this,c)}}),A(["concat","join","slice"],function(a){var b=f[a];z.prototype[a]=function(){return O.call(this,b.apply(this._wrapped,arguments))}}),z.extend(z.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),"function"==typeof define&&define.amd&&define("underscore",[],function(){return z})}).call(this)},{}]},{},[9]);